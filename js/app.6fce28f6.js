(function(e){function t(t){for(var s,r,a=t[0],o=t[1],d=t[2],u=0,c=[];u<a.length;u++)r=a[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&c.push(i[r][0]),i[r]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);h&&h(t);while(c.length)c.shift()();return n.push.apply(n,d||[]),l()}function l(){for(var e,t=0;t<n.length;t++){for(var l=n[t],s=!0,a=1;a<l.length;a++){var o=l[a];0!==i[o]&&(s=!1)}s&&(n.splice(t--,1),e=r(r.s=l[0]))}return e}var s={},i={app:0},n=[];function r(t){if(s[t])return s[t].exports;var l=s[t]={i:t,l:!1,exports:{}};return e[t].call(l.exports,l,l.exports,r),l.l=!0,l.exports}r.m=e,r.c=s,r.d=function(e,t,l){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(r.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(l,s,function(t){return e[t]}.bind(null,s));return l},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var d=0;d<a.length;d++)t(a[d]);var h=o;n.push([0,"chunk-vendors"]),l()})({0:function(e,t,l){e.exports=l("56d7")},"0e46":function(e,t,l){},"56d7":function(e,t,l){"use strict";l.r(t);var s=l("2b0e"),i=l("7496"),n=l("f6c4"),r=function(){var e=this,t=e._self._c;return t(i["a"],[t(n["a"],[t("StatusTable")],1)],1)},a=[],o=l("62ad"),d=l("a523"),h=l("8fea"),u=l("132d"),c=l("0fd9"),p=l("a293"),f=function(){var e=this,t=e._self._c;return t("div",{ref:"containerRef",staticClass:"container-width"},[t(d["a"],{attrs:{fluid:""}},[t(c["a"],{staticClass:"text-center"},[t(o["a"],{staticClass:"overflow-c",attrs:{cols:"12"}},[t("div",{ref:"tableRef"},[t(h["a"],{staticClass:"elevation-1 zoom custom-data-table",attrs:{headers:e.filteredHeaders,items:e.deliverables,"hide-default-header":"","hide-default-footer":"","sort-by":e.sortBy,"disable-pagination":"","sort-desc":e.sortDesc},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t}},scopedSlots:e._u([{key:"header",fn:function({props:{headers:l}}){return[t("thead",{staticClass:"v-data-table-header"},[t("tr",{ref:"headerRef"},e._l(l,(function(l){return t("th",{key:l.value,staticStyle:{border:"solid 0.5px",padding:"0px 0px"}},[t("span"),l.value.includes("step")?t("span",{staticStyle:{height:"100%"}},[t("linear-progress",{attrs:{color:"green",height:e.thHeight,value:e.stepsFulfillment[l.value]}},[e._v(" "+e._s(e.stepsFulfillment[l.value]?Math.round(e.stepsFulfillment[l.value]):0)+"% ")])],1):"fulfillment"===l.value?t("span",[t("linear-progress",{attrs:{value:null===e.totalFulfillment||isNaN(e.totalFulfillment)?0:e.totalFulfillment,color:"green",height:e.thHeight,reactive:"reactive",striped:"striped"}},[e._v(" "+e._s(null===e.totalFulfillment||isNaN(e.totalFulfillment)?"n.rel.":e.totalFulfillment+"%")+" ")])],1):t("div",{staticStyle:{color:"white"},on:{click:function(t){return e.toggleWidth()}}},[e._v(" ' ")])])})),0),t("tr",{staticClass:"secondTopRow"},e._l(l,(function(l,s){return t("th",{key:s,staticClass:"sortable",class:{active:e.sortBy===l.value,asc:!1===e.sortDesc},attrs:{id:"tableHeader",role:"columnheader",scope:"col","aria-label":l.text+": Sorted ascending. Activate to sort descending.","aria-sort":"ascending"}},[t("edit-dialog-table-header",{attrs:{header:l},on:{handleChangeHeader:e.changeHeader,handleInputChange:e.inputChanged,handleHeaderTextFileOpend:e.headerTextFieldOpen}}),l.headerEditable?t("span",{attrs:{id:"deleteIcon"},on:{click:function(t){return e.conformMessage("",s,"column")}}},[t(u["a"],{attrs:{small:""}},[e._v("mdi-delete")])],1):t("span",[t("span",{on:{click:function(t){return e.sortColumn(l.value)}}},[t("span",[e._v(e._s(l.text)+" ")]),t("span",[t("i",{staticClass:"v-icon notranslate v-data-table-header__icon mdi mdi-arrow-up theme--light",staticStyle:{"font-size":"18px",transition:"transform 0.25s linear"},style:{transform:`rotate(${e.rotateValues[l.value]}deg)`},attrs:{"aria-hidden":"true"},on:{click:function(t){e.rotateValues[l.value]+=0===e.rotateValues[l.value]?-180:180}}})])])])],1)})),0)])]}},{key:"body",fn:function({items:l,headers:s}){return[t("tbody",[e._l(l,(function(l,i){return[t("tr",{ref:"rowRef",refInFor:!0},e._l(s,(function(s,n){return t("td",{key:"inner_"+n,class:{"expanded-td":e.expandedWidth},style:e.cellBackgroundStyle(l[s.value]),attrs:{title:e.expandedWidth?e.getTitle(l,s):""},on:{mouseover:function(e){l.showEditDialog=!0},mouseleave:function(t){return e.mouseLeave(l)}}},[s.editable?t("span",{class:{"left-justified":"description"===s.value||s.value.includes("responsible")}},[l.showEditDialog||l.isChild?t("span",[s.value.includes("step")?[l.isChild?t("span",[e._v(" "+e._s(e.subProjectStepsFullFilment[l.id]?parseInt(Math.round(e.subProjectStepsFullFilment[l.id][s.value])):0)+"% ")]):t("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.handleSelectChange(l,s.value)}}},[e._v(" "+e._s(l[s.value])+" ")])]:[t("edit-dialog-table-body",{attrs:{item:l,header:s},on:{handleChangeCell:e.changeCell,handleClose1:e.close1,handleInputChanged:e.inputChanged,handleOpen:e.open}})]],2):t("span",[e._v(" "+e._s(l[s.value])+" ")])]):t("span",["fulfillment"===s.value?t("span",[t("linear-progress",{attrs:{value:"number"===typeof l[s.value]?l[s.value]:0,color:"green",height:e.tdHeight,reactive:"reactive",striped:"striped"}},[e._v(" "+e._s("number"===typeof l[s.value]?Math.round(l[s.value])+"%":"n.rel.")+" ")])],1):t("div",{class:{"deliverable--number":"id"===s.value,"selected-row":e.isSelected(l.id)},on:{click:function(t){return e.handleClick(t,i,l.id)}}},[e._v(" "+e._s(l[s.value])+" ")])])])})),0),l.children&&l.children.length>0?e._l(l.children,(function(l,n){return t("tr",{key:`child_${i}_${n}`},e._l(s,(function(s,r){return t("td",{key:"inner_child_"+r,class:{"expanded-td":e.expandedWidth},style:e.cellBackgroundStyle(l[s.value]),attrs:{title:e.expandedWidth?e.getTitle(l,s):""},on:{mouseover:function(e){l.showEditDialog=!0},mouseleave:function(t){return e.mouseLeave(l)}}},[s.editable?t("span",{class:{"left-justified":"description"===s.value||s.value.includes("responsible")}},[l.showEditDialog?t("span",[s.value.includes("step")?[t("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.handleSelectChange(l,s.value)}}},[e._v(" "+e._s(l[s.value])+" ")])]:[t("edit-dialog-table-body",{attrs:{item:l,header:s},on:{handleChangeCell:e.changeCell,handleClose1:e.close1,handleInputChanged:e.inputChanged,handleOpen:e.open}})]],2):t("span",[e._v(e._s(l[s.value]))])]):t("span",["fulfillment"===s.value?t("span",[t("linear-progress",{attrs:{value:"number"===typeof l[s.value]?l[s.value]:0,color:"green",height:e.tdHeight,reactive:"reactive",striped:"striped"}},[e._v(" "+e._s("number"===typeof l[s.value]?Math.round(l[s.value])+"%":"n.rel.")+" ")])],1):t("div",{class:{"deliverable--number":"id"==s.value,"selected-row":e.isSelected(l.id)},staticStyle:{cursor:"pointer"},on:{click:function(t){return e.handleClick(t,n,l.id,i)}}},[e._v(" "+e._s(l[s.value])+" ")])])])})),0)})):e._e()]})),e.toolboxVisible?t("div",{directives:[{def:p["a"],name:"click-outside",rawName:"v-click-outside",value:e.closetoolbox,expression:"closetoolbox"}],staticClass:"toolbox",style:{top:e.selectedRowTop+"px"}},[t(u["a"],{attrs:{small:""},on:{click:e.deleteRows}},[e._v("mdi-delete")]),t(u["a"],{attrs:{small:""},on:{click:e.createNewRowFromSelected}},[e._v("mdi-arrow-right")]),t(u["a"],{attrs:{small:""},on:{click:function(t){return t.stopPropagation(),e.ungroupSelectedChildren.apply(null,arguments)}}},[e._v("mdi-arrow-left")])],1):e._e()],2)]}},{key:"top",fn:function(){return[t("toolbar",{attrs:{showWeight:e.showWeight},on:{handleShowWeight:e.toggleWeight,handleUndelete:e.undoDelete}})]},proxy:!0}])})],1)])],1)],1),e.showConformMessage?t("div",[t("ConfirmMessage",{attrs:{message:e.message,pressedType:e.pressedType},on:{deleteRow:e.deleteRow,deleteStep:function(t){return e.deleteColumn("step")},deleteResponsible:function(t){return e.deleteColumn("responsible")},dontDelete:e.toggleShowConformMessage}})],1):e._e()],1)},g=[];l("14d9");class m{constructor(){}calculateRowFulfillment(e,t){let l=t.length,s=0,i=0,n=0;t.forEach(t=>{s+="closed"===e[t.identity]?1:0,i+="wip"===e[t.identity]?.5:0,n+="n.rel."===e[t.identity]?1:0});let r,a=l-n;r=n===l?"n.rel.":(s+i)/a*100,e.fulfillment=r}recalculateAllFulfillments(e,t){e.forEach(e=>{this.calculateRowFulfillment(e,t),e.isGrouped&&(e.children.forEach(e=>{this.calculateRowFulfillment(e,t)}),this.calculateParentFulfillment(e,t))})}calculateParentFulfillment(e,t){if(t.length>0){let t=0,l=0;e.children.forEach((e,s)=>{"number"===typeof e.fulfillment&&(t+=+e.weight,l+=e.fulfillment*e.weight)}),e.fulfillment=l/t}}}var b=l("8336"),v=function(){var e=this,t=e._self._c;return t("div",{staticClass:"backdrop",on:{click:function(t){return t.target!==t.currentTarget?null:e.closePopup("cancel")}}},[t("div",{staticClass:"popup"},[t("h3",[e._v(e._s(e.message))]),t(b["a"],{attrs:{color:"red darken-1",text:""},on:{click:function(t){return e.closePopup("cancel")}}},[e._v("Cancel")]),t(b["a"],{attrs:{color:"green darken-1",text:""},on:{click:function(t){return e.closePopup("yes")}}},[e._v("Yes")])],1)])},$=[],w={props:["message","pressedType"],methods:{closePopup(e){"cancel"===e?this.$emit("dontDelete"):"yes"===e&&("Row"===this.pressedType?this.$emit("deleteRow"):"step"===this.pressedType?this.$emit("deleteStep"):"responsible"===this.pressedType&&this.$emit("deleteResponsible"))}}},C=w,x=l("2877"),F=Object(x["a"])(C,v,$,!1,null,null,null),y=F.exports,S=l("2f62"),R=l("8e36"),E=function(){var e=this,t=e._self._c;return t(R["a"],{attrs:{value:e.value,color:e.color,height:e.height,reactive:"",striped:""}},[e._t("default")],2)},_=[],T={props:["value","color","height","reactive","striped"]},I=T,N=Object(x["a"])(I,E,_,!1,null,null,null),D=N.exports,O=l("7679"),k=l("8654"),W=function(){var e=this,t=e._self._c;return t(O["a"],{on:{close:function(t){return e.close1(e.item)},cancel:e.cancel,open:function(t){return e.open(e.item[e.header.value])},save:function(t){return e.changeCell(e.item,e.header.value)}},scopedSlots:e._u([{key:"input",fn:function(){return[t("span",["Weight"===e.header.text?t(k["a"],{attrs:{type:"number",rules:[e.rules.required,e.rules.positiveNumbers],value:e.item[e.header.value],label:"Edit","single-line":""},on:{focus:function(e){return e.target.select()},change:function(t){return e.inputChanged(t,"weight")}}}):t(k["a"],{attrs:{value:e.item[e.header.value],label:"Edit","single-line":""},on:{focus:function(e){return e.target.select()},change:function(t){return e.inputChanged(t)}}})],1)]},proxy:!0}])},[e._v(" "+e._s(e.item[e.header.value])+" ")])},M=[],j={props:["header","item"],data:()=>({rules:{counter:e=>e.length<=20||"Max 20 characters",required:e=>!!e||"Required.",positiveNumbers:e=>e>0||"Should be greater than 0",alreadyExist:!0}}),emits:["handleClose1","handleOpen","handleChangeCell","handleInputChanged"],methods:{close(){},cancel(){},close1(e){this.$emit("handleClose1",e)},open(e){this.$emit("handleOpen",e)},changeCell(e,t){this.$emit("handleChangeCell",e,t)},inputChanged(e,t){this.$emit("handleInputChanged",e,t)}}},A=j,H=Object(x["a"])(A,W,M,!1,null,null,null),B=H.exports,U=l("cc20"),P=l("ce7e"),V=l("23a7"),L=l("2fa4"),q=l("71d9"),z=l("2a7f"),G=function(){var e=this,t=e._self._c;return t(q["a"],{staticClass:"mb-0 mt-0",attrs:{height:"32",flat:"",color:"white"}},[t(z["a"],[e._v("Tasks")]),t(P["a"],{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),t(b["a"],{staticClass:"mb-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.generateExcel}},[e._v("Generate Excel")]),t(b["a"],{staticClass:"mb-2 ml-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.adjustSize}},[e._v(e._s(e.adjustText))]),t(b["a"],{staticClass:"mb-2 ml-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.addRow}},[e._v("Add Row")]),t(P["a"],{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),t(V["a"],{attrs:{dense:"",placeholder:"Load excel file",label:"File input","prepend-icon":"mdi-paperclip","show-size":""},on:{change:e.loadExcel},scopedSlots:e._u([{key:"selection",fn:function({text:l}){return[t(U["a"],{attrs:{small:"",label:"",color:"primary"}},[e._v(e._s(l))])]}}]),model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),t(P["a"],{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),t(L["a"]),t(b["a"],{staticClass:"mr-2 mb-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.undoDelete}},[e._v(" UNDELETE ")]),t(b["a"],{staticClass:"mb-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.toggleWeight}},[e._v(e._s(e.showWeight))]),t("AddColumn")],1)},Z=[],J=l("e8ae"),K=l.n(J),X=l("21a6");const Y="closed",Q="wip",ee="open",te="n.rel.";class le{constructor(e,t,l,s,i){this.deliverables=e,this.steps=t,this.responsibles=l,this.stepsFulfillment=s,this.totalFulfillment=i}async saveAsExcel(e){const t=new K.a.Workbook,l=t.addWorksheet("TestSheet");this.calculateFirstRow(l,e.steps,e.responsibles,e.stepsFulfillment,e.totalFulfillment);const s=this.formTableRows(l,e);this.addFormattingFulfillmentsColumns(l,e,s),this.addFormattingFirstRow(l,e),this.addStepDropDownAndColor(l,e,s),this.addfulfillmentFormula(l,e),this.addFirstRowFormula(l,e,s),this.addChildRowStepsFormula(l,e);const i=[];e.headers.forEach(e=>{i.push({name:e.text,filterButton:!0})}),l.addTable({name:"MyTable",ref:"A2",headerRow:!0,style:{showRowStripes:!0},columns:i,rows:s});const n=await t.xlsx.writeBuffer();Object(X["saveAs"])(new Blob([n]),"Tasks.xlsx")}calculateFirstRow(e,t,l,s,i){const n=[];for(let o=0;o<l.length;o++)n.push("");const r=[];t.forEach(e=>{r.push(s[e.identity]/100)});const a=["","","",...n,...r,i/100];console.log("first row",a),e.addRow(a)}addFormattingFirstRow(e,t){let l=3+t.responsibles.length,s=e._columns[l].letter,i=e._columns[l+t.steps.length].letter;e.addConditionalFormatting({ref:`${s}1:${i}1`,rules:[{type:"dataBar",color:{argb:"C6EFCE"},gradient:!1,cfvo:[{type:"num",value:0},{type:"num",value:1}],style:{font:{color:{argb:"006100"}}}}]});for(let n=l;n<=l+t.steps.length;n++){let t=e._columns[n].letter;this.addNumberFormatting(e,t+"1")}}addFormattingChildRows(e,t){e.addConditionalFormatting({ref:""+t,rules:[{type:"dataBar",color:{argb:"C6EFCE"},gradient:!1,cfvo:[{type:"num",value:0},{type:"num",value:1}],style:{font:{color:{argb:"006100"}}}}]}),this.addNumberFormatting(e,t)}addFirstRowFormula(e,t,l){const s=3+t.responsibles.length,i=s+t.steps.length,n=e._columns[2].letter;for(let r=s;r<=i;r++){const s=e._columns[r].letter,i=s+"1";let a=[],o=3,d=[],h=0;for(let r=1;r<=t.deliverables.length;r++){let u=t.deliverables[r-1];if(u&&1==u.isChild){let e=u.children.length;console.log("run child parts"),h+=1,a.push(`${n}${o}`);for(let t=1;t<=e;t++)d.push(`(\n              IF(ISNUMBER(${s}${o+t}), ${s}${o+t}, \n                IF(${s}${o+t}="${Y}", 1, \n                  IF(${s}${o+t}="${Q}", 0.5, \n                    IF(${s}${o+t}="${ee}", 0, \n                      IF(${s}${o+t}="${te}", 0, 0)\n                    )\n                  )\n                )\n              ) * ${n}${o+t}\n            )`);o+=e+1}else d.push(`(\n            IF(ISNUMBER(${s}${o}), ${s}${o}, \n              IF(${s}${o}="${Y}", 1, \n                IF(${s}${o}="${Q}", 0.5, \n                  IF(${s}${o}="${ee}", 0, \n                    IF(${s}${o}="${te}", 0, 0)\n                  )\n                )\n              )\n            ) * ${n}${o}\n          )`),o+=1;const c=`COUNTIF(${s}3:${s}${2+l.length}, "n.rel.")`;e.getCell(i).value={formula:c};a.map(e=>`IF(${e} > 0, ${e}, 0)`);console.log("excludes weights cells",a);let p=`=IF(${c} = ${l.length-h}, "n.rel.", \n              IFERROR(SUM(${d.join(", ")}), "") / \n                (SUM(${n}3:${n}${2+l.length}) - \n                SUMIF(${s}3:${s}${2+l.length},\n                  "n.rel.", ${n}3:${n}${2+l.length}) \n                      - SUM(${a.length>0?a:0})\n                  ))`;e.getCell(i).value={formula:p}}}}addFirstRowFormula2(e,t,l){const s=3+t.responsibles.length,i=s+t.steps.length,n=e._columns[2].letter,r=t.deliverables.length+2;console.log("delver leng",t.deliverables);for(let a=s;a<=i;a++){const t=e._columns[a].letter,l=t+"1";let s=3,i=(e.getCell(n+s).value,`=IFERROR((COUNTIF(${t}${s}:${t}${r},"${Y}") \n          +COUNTIF(${t}${s}:${t}${r},"${Q}")* 0.5) / \n          (COUNTIF(${t}${s}:${t}${r},"${ee}") \n          +COUNTIF(${t}${s}:${t}${r},"${Q}") \n          +COUNTIF(${t}${s}:${t}${r},"${Y}")) ,"${te}")`);e.getCell(l).value={formula:i}}}addFirstRowFormula3(e,t,l){const s=3+t.responsibles.length,i=s+t.steps.length,n=e._columns[2].letter;t.deliverables.length;for(let r=s;r<=i;r++){const t=e._columns[r].letter,s=t+"1",i=3,a=i+l.length-1,o=`=IFERROR(\n        SUMPRODUCT(\n          (((${t}${i}:${t}${a} = "${Y}") +\n            (${t}${i}:${t}${a} = "${Q}") * 0.5) *\n            (${n}${i}:${n}${a})) *\n            ((${t}${i}:${t}${a} <> "${te}") * 1)\n        ) /\n        SUMIFS(\n          ${n}${i}:${n}${a},\n          ${t}${i}:${t}${a},\n          "<> ${te}"\n        ),\n        "${te}"\n      )`;e.getCell(s).value={formula:o}}}addChildRowStepsFormula(e,t){const l=3+t.responsibles.length,s=l+t.steps.length,i=e._columns[2].letter;for(let n=l;n<=s;n++){const l=e._columns[n].letter;let s=3;for(let n=1;n<=t.deliverables.length;n++){let r=t.deliverables[n-1];const a=[];let o;const d=l+""+s;if(r&&1==r.isChild){this.addFormattingChildRows(e,d),o=r.children.length;for(let e=1;e<=o;e++)a.push(`(\n              IF(ISNUMBER(${l}${s+e}), ${l}${s+e}, \n                IF(${l}${s+e}="${Y}", 1, \n                  IF(${l}${s+e}="${Q}", 0.5, \n                    IF(${l}${s+e}="${ee}", 0, \n                      IF(${l}${s+e}="${te}", 0, 0)\n                    )\n                  ) \n                )\n              ) * ${i}${s+e}\n            )`);let t=`COUNTIF(${l}${s+1}:${l}${s+o}, "n.rel.")`,n=`=IF(${t} = ${o}, "n.rel.", \n            IFERROR(SUM(${a.join(", ")}), "") / \n              (SUM(${i}${s+1}:${i}${s+o}) - \n              SUMIF(${l}${s+1}:${l}${s+o},\n                "n.rel.", ${i}${s+1}:${i}${s+o})))`;e.getCell(d).value={formula:n},console.log("child row cell formula and the cell is "+d,e.getCell(d).value),s+=o}s++}}}addDropDownAndColor(e,t){e.getCell(t).dataValidation={type:"list",allowBlank:!0,formulae:[`"${ee},${Q},${Y},${te}"`]},this.addColorFormatting(e,t)}addStepDropDownAndColor(e,t,l){let s=3+t.responsibles.length,i=s+t.steps.length-1;for(let n=s;n<=i;n++){let l=3,s=e._columns[n].letter;for(let i=1;i<=t.deliverables.length;i++){let n,r=t.deliverables[i-1];if(r&&1==r.isChild){l+=1;for(let t=1;t<r.children.length;t++)n=`${s}${l}`,this.addDropDownAndColor(e,n),l+=1}n=`${s}${l}`,this.addDropDownAndColor(e,n),l+=1}}}addFormattingFulfillmentsColumns(e,t,l){let s=3+t.responsibles.length+t.steps.length,i=e._columns[s].letter;e.addConditionalFormatting({ref:`${i}3:${i}${l.length+2}`,rules:[{type:"dataBar",color:{argb:"C6EFCE"},gradient:!1,cfvo:[{type:"num",value:0},{type:"num",value:1}],style:{font:{color:{argb:"006100"}}}}]});for(let n=1;n<=l.length;n++)this.addNumberFormatting(e,i+(n+2))}addfulfillmentFormulaHelper(e,t,l){let s=`=IFERROR((COUNTIF(${e}${l}:${t}${l},"${Y}") \n          +COUNTIF(${e}${l}:${t}${l},"${Q}")* 0.5) / \n          (COUNTIF(${e}${l}:${t}${l},"${ee}") \n          +COUNTIF(${e}${l}:${t}${l},"${Q}") \n          +COUNTIF(${e}${l}:${t}${l},"${Y}")) ,"${te}")`;return s}addfulfillmentFormula(e,t){let l=3+t.responsibles.length+t.steps.length,s=e._columns[l].letter,i=3+t.responsibles.length,n=3,r=e._columns[i].letter,a=e._columns[i+t.steps.length-1].letter;for(let o=1;o<=t.deliverables.length;o++){const l=t.deliverables[o-1];let i;if(l&&!0===l.isChild){i=l.children.length;for(let t=1;t<=i;t++){let l=this.addfulfillmentFormulaHelper(r,a,n+t),i=`${s}${n+t}`;e.getCell(i).value={formula:l}}n+=i+1}else{let t=this.addfulfillmentFormulaHelper(r,a,n),l=`${s}${n}`;e.getCell(l).value={formula:t},n+=1}}}addNumberFormatting(e,t){e.getCell(t).numFmt="0%"}formTableRows(e,t){const l=[];return t.deliverables.forEach((e,s)=>{let i=[];if(e.isChild){const s=[];t.responsibles.forEach(t=>{s.push(e[t.identity])}),console.log("responsible rows",s);const i=[e.id,e.description,e.weight,...s];l.push(i),e.children.forEach((e,s)=>{let i=[];i.push(e.id),i.push(e.description),i.push(parseFloat(e.weight)),t.responsibles.forEach(t=>{i.push(e[t.identity])}),t.steps.forEach(t=>{i.push(e[t.identity])}),l.push(i)})}else i.push(e.id),i.push(e.description),i.push(parseFloat(e.weight)),t.responsibles.forEach(t=>{i.push(e[t.identity])}),t.steps.forEach(t=>{i.push(e[t.identity])}),l.push(i)}),l}addColorFormatting(e,t){e.addConditionalFormatting({ref:t,rules:[{type:"cellIs",operator:"equal",color:{argb:"FF00FF00"},formulae:[`"${Y}"`],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:"C6EFCE"}},font:{color:{argb:"006100"}}}}]}),e.addConditionalFormatting({ref:t,rules:[{type:"cellIs",operator:"equal",color:{argb:"FF00FF00"},formulae:[`"${ee}"`],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:"FFC7CE"}},font:{color:{argb:"9C0006"}}}}]}),e.addConditionalFormatting({ref:t,rules:[{type:"cellIs",operator:"equal",color:{argb:"FF00FF00"},formulae:[`"${Q}"`],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:"FFEB9C"}},font:{color:{argb:"9C6500"}}}}]}),e.addConditionalFormatting({ref:t,rules:[{type:"cellIs",operator:"equal",color:{argb:"FF00FF00"},formulae:[`"${te}"`],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:""}}}}]})}async loadExcel(e){let t=[];const l=new K.a.Workbook,s=new FileReader;return s.readAsArrayBuffer(e.file),new Promise(e=>{s.onload=async()=>{const i=s.result,n=await l.xlsx.load(i);let r,a=n.getWorksheet(1),o=4,d=0,h=0,u=0,c=3;a.eachRow((e,l)=>{if(l<2)return;let s=e.values;if(s.shift(),2==l)return void(r=s);3==l&&(s.some((e,t)=>{if(e==""+ee||e==""+Q||e==""+Y||e==""+te)return o=t+1,!0}),o-c!=1&&(h=c+1,u=o-1),d=s.length-1);const i={id:e.getCell(1).value,description:e.getCell(2).value,weight:e.getCell(3).value,showEditDialog:!1};let n=1;if(0!=h)for(let t=h;t<=u;t++)1==n?i["responsible"]=e.getCell(t).value:i["responsible"+n]=e.getCell(t).value,n++;n=1;for(let t=o;t<=d;t++)i["step"+n]=e.getCell(t).value,n++;i["fulfillment"]=e.getCell(s.length).value,t.push(i)});let p=[],f=1;if(0!=h)for(let e=h;e<=u;e++)1==f?p.push({text:r[e-1],identity:"responsible"}):p.push({text:r[e-1],identity:"responsible"+f}),f++;const g=[];let m=1;for(let e=o;e<=d;e++)g.push({text:r[e-1],identity:"step"+m}),m++;const b=[{text:"No",align:"start",value:"id",sortable:!0,editable:!1,headerEditable:!1},{text:"Description",value:"description",editable:!0},{text:"Weight",value:"weight",editable:!0},{text:"Fulfillment",value:"fulfillment",editable:!1}];if(f=1,p.length>0)for(let e=h;e<=u;e++)1==f?b.splice(e-1,0,{text:""+r[e-1],value:"responsible",editable:!0,sortable:!1,headerEditable:!0}):b.splice(e-1,0,{text:""+r[e-1],value:"responsible"+f,editable:!0,sortable:!1,headerEditable:!0}),f++;m=1;for(let e=o;e<=d;e++)b.splice(e-1,0,{text:""+r[e-1],value:"step"+m,editable:!0,sortable:!1,headerEditable:!0}),m++;const v={deliverables:t,responsibles:p,steps:g,headers:b};e(v)}}).then(e=>e)}}var se=function(){var e=this,t=e._self._c;return t("div",[t(b["a"],{staticClass:"mx-2 mb-2",attrs:{"x-small":"",dark:"",color:"primary"},on:{click:function(t){return e.addColumn("Status")}}},[e._v("ADD STATUS COLUMN")]),t(b["a"],{staticClass:"mx-2 mb-2",attrs:{"x-small":"",dark:"",color:"primary"},on:{click:function(t){return e.addColumn("Responsible")}}},[e._v("ADD RESPONSIBLE COLUMN")])],1)},ie=[],ne={data(){return{stepOffset:3,nextColumnName:this.getNextColumnName("Status"),rules:{counter:e=>e.length<=20||"Max 20 characters",required:e=>!!e||"Required.",alreadyExist:e=>!this.headers.find(t=>e.toLowerCase()===t.text.toLowerCase())||"Column name already exist"}}},methods:{getNextColumnName(e){return this.$store.getters.getNextColumnName(e)},addColumn(e){this.nextColumnName=this.getNextColumnName(e),!0===this.rules.required(this.nextColumnName)&&!0===this.rules.alreadyExist(this.nextColumnName)&&("Status"===e?this.addStatusColumn():this.addResponsibleColumn(),this.$store.dispatch("setHeaders",this.headers),this.$store.dispatch("setDeliverables",this.deliverables),this.$store.dispatch("setNextColumnName",e))},addStatusColumn(){let e=this.steps.length,t=this.nextColumnName,l="step"+(e+1);this.headers.splice(this.headers.length-1,0,{text:t,value:l,editable:!0,sortable:!1,headerEditable:!0,columnDeleteIcon:!1}),this.steps.push({text:t,identity:l}),this.deliverables.forEach(e=>{e.isGrouped?e.children.map(e=>{this.$set(e,l,"open")}):this.$set(e,l,"open")});const s=new m;s.recalculateAllFulfillments(this.deliverables,this.steps),this.$store.dispatch("setSteps",this.steps)},addResponsibleColumn(){let e=this.responsibles.length,t=this.nextColumnName,l=this.$store.getters.nextResponsibleIdentity;this.headers.splice(e+this.stepOffset,0,{text:t,value:l,editable:!0,sortable:!1,headerEditable:!0,columnDeleteIcon:!1}),this.responsibles.push({text:t,identity:l}),this.$store.dispatch("setResponsibles",this.responsibles)}},computed:{...Object(S["b"])(["statusTable"]),headers(){return this.statusTable.headers},deliverables(){return this.statusTable.deliverables},responsibles(){return this.statusTable.responsibles},steps(){return this.statusTable.steps}}},re=ne,ae=Object(x["a"])(re,se,ie,!1,null,null,null),oe=ae.exports;const de=new m;var he={props:["showWeight"],emits:["handleShowWeight","handleUndelete"],data:()=>({horizontalAdjusted:!1,adjustText:"Fit On Page",heightScale:0,widthScale:0,file:null}),components:{AddColumn:oe},computed:{stepsFulfillment(){return this.$store.getters.stepsFulfillment},...Object(S["b"])(["statusTable"]),headers(){return this.statusTable.headers},filteredHeaders(){return this.statusTable.headers.filter(e=>"Show Weight"!==this.showWeight||"weight"!==e.value)},deliverables(){return this.statusTable.deliverables},responsibles(){return this.statusTable.responsibles},steps(){return this.statusTable.steps},totalFulfillment(){return Math.round(this.$store.getters.totalFulfillment)}},methods:{generateExcel(){const e=new le(this.deliverables,this.steps,this.responsibles,this.stepsFulfillment,this.totalFulfillment),t={deliverables:this.deliverables,headers:this.headers,steps:this.steps,responsibles:this.responsibles,stepsFulfillment:this.stepsFulfillment,totalFulfillment:this.totalFulfillment};e.saveAsExcel(t)},adjustSize(){const e=document.getElementsByTagName("table")[0],t=document.getElementsByClassName("v-data-table__wrapper")[0];if("Normal Size"===this.adjustText)this.horizontalAdjusted||(t.style.width=t.clientWidth*this.heightScale+"px"),e.style.transform="scale(1)",this.adjustText="Fit On Page";else{const l=t.clientWidth,s=t.clientHeight,i=t.scrollWidth,n=t.scrollHeight;this.widthScale=l/i,this.heightScale=s/n,this.widthScale<this.heightScale?(e.style.transform=`scale(${this.widthScale})`,this.horizontalAdjusted=!0):(e.style.transform=`scale(${this.heightScale})`,t.style.width=t.clientWidth/this.heightScale+"px",this.horizontalAdjusted=!1),this.adjustText="Normal Size"}},addRow(){let e=1,t=this.deliverables.length;0!==t&&(e=this.deliverables[t-1].id+1);const l={id:e,description:"",responsible:"",weight:1,fulfillment:0,showEditDialog:!1};this.steps.forEach(e=>{let t=e.identity;l[t]="open"}),this.deliverables.push(l),this.$store.dispatch("setDeliverables",this.deliverables)},async loadExcel(){if(this.file){const e=new le(this.deliverables,this.steps,this.responsibles,this.stepsFulfillment,this.totalFulfillment),t={file:this.file,deliverables:this.deliverables,headers:this.headers,steps:this.steps,responsibles:this.responsibles,stepsFulfillment:this.stepsFulfillment,totalFulfillment:this.totalFulfillment};let l=await e.loadExcel(t);de.recalculateAllFulfillments(l.deliverables,l.steps),this.$store.dispatch("setDeliverables",l.deliverables),this.$store.dispatch("setSteps",l.steps),this.$store.dispatch("setResponsibles",l.responsibles),this.$store.dispatch("setHeaders",l.headers),this.$store.dispatch("setRowCounterToZero",0)}},toggleWeight(){this.$emit("handleShowWeight")},undoDelete(){this.$emit("handleUndelete")}}},ue=he,ce=Object(x["a"])(ue,G,Z,!1,null,null,null),pe=ce.exports,fe=function(){var e=this,t=e._self._c;return e.header.headerEditable?t(O["a"],{on:{open:function(t){return e.headerTextFieldOpen(e.header.text)},save:function(t){return e.changeHeader(e.header)}},scopedSlots:e._u([{key:"input",fn:function(){return[t(k["a"],{attrs:{value:e.header.text,rules:[e.rules.required,e.rules.alreadyExist],counter:"",maxlength:"20",label:"Edit","single-line":""},on:{focus:function(e){return e.target.select()},change:function(t){return e.inputChanged(t)}}})]},proxy:!0}],null,!1,1862401062)},[t("span",[t("span",[e._v(" "+e._s(e.header.text)+" ")])])]):e._e()},ge=[],me={props:["header"],emits:["handleHeaderTextFileOpend","handleChangeHeader","handleInputChange"],data:()=>({rules:{counter:e=>e.length<=20||"Max 20 characters",required:e=>!!e||"Required.",positiveNumbers:e=>e>0||"Should be greater than 0",alreadyExist:!0}}),methods:{headerTextFieldOpen(e){this.$emit("handleHeaderTextFileOpend",e)},changeHeader(e){this.$emit("handleChangeHeader",e)},inputChanged(e,t){this.$emit("handleInputChange",e,t)}}},be=me,ve=Object(x["a"])(be,fe,ge,!1,null,null,null),$e=ve.exports;const we=new m;var Ce={name:"HelloWorld",components:{ConfirmMessage:y,LinearProgress:D,EditDialogTableHeader:$e,EditDialogTableBody:B,Toolbar:pe},data:()=>({index:-1,selectedRowTop:0,selectedRows:[],selectedRow:null,isRangeSelected:!1,deletedRows:[],deletedRowsStack:[],isShiftPressed:!1,toolboxVisible:!1,expandedWidth:!0,isDialogOpen:!1,showEditDialog:!0,selectItems:["open","wip","closed","n.rel."],rotateValues:{id:0,description:0,weight:0,fulfillment:0},sortBy:"id",sortDesc:!1,file:null,inputValue:"",showWeight:"Show Weight",max20chars:e=>e.length<=20||"Maximum 20 character allowed",rules:{counter:e=>e.length<=20||"Max 20 characters",required:e=>!!e||"Required.",positiveNumbers:e=>e>0||"Should be greater than 0",alreadyExist:!0},adjustText:"Fit On Page",heightScale:0,widthScale:0,horizontalAdjusted:!1,thHeight:16,thWidth:0,tdHeight:16,headerEditValue:"",defaultItem:{id:"",description:"",oneWeekBefore:"",untilDayBefore:"",fulfillment:0},stepOffset:3,showDeleteIcon:!1,columnDeleteIcon:!1,message:"The Message",pressedId:"",pressedType:"",showConformMessage:!1,activeChildIndex:null}),computed:{stepsFulfillment(){return this.$store.getters.stepsFulfillment},subProjectStepsFullFilment(){return this.$store.getters.subProjectStepsFullFilment},...Object(S["b"])(["statusTable"]),headers(){return this.statusTable.headers},filteredHeaders(){return this.statusTable.headers.filter(e=>"Show Weight"!==this.showWeight||"weight"!==e.value)},deliverables(){return this.statusTable.deliverables},responsibles(){return this.statusTable.responsibles},steps(){return this.statusTable.steps},totalFulfillment(){return Math.round(this.$store.getters.totalFulfillment)}},mounted:function(){console.log("deliverales",this.deliverables),this.$nextTick((function(){this.$refs.headerRef&&(this.thHeight=this.$refs.headerRef.clientHeight),this.thWidth=this.$refs.headerRef.clientWidth,this.$refs.rowRef&&(this.tdHeight=this.$refs.rowRef[0].clientHeight);const e=document.getElementsByClassName("v-toolbar__content")[0].clientHeight,t=document.getElementsByClassName("overflow-c")[0].clientHeight,l=document.getElementsByClassName("v-data-table__wrapper")[0];l.style.maxHeight=t-e+"px"}))},watch:{dialog(e){e||this.close()}},methods:{ungroupSelectedChildren(){const e=[];this.selectedRows.forEach(t=>{const l=this.findParentIndex(t);if(-1!==l){const s=this.findChildIndex(l,t);-1!==s&&e.push({parentIdx:l,childIdx:s})}}),e.sort((e,t)=>t.parentIdx-e.parentIdx||t.childIdx-e.childIdx),e.forEach(({parentIdx:e,childIdx:t})=>{this.ungroupChild(e,t)}),this.selectedRows=[],this.$store.dispatch("setDeliverables",this.deliverables),we.recalculateAllFulfillments(this.deliverables,this.steps)},ungroupChild(e,t){const l=this.deliverables[e],s=l.children[t];l.children.splice(t,1),this.deliverables.splice(e+1,0,s),0===l.children.length&&this.deliverables.splice(e,1),this.recalculateNumbering()},findParentIndex(e){for(let t=0;t<this.deliverables.length;t++)if(this.deliverables[t].children)for(let l=0;l<this.deliverables[t].children.length;l++)if(this.deliverables[t].children[l].id===e)return t;return-1},findChildIndex(e,t){const l=this.deliverables[e];for(let s=0;s<l.children.length;s++)if(l.children[s].id===t)return s;return-1},recalculateNumbering(){this.deliverables.forEach((e,t)=>{e.id=t+1,e.children&&e.children.length>0&&e.children.forEach((t,l)=>{t.id=`${e.id}.${l+1}`})})},closetoolbox(e){e.target.classList.contains("deliverable--number")||(this.toolboxVisible=!1,this.index=-1,this.selectedRows=[])},include(){return[document.querySelector(".deliverable--number")]},renumberDeliverables(e){return e.map((e,t)=>{if(!e.isGrouped)return{...e,id:t+1};const l={...e,id:t+1};return l.children&&l.children.length>0&&(l.children=l.children.map((e,t)=>({...e,id:`${l.id}.${t+1}`}))),l})},createNewRowFromSelected(){if(this.selectedRows.length>0){const e={description:"Subproject",fulfillment:0,id:Math.min(...this.selectedRows),responsible:"",showEditDialog:!1,weight:0,isChild:!0,children:[],isGrouped:!0};let t=0;e.children=this.selectedRows.map((l,s)=>{const i=this.deliverables.find(e=>e.id===l);return t+=parseInt(i.weight),{...i,id:`${e.id}.${s+1}`,isGrouped:!0,parentId:e.id}}),e.weight=t;let l=this.deliverables.filter(e=>!this.selectedRows.includes(e.id));this.calculateStepsFulfillmentForNewRow(e);const s=l.findIndex(t=>e.id-1<t.id),i=-1!==s?s:l.length;l.splice(i,0,e),this.selectedRows=[],this.toolboxVisible=!1,l=this.renumberDeliverables(l),this.$store.dispatch("setDeliverables",l)}},calculateStepsFulfillmentForNewRow(e){if(e.weight>0){let t=0;if(this.steps.forEach(t=>{let l=0,s=0,i=0;e.children.forEach((e,n)=>{"n.rel."!==e[t.identity]&&(l+=+e.weight),i+="closed"===e[t.identity]?1*e.weight:0,s+="wip"===e[t.identity]?.5*e.weight:0}),e[t.identity]=(i+s)/l*100}),this.steps.length>0){let l=0;e.children.forEach((e,s)=>{"number"===typeof e.fulfillment&&(l+=+e.weight,t+=e.fulfillment*e.weight)}),e.fulfillment=t/l}}},deleteRows(){if(this.selectedRows.length>0){const e=[];this.selectedRows.forEach(t=>{const l=this.deliverables.findIndex(e=>e.id===t);if(-1!==l){const t=this.deliverables[l];t.children&&t.children.length>0?(e.push(...t.children),e.push(t),this.deliverables.splice(l,1)):(e.push(t),this.deliverables.splice(l,1))}else this.deliverables.forEach((l,s)=>{const i=l.children?l.children.findIndex(e=>e.id===t):-1;if(-1!==i){const t=l.children.splice(i,1)[0];e.push(t),0===l.children.length&&(this.deliverables.splice(s,1),e.push(l))}})}),this.selectedRows=[],this.deletedRowsStack.push(e),we.recalculateAllFulfillments(this.deliverables,this.steps),this.$store.dispatch("setDeliverables",this.deliverables),this.toolboxVisible=!1,this.index=null}},getNextAvailableId(e){let t=1,l=e.length;return 0!==l&&(t=this.deliverables[l-1].id+1),t},undoDelete(){if(this.deletedRowsStack.length>0){const e=this.deletedRowsStack.pop();e.forEach(e=>{if(e.parentId){const t=this.deliverables.find(t=>t.id===e.parentId);t&&(t.children=t.children||[],t.children.push(e),t.children.sort((e,t)=>e.id-t.id))}else{const t=this.deliverables.find(t=>t.id===e.id);t&&(e.id=this.getNextAvailableId(this.deliverables)),this.deliverables.push(e)}});const t=new m;t.recalculateAllFulfillments(this.deliverables,this.steps),this.$store.dispatch("setDeliverables",this.deliverables)}},handleClick(e,t,l,s=null){if(this.positionToolBox(t,s),e.shiftKey)return this.handleRangeSelection(this.index,t,s),this.index=null,void(this.isRangeSelected=!0);e.ctrlKey?(this.selectedRows.push(l),this.isRangeSelected=!0,this.index=null):(this.selectedRows=[l],this.index=t,this.isRangeSelected=!1)},isSelected(e){return this.selectedRows.includes(e)},handleRangeSelection(e,t,l=null){e>t&&([e,t]=[t,e]);for(let n=e;n<=t;n++){var s,i;const e=l?null===(s=this.deliverables[l].children[n])||void 0===s?void 0:s.id:null===(i=this.deliverables[n])||void 0===i?void 0:i.id;this.selectedRows.includes(e)||this.selectedRows.push(e)}},positionToolBox(e,t){const l=20;this.selectedRowTop=(null!==t?t+e:e)*l,this.toolboxVisible=!0},handleSelectChange(e,t){const l=["open","wip","closed","n.rel."],s=l.indexOf(e[t]),i=(s+1)%l.length;if(this.$set(e,t,l[i]),e.isChild||this.calculateRowFulfillment(e),void 0!==e.parentId){let t=this.deliverables.find(t=>t.id===e.parentId);this.calculateStepsFulfillmentForNewRow(t)}this.$store.dispatch("setDeliverables",this.deliverables)},getProgressBarStyles(e,t){return(t[e.value]?Math.round(t[e.value]):0)+"%"},toggleWidth(){this.expandedWidth=!this.expandedWidth},getTitle(e,t){return t.value.includes("step")||!isNaN(e[t.value])?"":e[t.value]},toggleWeight(){"Show Weight"===this.showWeight?this.showWeight="Hide Weight":this.showWeight="Show Weight"},mouseLeave(e){this.isDialogOpen||(e.showEditDialog=!1)},headerTextFieldOpen(e){this.inputValue=e,this.rules.alreadyExist=t=>!this.headers.find(l=>t.toLowerCase()===l.text.toLowerCase()&&t.toLowerCase()!==e.toLowerCase())||"Column name already exist"},calculateRowFulfillment(e){let t=this.steps.length,l=0,s=0;if(this.steps.forEach(i=>{l+="closed"===e[i.identity]?1:0,s+="wip"===e[i.identity]?.5:0,t-="n.rel."===e[i.identity]?1:0}),t>0){let i=(l+s)/t*100;e.fulfillment=i}else e.fulfillment="n.rel."},cellBackgroundStyle(e){return{backgroundColor:this.getColor(e)}},getColor(e){return"open"===e?"#FF0000":"wip"===e?"orange":"n.rel."===e?"#778899":"closed"===e?"#7bea7b":null},close1(e){setTimeout(()=>{this.isDialogOpen=!1,e.showEditDialog=!1},500)},close(){},cancel(){},open(e){this.isDialogOpen=!0,this.inputValue=e},changeCell(e,t){e[t]=this.inputValue,e.showEditDialog=!1,this.isDialogOpen=!1,this.calculateRowFulfillment(e),this.$store.dispatch("setDeliverables",this.deliverables)},changeHeader(e){!0===this.rules.required(this.inputValue.length)&&!0===this.rules.alreadyExist(this.inputValue)&&(e.text=this.inputValue,this.$store.dispatch("setHeaders",this.headers))},inputChanged(e,t){"weight"===t?""!==e&&e>0&&(this.inputValue=e):this.inputValue=e},sortColumn(e){this.sortBy===e?(this.sortDesc=!0,0===this.rotateValues[e]&&(this.sortDesc=!1)):(this.sortDesc=!1,this.sortBy=e,this.rotateValues.id=0,this.rotateValues.description=0,this.rotateValues.weight=0,this.rotateValues.fulfillment=0)},showDelete(e){this.deliverables[e].showDeleteIcon=!0},unShowDelete(e){this.deliverables[e].showDeleteIcon=!1},showColumnDelete(e){++e,this.headers[e].columnDeleteIcon=!0},unShowColumnDelete(e){++e,this.headers[e].columnDeleteIcon=!1},conformMessage(e,t,l){"column"===l?("Show Weight"===this.showWeight&&++t,t>2&&t<this.responsibles.length+3?(this.pressedId=t,this.pressedType="responsible"):(this.pressedId=t,this.pressedType="step"),this.message=`Do you want to delete ${this.headers[t].text} column?`):(this.pressedId=t,this.pressedType="Row",this.message=e),this.toggleShowConformMessage()},deleteRow(){let e=this.pressedId;for(this.deliverables.splice(e,1),e;e<this.deliverables.length;e++)this.deliverables[e].id=this.deliverables[e].id-1;this.$store.dispatch("setDeliverables",this.deliverables),this.toggleShowConformMessage()},deleteColumn(e){let t=this.pressedId;if(e.includes("step")){let e=t-(this.responsibles.length+3),l=this.steps.length;this.steps.splice(e,1),this.headers.splice(t,1);for(let t=0;t<this.steps.length;t++)this.steps[t].identity="step"+(t+1),this.steps[t].text="step"+(t+1);let s=1;for(let t=3+this.responsibles.length;t<this.headers.length-1;t++)this.headers[t].text.includes("Step")&&(this.headers[t].text="Step"+s),this.headers[t].value="step"+s,s++;for(let t=0;t<this.deliverables.length;t++){for(let l=e;l<this.steps.length;l++)this.deliverables[t]["step"+(l+1)]=this.deliverables[t]["step"+(l+2)];this.calculateRowFulfillment(this.deliverables[t]),this.deliverables[t].isGrouped&&this.deliverables[t].children.forEach(e=>{this.calculateRowFulfillment(e)}),delete this.deliverables[t]["step"+l]}this.$store.dispatch("setHeaders",this.headers),this.$store.dispatch("setDeliverables",this.deliverables),this.$store.dispatch("setNextColumnName",this.$store.getters.getNextColumnName("Status")),this.toggleShowConformMessage(),we.recalculateAllFulfillments(this.deliverables,this.steps)}else if(e.includes("responsible")){for(let l=0;l<this.deliverables.length;l++){let e=t;for(e;e<this.responsibles.length+3;e++)this.deliverables[l]["responsible"+(e-1)]?this.deliverables[l]["responsible"+(e-2)]=this.deliverables[l]["responsible"+(e-1)]:this.deliverables[l]["responsible"+(e-1)]||(this.deliverables[l]["responsible"+(e-2)]="")}for(let t=0;t<this.deliverables.length;t++)delete this.deliverables[t]["responsible"+this.responsibles.length];this.headers.splice(t,1),this.responsibles.splice(t-3,1);for(let t=0;t<this.responsibles.length;t++)this.responsibles[t].identity="responsible"+(t+1),this.responsibles[t].text="Responsible"+(t+1);let e=1;for(let t=3;t<this.responsibles.length+3;t++)this.headers[t].text.includes("Responsible")&&(this.headers[t].text="Responsible"+e),this.headers[t].value="responsible"+e,e++;this.$store.dispatch("setHeaders",this.headers),this.$store.dispatch("setResponsibles",this.responsibles),this.$store.dispatch("setDeliverables",this.deliverables),this.toggleShowConformMessage()}},toggleShowConformMessage(){this.showConformMessage=!this.showConformMessage}}},xe=Ce,Fe=Object(x["a"])(xe,f,g,!1,null,null,null),ye=Fe.exports,Se={name:"App",created(){document.title="Earned Value"},components:{StatusTable:ye},data:()=>({drawer:!1})},Re=Se,Ee=Object(x["a"])(Re,r,a,!1,null,null,null),_e=Ee.exports,Te=l("8c4f"),Ie=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("StatusTable")],1)},Ne=[],De={name:"Home",components:{StatusTable:ye}},Oe=De,ke=Object(x["a"])(Oe,Ie,Ne,!1,null,null,null),We=ke.exports;s["a"].use(Te["a"]);const Me=[{path:"/",name:"Home",component:We}],je=new Te["a"]({mode:"history",base:"/",routes:Me});var Ae=je,He=l("0e44");const Be={headers:[{text:"No",align:"start",value:"id",sortable:!0,editable:!1,headerEditable:!1,fixed:!0},{text:"Description",value:"description",editable:!0,fixed:!0},{text:"Weight",value:"weight",editable:!0},{text:"Step1",value:"step1",sortable:!1,editable:!0,headerEditable:!0,columnDeleteIcon:!1},{text:"Fulfillment",value:"fulfillment",editable:!1}],deliverables:[],steps:[{text:"Step1",identity:"step1"}],responsibles:[],nextColumnName:"Step2",newRowCounter:0},Ue={incrementNewRowCounter(e){e.newRowCounter++},SET_ROW_COUNTER_TO_ZERO(e,t){e.newRowCounter=t},SET_HEADERS(e,t){e.headers=t},SET_TABLE_STATE(e,t){e.deliverables=t},SET_STEPS(e,t){e.steps=t,e.nextStatusColumn="Step"+(e.steps.length+1)},SET_RESPONSIBLES(e,t){e.responsibles=t},SET_NEXT_COLUMN_NAME(e,t){e.nextColumnName=t},LOAD_DELIVERABLES(e,t){e.steps.length>0&&(e.deliverables=t)}},Pe={incrementNewRowCounterAction({commit:e}){e("incrementNewRowCounter")},setRowCounterToZero({commit:e},t){e("SET_ROW_COUNTER_TO_ZERO",t)},setHeaders:({commit:e},t)=>{e("SET_HEADERS",t)},setDeliverables:({commit:e},t)=>{e("SET_TABLE_STATE",t)},setSteps:({commit:e},t)=>{e("SET_STEPS",t)},setResponsibles:({commit:e},t)=>{e("SET_RESPONSIBLES",t)},setNextColumnName:({commit:e,state:t},l)=>{let s="Step";"Status"===l?s="Step"+(t.steps.length+1):"Responsible"===l&&(s=0===t.responsibles.length?"Responsible":"Responsible"+(t.steps.length+1)),e("SET_NEXT_COLUMN_NAME",s)},loadDeliverables:({commit:e},t)=>{e("LOAD_DELIVERABLES",t)}},Ve={getNewRowCounter(e){return e.newRowCounter},getNextColumnName:e=>t=>{let l="Step";return"Status"===t?l="Step"+(e.steps.length+1):"Responsible"===t&&(l=0===e.responsibles.length?"Responsible1":"Responsible"+(e.responsibles.length+1)),l},headers:e=>e.headers,deliverables:e=>e.deliverables,steps:e=>e.steps,responsibles:e=>e.responsibles,stepsFulfillment:e=>{if(!e.steps||0===e.steps.length)return{};let t={};return e.steps.forEach(l=>{if(l){let s=0,i=0,n=0;e.deliverables.forEach(e=>{e&&1==e.isChild?e.children.forEach(e=>{"n.rel."!==e[l.identity]&&(s+=+e.weight),n+="closed"===e[l.identity]?1*e.weight:0,i+="wip"===e[l.identity]?.5*e.weight:0}):("n.rel."!==e[l.identity]&&(s+=+e.weight),n+="closed"===e[l.identity]?1*e.weight:0,i+="wip"===e[l.identity]?.5*e.weight:0)}),t[l.identity]=(n+i)/s*100}}),t},subProjectStepsFullFilment:e=>{if(!e.steps||0===e.steps.length)return{};console.log("sub project steps full");let t={};return e.deliverables.forEach(l=>{l&&l.isGrouped&&(t[l.id]={},e.steps.forEach(e=>{if(e){let s=0,i=0,n=0;l.children.forEach(t=>{"n.rel."!==t[e.identity]&&(s+=+t.weight),n+="closed"===t[e.identity]?1*t.weight:0,i+="wip"===t[e.identity]?.5*t.weight:0}),t[l.id][e.identity]=0===s?0:(n+i)/s*100}}))}),t},totalFulfillment:e=>{if(0===e.steps.length)return;let t=0,l=0;return e.deliverables.forEach(e=>{e&&1==e.isChild?e.children.forEach(e=>{"number"===typeof e.fulfillment&&(l+=+e.weight,t+=e.fulfillment*e.weight)}):"number"===typeof e.fulfillment&&(l+=+e.weight,t+=e.fulfillment*e.weight)}),0===l?0:t/l},nextResponsibleIdentity:e=>0===e.responsibles.length?"responsible1":"responsible"+(e.responsibles.length+1)};var Le={state:Be,mutations:Ue,actions:Pe,getters:Ve};s["a"].use(S["a"]);var qe=new S["a"].Store({state:{},mutations:{},actions:{},modules:{statusTable:Le},plugins:[Object(He["a"])()]}),ze=l("f309");s["a"].use(ze["a"]);var Ge=new ze["a"]({});l("0e46");s["a"].config.productionTip=!1,new s["a"]({router:Ae,store:qe,vuetify:Ge,render:e=>e(_e)}).$mount("#app")}});
//# sourceMappingURL=app.6fce28f6.js.map