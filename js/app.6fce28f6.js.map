{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue","webpack:///./src/components/StatusTable.vue","webpack:///./src/utils/fulfilments-util.js","webpack:///./src/components/ConfirmMessage.vue","webpack:///src/components/ConfirmMessage.vue","webpack:///./src/components/ConfirmMessage.vue?efd5","webpack:///./src/components/ConfirmMessage.vue?9ac9","webpack:///./src/components/Table/LinearProgress.vue","webpack:///src/components/Table/LinearProgress.vue","webpack:///./src/components/Table/LinearProgress.vue?f0be","webpack:///./src/components/Table/LinearProgress.vue?0ac1","webpack:///./src/components/Table/EditDialogTableBody.vue","webpack:///src/components/Table/EditDialogTableBody.vue","webpack:///./src/components/Table/EditDialogTableBody.vue?9315","webpack:///./src/components/Table/EditDialogTableBody.vue?8bd5","webpack:///./src/components/Table/Toolbar.vue","webpack:///./src/utils/excel-operator.js","webpack:///./src/components/AddColumn.vue","webpack:///src/components/AddColumn.vue","webpack:///./src/components/AddColumn.vue?e666","webpack:///./src/components/AddColumn.vue?119d","webpack:///src/components/Table/Toolbar.vue","webpack:///./src/components/Table/Toolbar.vue?80ef","webpack:///./src/components/Table/Toolbar.vue?c856","webpack:///./src/components/Table/EditDialogTableHeader.vue","webpack:///src/components/Table/EditDialogTableHeader.vue","webpack:///./src/components/Table/EditDialogTableHeader.vue?3b6a","webpack:///./src/components/Table/EditDialogTableHeader.vue?d131","webpack:///src/components/StatusTable.vue","webpack:///./src/components/StatusTable.vue?b2cc","webpack:///./src/components/StatusTable.vue?3314","webpack:///src/App.vue","webpack:///./src/App.vue?4c2e","webpack:///./src/App.vue?3746","webpack:///./src/views/Home.vue","webpack:///src/views/Home.vue","webpack:///./src/views/Home.vue?6adb","webpack:///./src/views/Home.vue?86b4","webpack:///./src/router/index.js","webpack:///./src/store/modules/statusTable.js","webpack:///./src/store/index.js","webpack:///./src/plugins/vuetify.js","webpack:///./src/main.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","staticRenderFns","render","attrs","staticClass","_c","ref","sortBy","$event","scopedSlots","headers","staticStyle","header","_vm","thHeight","_v","class","active","sortDesc","headerEditable","transform","rotateValues","on","mouseLeave","editable","item","showEditDialog","click","close1","handleClick","childIdx","index","expandedWidth","style","cellBackgroundStyle","child","_e","toolboxVisible","closetoolbox","expression","top","stopPropagation","deleteColumn","FulfilmentsUtil","constructor","calculateRowFulfillment","row","steps","stepsLength","closedCount","wipCount","nrelCount","forEach","step","identity","fulfillment","effectiveStepsLength","recalculateAllFulfillments","deliverables","this","isGrouped","children","calculateParentFulfillment","totalWeights","sumAll","idx","weight","_self","closePopup","props","methods","answer","$emit","pressedType","component","cancel","changeCell","rules","required","positiveNumbers","change","inputChanged","counter","alreadyExist","emits","close","open","openedCell","headerValue","param","adjustSize","addRow","_u","fn","text","callback","file","$$v","undoDelete","toggleWeight","STATUS_CLOSED","STATUS_WIP","STATUS_OPEN","STATUS_NREL","ExcelOperator","responsibles","stepsFulfillment","totalFulfillment","workbook","ExcelJS","Workbook","workSheet","addWorksheet","calculateFirstRow","tableRows","formTableRows","addFormattingFulfillmentsColumns","addFormattingFirstRow","addStepDropDownAndColor","addfulfillmentFormula","addFirstRowFormula","addChildRowStepsFormula","tableHeaders","filterButton","addTable","headerRow","showRowStripes","columns","rows","buf","xlsx","writeBuffer","saveAs","Blob","emptyRows","stepsStatus","firstRow","console","log","offset","firstColumnLetter","_columns","letter","lastColumnLetter","addConditionalFormatting","type","color","argb","gradient","cfvo","font","columnLetter","addNumberFormatting","addFormattingChildRows","childRowCell","endPosition","weightColumnLetter","statusColumnLetter","statusColumnFirstCell","excludedWeights","childRowCellsCounter","formulaComponents","countChildRows","deliverable","isChild","deliverableLength","nRelCountFormula","getCell","formula","map","join","addFirstRowFormula2","lastColumnIndex","addFirstRowFormula3","firstDataRow","lastDataRow","ChildRowsFormulaComponents","nRelCountFormulaChild","childRowFormula","addDropDownAndColor","targetCell","dataValidation","allowBlank","formulae","addColorFormatting","columnOffset","inc","addfulfillmentFormulaHelper","fulfillmentColumnLetter","fulfillmentCell","cell","numFmt","itemValues","id","description","childValues","parseFloat","operator","fill","pattern","bgColor","laodTable","wb","reader","FileReader","readAsArrayBuffer","Promise","resolve","onload","async","buffer","load","headerValues","sheet","getWorksheet","firstStepColumnNumber","lastStepColumnNumber","firstResponsibleColumnNumber","lastResponsibleColumnNumber","eachRow","rowNumber","rowValues","values","some","loadingObject","start","responsiblesCounter","stepCounter","align","sortable","then","stepOffset","nextColumnName","getNextColumnName","find","toLowerCase","columnType","$store","getters","addColumn","addStatusColumn","addResponsibleColumn","dispatch","stepLength","stepText","stepIdentity","columnDeleteIcon","$set","util","responsiblesLength","responsiblesText","responsibleIdentity","nextResponsibleIdentity","computed","mapState","statusTable","horizontalAdjusted","adjustText","heightScale","widthScale","components","AddColumn","filteredHeaders","filter","showWeight","Math","round","generateExcel","excelOperator","passObject","saveAsExcel","table","document","getElementsByTagName","tableWrapper","getElementsByClassName","width","clientWidth","containerWidth","containerHeight","clientHeight","scrollWidth","scrollHeight","tasksLength","responsible","returnedProps","loadExcel","headerTextFieldOpen","changeHeader","headerText","ConfirmMessage","LinearProgress","EditDialogTableHeader","EditDialogTableBody","Toolbar","selectedRowTop","selectedRows","selectedRow","isRangeSelected","deletedRows","deletedRowsStack","isShiftPressed","isDialogOpen","selectItems","inputValue","max20chars","v","thWidth","tdHeight","headerEditValue","defaultItem","oneWeekBefore","untilDayBefore","showDeleteIcon","message","pressedId","showConformMessage","activeChildIndex","subProjectStepsFullFilment","mounted","$nextTick","$refs","headerRef","rowRef","tableToolbarHeight","maxHeight","watch","dialog","val","ungroupSelectedChildren","childrenToUngroup","rowId","parentIdx","findParentIndex","findChildIndex","sort","a","b","ungroupChild","parent","recalculateNumbering","childId","childIndex","event","target","classList","contains","include","querySelector","renumberDeliverables","renumberedRow","createNewRowFromSelected","newRow","min","totalWeight","parseInt","parentId","updatedDeliverables","includes","calculateStepsFulfillmentForNewRow","insertIndex","findIndex","finalIndex","deleteRows","parentIndex","deletedChild","getNextAvailableId","lastDeletedRows","pop","existingRow","positionToolBox","shiftKey","handleRangeSelection","ctrlKey","isSelected","startIndex","endIndex","_this$deliverables$pa","_this$deliverables$i","itemId","rowHeight","handleSelectChange","currentStepIndex","indexOf","nextStepIndex","undefined","parentRow","getProgressBarStyles","toggleWidth","getTitle","isNaN","status","backgroundColor","getColor","setTimeout","sortColumn","showDelete","unShowDelete","showColumnDelete","unShowColumnDelete","conformMessage","toggleShowConformMessage","deleteRow","stepNumber","lengthOfStep","counter1","y","x","z","e","counter2","f","created","title","StatusTable","drawer","Vue","use","VueRouter","routes","path","Home","router","base","process","state","fixed","newRowCounter","mutations","incrementNewRowCounter","SET_ROW_COUNTER_TO_ZERO","SET_HEADERS","SET_TABLE_STATE","SET_STEPS","nextStatusColumn","SET_RESPONSIBLES","SET_NEXT_COLUMN_NAME","LOAD_DELIVERABLES","loadedArray","actions","incrementNewRowCounterAction","commit","setRowCounterToZero","setHeaders","setDeliverables","setSteps","setResponsibles","setNextColumnName","loadDeliverables","getNewRowCounter","fulfillmentsObj","Vuex","Store","plugins","createPersistedState","Vuetify","config","productionTip","store","vuetify","h","App","$mount"],"mappings":"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","file":"js/app.6fce28f6.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-app',[_c('v-main',[_c('StatusTable')],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"containerRef\",staticClass:\"container-width\"},[_c('v-container',{attrs:{\"fluid\":\"\"}},[_c('v-row',{staticClass:\"text-center\"},[_c('v-col',{staticClass:\"overflow-c\",attrs:{\"cols\":\"12\"}},[_c('div',{ref:\"tableRef\"},[_c('v-data-table',{staticClass:\"elevation-1 zoom custom-data-table\",attrs:{\"headers\":_vm.filteredHeaders,\"items\":_vm.deliverables,\"hide-default-header\":\"\",\"hide-default-footer\":\"\",\"sort-by\":_vm.sortBy,\"disable-pagination\":\"\",\"sort-desc\":_vm.sortDesc},on:{\"update:sortBy\":function($event){_vm.sortBy=$event},\"update:sort-by\":function($event){_vm.sortBy=$event},\"update:sortDesc\":function($event){_vm.sortDesc=$event},\"update:sort-desc\":function($event){_vm.sortDesc=$event}},scopedSlots:_vm._u([{key:\"header\",fn:function({ props: { headers } }){return [_c('thead',{staticClass:\"v-data-table-header\"},[_c('tr',{ref:\"headerRef\"},_vm._l((headers),function(header){return _c('th',{key:header.value,staticStyle:{\"border\":\"solid 0.5px\",\"padding\":\"0px 0px\"}},[_c('span'),(header.value.includes('step'))?_c('span',{staticStyle:{\"height\":\"100%\"}},[_c('linear-progress',{attrs:{\"color\":\"green\",\"height\":_vm.thHeight,\"value\":_vm.stepsFulfillment[header.value]}},[_vm._v(\" \"+_vm._s(_vm.stepsFulfillment[header.value] ? Math.round(_vm.stepsFulfillment[header.value]) : 0)+\"% \")])],1):(header.value === 'fulfillment')?_c('span',[_c('linear-progress',{attrs:{\"value\":_vm.totalFulfillment !== null && !isNaN(_vm.totalFulfillment) ? _vm.totalFulfillment : 0,\"color\":\"green\",\"height\":_vm.thHeight,\"reactive\":\"reactive\",\"striped\":\"striped\"}},[_vm._v(\" \"+_vm._s(_vm.totalFulfillment !== null && !isNaN(_vm.totalFulfillment) ? _vm.totalFulfillment + \"%\" : \"n.rel.\")+\" \")])],1):_c('div',{staticStyle:{\"color\":\"white\"},on:{\"click\":function($event){return _vm.toggleWidth()}}},[_vm._v(\" ' \")])])}),0),_c('tr',{staticClass:\"secondTopRow\"},_vm._l((headers),function(header,idx){return _c('th',{key:idx,staticClass:\"sortable\",class:{\n                      active: _vm.sortBy === header.value,\n                      asc: _vm.sortDesc === false,\n                    },attrs:{\"id\":\"tableHeader\",\"role\":\"columnheader\",\"scope\":\"col\",\"aria-label\":`${header.text}: Sorted ascending. Activate to sort descending.`,\"aria-sort\":\"ascending\"}},[_c('edit-dialog-table-header',{attrs:{\"header\":header},on:{\"handleChangeHeader\":_vm.changeHeader,\"handleInputChange\":_vm.inputChanged,\"handleHeaderTextFileOpend\":_vm.headerTextFieldOpen}}),(header.headerEditable)?_c('span',{attrs:{\"id\":\"deleteIcon\"},on:{\"click\":function($event){return _vm.conformMessage('', idx, 'column')}}},[_c('v-icon',{attrs:{\"small\":\"\"}},[_vm._v(\"mdi-delete\")])],1):_c('span',[_c('span',{on:{\"click\":function($event){return _vm.sortColumn(header.value)}}},[_c('span',[_vm._v(_vm._s(header.text)+\" \")]),_c('span',[_c('i',{staticClass:\"v-icon notranslate v-data-table-header__icon mdi mdi-arrow-up theme--light\",staticStyle:{\"font-size\":\"18px\",\"transition\":\"transform 0.25s linear\"},style:({\n                              transform: `rotate(${_vm.rotateValues[header.value]}deg)`,\n                            }),attrs:{\"aria-hidden\":\"true\"},on:{\"click\":function($event){_vm.rotateValues[header.value] += _vm.rotateValues[header.value] === 0 ? -180 : 180}}})])])])],1)}),0)])]}},{key:\"body\",fn:function({ items, headers }){return [_c('tbody',[_vm._l((items),function(item,idx){return [_c('tr',{ref:\"rowRef\",refInFor:true},_vm._l((headers),function(header,key){return _c('td',{key:`inner_${key}`,class:{ 'expanded-td': _vm.expandedWidth },style:(_vm.cellBackgroundStyle(item[header.value])),attrs:{\"title\":_vm.expandedWidth ? _vm.getTitle(item, header) : ''},on:{\"mouseover\":function($event){item.showEditDialog = true},\"mouseleave\":function($event){return _vm.mouseLeave(item)}}},[(header.editable)?_c('span',{class:{\n                          'left-justified':\n                            header.value === 'description' || header.value.includes('responsible'),\n                        }},[(!item.showEditDialog && !item.isChild)?_c('span',[_vm._v(\" \"+_vm._s(item[header.value])+\" \")]):_c('span',[(header.value.includes('step'))?[(item.isChild)?_c('span',[_vm._v(\" \"+_vm._s(_vm.subProjectStepsFullFilment[item.id] ? parseInt(Math.round(_vm.subProjectStepsFullFilment[item.id][header.value])) : 0)+\"% \")]):_c('span',{staticStyle:{\"cursor\":\"pointer\"},on:{\"click\":function($event){return _vm.handleSelectChange(item, header.value)}}},[_vm._v(\" \"+_vm._s(item[header.value])+\" \")])]:[_c('edit-dialog-table-body',{attrs:{\"item\":item,\"header\":header},on:{\"handleChangeCell\":_vm.changeCell,\"handleClose1\":_vm.close1,\"handleInputChanged\":_vm.inputChanged,\"handleOpen\":_vm.open}})]],2)]):_c('span',[(header.value === 'fulfillment')?_c('span',[_c('linear-progress',{attrs:{\"value\":typeof item[header.value] === 'number' ? item[header.value] : 0,\"color\":\"green\",\"height\":_vm.tdHeight,\"reactive\":\"reactive\",\"striped\":\"striped\"}},[_vm._v(\" \"+_vm._s(typeof item[header.value] === \"number\" ? Math.round(item[header.value]) + \"%\" : \"n.rel.\")+\" \")])],1):_c('div',{class:{\n                            'deliverable--number': header.value === 'id',\n                            'selected-row': _vm.isSelected(item.id),\n                          },on:{\"click\":function($event){return _vm.handleClick($event, idx, item.id)}}},[_vm._v(\" \"+_vm._s(item[header.value])+\" \")])])])}),0),(item.children && item.children.length > 0)?_vm._l((item.children),function(child,childIdx){return _c('tr',{key:`child_${idx}_${childIdx}`},_vm._l((headers),function(header,index){return _c('td',{key:`inner_child_${index}`,class:{ 'expanded-td': _vm.expandedWidth },style:(_vm.cellBackgroundStyle(child[header.value])),attrs:{\"title\":_vm.expandedWidth ? _vm.getTitle(child, header) : ''},on:{\"mouseover\":function($event){child.showEditDialog = true},\"mouseleave\":function($event){return _vm.mouseLeave(child)}}},[(header.editable)?_c('span',{class:{\n                            'left-justified':\n                              header.value === 'description' || header.value.includes('responsible'),\n                          }},[(!child.showEditDialog)?_c('span',[_vm._v(_vm._s(child[header.value]))]):_c('span',[(header.value.includes('step'))?[_c('span',{staticStyle:{\"cursor\":\"pointer\"},on:{\"click\":function($event){return _vm.handleSelectChange(child, header.value)}}},[_vm._v(\" \"+_vm._s(child[header.value])+\" \")])]:[_c('edit-dialog-table-body',{attrs:{\"item\":child,\"header\":header},on:{\"handleChangeCell\":_vm.changeCell,\"handleClose1\":_vm.close1,\"handleInputChanged\":_vm.inputChanged,\"handleOpen\":_vm.open}})]],2)]):_c('span',[(header.value === 'fulfillment')?_c('span',[_c('linear-progress',{attrs:{\"value\":typeof child[header.value] === 'number' ? child[header.value] : 0,\"color\":\"green\",\"height\":_vm.tdHeight,\"reactive\":\"reactive\",\"striped\":\"striped\"}},[_vm._v(\" \"+_vm._s(typeof child[header.value] === \"number\" ? Math.round(child[header.value]) + \"%\" : \"n.rel.\")+\" \")])],1):_c('div',{class:{\n                              'deliverable--number': header.value == 'id',\n                              'selected-row': _vm.isSelected(child.id),\n                            },staticStyle:{\"cursor\":\"pointer\"},on:{\"click\":function($event){return _vm.handleClick($event, childIdx, child.id, idx)}}},[_vm._v(\" \"+_vm._s(child[header.value])+\" \")])])])}),0)}):_vm._e()]}),(_vm.toolboxVisible)?_c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.closetoolbox),expression:\"closetoolbox\"}],staticClass:\"toolbox\",style:({ top: _vm.selectedRowTop + 'px' })},[_c('v-icon',{attrs:{\"small\":\"\"},on:{\"click\":_vm.deleteRows}},[_vm._v(\"mdi-delete\")]),_c('v-icon',{attrs:{\"small\":\"\"},on:{\"click\":_vm.createNewRowFromSelected}},[_vm._v(\"mdi-arrow-right\")]),_c('v-icon',{attrs:{\"small\":\"\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.ungroupSelectedChildren.apply(null, arguments)}}},[_vm._v(\"mdi-arrow-left\")])],1):_vm._e()],2)]}},{key:\"top\",fn:function(){return [_c('toolbar',{attrs:{\"showWeight\":_vm.showWeight},on:{\"handleShowWeight\":_vm.toggleWeight,\"handleUndelete\":_vm.undoDelete}})]},proxy:true}])})],1)])],1)],1),(_vm.showConformMessage)?_c('div',[_c('ConfirmMessage',{attrs:{\"message\":_vm.message,\"pressedType\":_vm.pressedType},on:{\"deleteRow\":_vm.deleteRow,\"deleteStep\":function($event){return _vm.deleteColumn('step')},\"deleteResponsible\":function($event){return _vm.deleteColumn('responsible')},\"dontDelete\":_vm.toggleShowConformMessage}})],1):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default class FulfilmentsUtil {\r\n  constructor() { }\r\n\r\n  calculateRowFulfillment(row, steps) {\r\n    let stepsLength = steps.length;\r\n    let closedCount = 0;\r\n    let wipCount = 0;\r\n    let nrelCount = 0;\r\n\r\n    steps.forEach(step => {\r\n      closedCount += row[step.identity] === \"closed\" ? 1 : 0;\r\n      wipCount += row[step.identity] === \"wip\" ? 0.5 : 0;\r\n      nrelCount += row[step.identity] === \"n.rel.\" ? 1 : 0;\r\n    });\r\n\r\n    let effectiveStepsLength = stepsLength - nrelCount;\r\n    let fulfillment;\r\n\r\n    if (nrelCount === stepsLength) {\r\n      // If all statuses are \"n.rel.\", set fulfillment to \"n.rel.\"\r\n      fulfillment = \"n.rel.\";\r\n    } else {\r\n      // Calculate fulfillment normally\r\n      fulfillment = ((closedCount + wipCount) / effectiveStepsLength) * 100;\r\n    }\r\n\r\n    row.fulfillment = fulfillment;\r\n  }\r\n\r\n  recalculateAllFulfillments(deliverables, steps) {\r\n    // Recalculate for all rows\r\n    deliverables.forEach(item => {\r\n      this.calculateRowFulfillment(item, steps);\r\n      if (item.isGrouped) {\r\n        item.children.forEach((child) => {\r\n          this.calculateRowFulfillment(child, steps);\r\n        });\r\n\r\n        // Aggregate children's fulfillment for the parent item\r\n        this.calculateParentFulfillment(item, steps);\r\n      }\r\n    });\r\n  }\r\n\r\n  calculateParentFulfillment(row, steps) {\r\n    // let totalFulfillment = 0;\r\n    // let childCount = parent.children.length;\r\n\r\n    // parent.children.forEach(child => {\r\n    //   if (child.fulfillment !== \"n.rel.\") {\r\n    //     totalFulfillment += child.fulfillment;\r\n    //   }\r\n    // });\r\n\r\n    // // If all children are \"n.rel.\", the parent should also be \"n.rel.\"\r\n    // if (childCount > 0 && totalFulfillment === 0) {\r\n    //   parent.fulfillment = \"n.rel.\";\r\n    // } else {\r\n    //   parent.fulfillment = totalFulfillment / childCount;\r\n    // }\r\n    if (steps.length > 0) {\r\n      let totalWeights = 0;\r\n      let sumAll = 0;\r\n\r\n      row.children.forEach((item, idx) => {\r\n        // const selectedRow = this.deliverables[idx];\r\n        if (typeof item.fulfillment === \"number\") {\r\n          totalWeights += +item.weight;\r\n          sumAll += item.fulfillment * item.weight;\r\n        }\r\n      });\r\n      row.fulfillment = sumAll / totalWeights;\r\n    }\r\n  }\r\n}","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"backdrop\",on:{\"click\":function($event){if($event.target !== $event.currentTarget)return null;return _vm.closePopup('cancel')}}},[_c('div',{staticClass:\"popup\"},[_c('h3',[_vm._v(_vm._s(_vm.message))]),_c('v-btn',{attrs:{\"color\":\"red darken-1\",\"text\":\"\"},on:{\"click\":function($event){return _vm.closePopup('cancel')}}},[_vm._v(\"Cancel\")]),_c('v-btn',{attrs:{\"color\":\"green darken-1\",\"text\":\"\"},on:{\"click\":function($event){return _vm.closePopup('yes')}}},[_vm._v(\"Yes\")])],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"backdrop\" @click.self=\"closePopup('cancel')\">\r\n    <div class=\"popup\">\r\n      <h3>{{ message }}</h3>\r\n      <v-btn color=\"red darken-1\" text @click=\"closePopup('cancel')\"\r\n        >Cancel</v-btn\r\n      >\r\n      <v-btn color=\"green darken-1\" text @click=\"closePopup('yes')\">Yes</v-btn>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: [\"message\", \"pressedType\"],\r\n  methods: {\r\n    closePopup(answer) {\r\n      if (answer === \"cancel\") {\r\n        this.$emit(\"dontDelete\");\r\n      } else if (answer === \"yes\") {\r\n        if (this.pressedType === \"Row\") {\r\n          this.$emit(\"deleteRow\");\r\n        } else if (this.pressedType === \"step\") {\r\n          this.$emit(\"deleteStep\");\r\n        } else if (this.pressedType === \"responsible\") {\r\n          this.$emit(\"deleteResponsible\");\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConfirmMessage.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ConfirmMessage.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ConfirmMessage.vue?vue&type=template&id=ac86f076\"\nimport script from \"./ConfirmMessage.vue?vue&type=script&lang=js\"\nexport * from \"./ConfirmMessage.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-progress-linear',{attrs:{\"value\":_vm.value,\"color\":_vm.color,\"height\":_vm.height,\"reactive\":\"\",\"striped\":\"\"}},[_vm._t(\"default\")],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-progress-linear :value=\"value\" :color=\"color\" :height=\"height\" reactive striped>\r\n    <slot></slot>\r\n  </v-progress-linear>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: [\"value\", \"color\", \"height\", \"reactive\",\"striped\"],\r\n};\r\n</script>\r\n\r\n<style></style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinearProgress.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LinearProgress.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./LinearProgress.vue?vue&type=template&id=60e267a2\"\nimport script from \"./LinearProgress.vue?vue&type=script&lang=js\"\nexport * from \"./LinearProgress.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-edit-dialog',{on:{\"close\":function($event){return _vm.close1(_vm.item)},\"cancel\":_vm.cancel,\"open\":function($event){return _vm.open(_vm.item[_vm.header.value])},\"save\":function($event){return _vm.changeCell(_vm.item, _vm.header.value)}},scopedSlots:_vm._u([{key:\"input\",fn:function(){return [_c('span',[(_vm.header.text === 'Weight')?_c('v-text-field',{attrs:{\"type\":\"number\",\"rules\":[_vm.rules.required, _vm.rules.positiveNumbers],\"value\":_vm.item[_vm.header.value],\"label\":\"Edit\",\"single-line\":\"\"},on:{\"focus\":function($event){return $event.target.select()},\"change\":function($event){return _vm.inputChanged($event, 'weight')}}}):_c('v-text-field',{attrs:{\"value\":_vm.item[_vm.header.value],\"label\":\"Edit\",\"single-line\":\"\"},on:{\"focus\":function($event){return $event.target.select()},\"change\":function($event){return _vm.inputChanged($event)}}})],1)]},proxy:true}])},[_vm._v(\" \"+_vm._s(_vm.item[_vm.header.value])+\" \")])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-edit-dialog\r\n    @close=\"close1(item)\"\r\n    @cancel=\"cancel\"\r\n    @open=\"open(item[header.value])\"\r\n    @save=\"changeCell(item, header.value)\"\r\n  >\r\n    {{ item[header.value] }}\r\n    <template v-slot:input>\r\n      <span>\r\n        <v-text-field\r\n          type=\"number\"\r\n          :rules=\"[rules.required, rules.positiveNumbers]\"\r\n          v-if=\"header.text === 'Weight'\"\r\n          @focus=\"$event.target.select()\"\r\n          :value=\"item[header.value]\"\r\n          @change=\"inputChanged($event, 'weight')\"\r\n          label=\"Edit\"\r\n          single-line\r\n        ></v-text-field>\r\n        <v-text-field\r\n          v-else\r\n          @focus=\"$event.target.select()\"\r\n          :value=\"item[header.value]\"\r\n          @change=\"inputChanged($event)\"\r\n          label=\"Edit\"\r\n          single-line\r\n        ></v-text-field>\r\n      </span>\r\n    </template>\r\n  </v-edit-dialog>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: [\"header\", \"item\"],\r\n  data: () => ({\r\n    rules: {\r\n      counter: (value) => value.length <= 20 || \"Max 20 characters\",\r\n      required: (value) => !!value || \"Required.\",\r\n      positiveNumbers: (value) => value > 0 || \"Should be greater than 0\",\r\n      alreadyExist: true,\r\n    },\r\n  }),\r\n  emits: [\"handleClose1\", \"handleOpen\", \"handleChangeCell\", \"handleInputChanged\"],\r\n  methods: {\r\n    close() {},\r\n    cancel() {},\r\n    close1(item) {\r\n      this.$emit(\"handleClose1\", item);\r\n    },\r\n    open(openedCell) {\r\n      this.$emit(\"handleOpen\", openedCell);\r\n    },\r\n    changeCell(item, headerValue) {\r\n      this.$emit(\"handleChangeCell\", item, headerValue);\r\n    },\r\n    inputChanged(value, param) {\r\n      this.$emit(\"handleInputChanged\", value, param);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style></style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditDialogTableBody.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditDialogTableBody.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./EditDialogTableBody.vue?vue&type=template&id=7ecb3c3a\"\nimport script from \"./EditDialogTableBody.vue?vue&type=script&lang=js\"\nexport * from \"./EditDialogTableBody.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-toolbar',{staticClass:\"mb-0 mt-0\",attrs:{\"height\":\"32\",\"flat\":\"\",\"color\":\"white\"}},[_c('v-toolbar-title',[_vm._v(\"Tasks\")]),_c('v-divider',{staticClass:\"mx-4\",attrs:{\"inset\":\"\",\"vertical\":\"\"}}),_c('v-btn',{staticClass:\"mb-2\",attrs:{\"x-small\":\"\",\"color\":\"primary\",\"dark\":\"\"},on:{\"click\":_vm.generateExcel}},[_vm._v(\"Generate Excel\")]),_c('v-btn',{staticClass:\"mb-2 ml-2\",attrs:{\"x-small\":\"\",\"color\":\"primary\",\"dark\":\"\"},on:{\"click\":_vm.adjustSize}},[_vm._v(_vm._s(_vm.adjustText))]),_c('v-btn',{staticClass:\"mb-2 ml-2\",attrs:{\"x-small\":\"\",\"color\":\"primary\",\"dark\":\"\"},on:{\"click\":_vm.addRow}},[_vm._v(\"Add Row\")]),_c('v-divider',{staticClass:\"mx-4\",attrs:{\"inset\":\"\",\"vertical\":\"\"}}),_c('v-file-input',{attrs:{\"dense\":\"\",\"placeholder\":\"Load excel file\",\"label\":\"File input\",\"prepend-icon\":\"mdi-paperclip\",\"show-size\":\"\"},on:{\"change\":_vm.loadExcel},scopedSlots:_vm._u([{key:\"selection\",fn:function({ text }){return [_c('v-chip',{attrs:{\"small\":\"\",\"label\":\"\",\"color\":\"primary\"}},[_vm._v(_vm._s(text))])]}}]),model:{value:(_vm.file),callback:function ($$v) {_vm.file=$$v},expression:\"file\"}}),_c('v-divider',{staticClass:\"mx-4\",attrs:{\"inset\":\"\",\"vertical\":\"\"}}),_c('v-spacer'),_c('v-btn',{staticClass:\"mr-2 mb-2\",attrs:{\"x-small\":\"\",\"color\":\"primary\",\"dark\":\"\"},on:{\"click\":_vm.undoDelete}},[_vm._v(\" UNDELETE \")]),_c('v-btn',{staticClass:\"mb-2\",attrs:{\"x-small\":\"\",\"color\":\"primary\",\"dark\":\"\"},on:{\"click\":_vm.toggleWeight}},[_vm._v(_vm._s(_vm.showWeight))]),_c('AddColumn')],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import ExcelJS from \"exceljs\";\r\nimport { saveAs } from \"file-saver\";\r\n\r\n//TODO check fulfilments decimal points consistency between excel and browser\r\n\r\n// Define constants\r\nconst STATUS_CLOSED = \"closed\";\r\nconst STATUS_WIP = \"wip\";\r\nconst STATUS_OPEN = \"open\";\r\nconst STATUS_NREL = \"n.rel.\";\r\n\r\nexport default class ExcelOperator {\r\n  constructor(\r\n    deliverables,\r\n    steps,\r\n    responsibles,\r\n    stepsFulfillment,\r\n    totalFulfillment\r\n  ) {\r\n    this.deliverables = deliverables;\r\n    this.steps = steps;\r\n    this.responsibles = responsibles;\r\n    this.stepsFulfillment = stepsFulfillment;\r\n    this.totalFulfillment = totalFulfillment;\r\n  }\r\n\r\n  async saveAsExcel(props) {\r\n    // console.log('rows and nested rows ',props.deliverables);\r\n    const workbook = new ExcelJS.Workbook();\r\n    const workSheet = workbook.addWorksheet(\"TestSheet\");\r\n    this.calculateFirstRow(\r\n      workSheet,\r\n      props.steps,\r\n      props.responsibles,\r\n      props.stepsFulfillment,\r\n      props.totalFulfillment\r\n    );\r\n\r\n    const tableRows = this.formTableRows(workSheet, props);\r\n    this.addFormattingFulfillmentsColumns(workSheet, props, tableRows);\r\n    this.addFormattingFirstRow(workSheet, props);\r\n    this.addStepDropDownAndColor(workSheet, props, tableRows);\r\n    this.addfulfillmentFormula(workSheet, props);\r\n    this.addFirstRowFormula(workSheet, props, tableRows);\r\n    this.addChildRowStepsFormula(workSheet, props);\r\n\r\n    const tableHeaders = [];\r\n    props.headers.forEach((header) => {\r\n      tableHeaders.push({\r\n        name: header.text,\r\n        filterButton: true,\r\n      });\r\n    });\r\n\r\n    workSheet.addTable({\r\n      name: \"MyTable\",\r\n      ref: \"A2\",\r\n      headerRow: true,\r\n      style: {\r\n        showRowStripes: true,\r\n      },\r\n      columns: tableHeaders,\r\n      rows: tableRows,\r\n    });\r\n\r\n    const buf = await workbook.xlsx.writeBuffer();\r\n\r\n    saveAs(new Blob([buf]), \"Tasks.xlsx\");\r\n  }\r\n\r\n  calculateFirstRow(\r\n    workSheet,\r\n    steps,\r\n    responsibles,\r\n    stepsFulfillment,\r\n    totalFulfillment\r\n  ) {\r\n    const emptyRows = [];\r\n    for (let index = 0; index < responsibles.length; index++) {\r\n      emptyRows.push(\"\");\r\n    }\r\n\r\n    const stepsStatus = [];\r\n    steps.forEach((step) => {\r\n      stepsStatus.push(stepsFulfillment[step.identity] / 100);\r\n    });\r\n\r\n    const firstRow = [\r\n      \"\",\r\n      \"\",\r\n      \"\",\r\n      ...emptyRows,\r\n      ...stepsStatus,\r\n      totalFulfillment / 100,\r\n    ];\r\n\r\n    const secRow = [\"\", \"\", \"\", \"\", \"\", \"\", \"\"];\r\n    console.log(\"first row\", firstRow);\r\n    workSheet.addRow(firstRow);\r\n  }\r\n\r\n  addFormattingFirstRow(workSheet, props) {\r\n    let offset = 3 + props.responsibles.length;\r\n    let firstColumnLetter = workSheet._columns[offset].letter;\r\n    let lastColumnLetter =\r\n      workSheet._columns[offset + props.steps.length].letter;\r\n\r\n    //Add data bar formatting\r\n    workSheet.addConditionalFormatting({\r\n      ref: `${firstColumnLetter}1:${lastColumnLetter}1`,\r\n      rules: [\r\n        {\r\n          type: \"dataBar\",\r\n          color: { argb: \"C6EFCE\" },\r\n          gradient: false,\r\n          cfvo: [\r\n            { type: \"num\", value: 0 },\r\n            { type: \"num\", value: 1 },\r\n          ],\r\n          style: {\r\n            font: { color: { argb: \"006100\" } },\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    //Add number formatting\r\n    for (let index = offset; index <= offset + props.steps.length; index++) {\r\n      let columnLetter = workSheet._columns[index].letter;\r\n      this.addNumberFormatting(workSheet, columnLetter + \"1\");\r\n    }\r\n  }\r\n\r\n  addFormattingChildRows(workSheet, childRowCell) {\r\n    // let offset = 3 + props.responsibles.length;\r\n\r\n    //Add data bar formatting\r\n    workSheet.addConditionalFormatting({\r\n      ref: `${childRowCell}`,\r\n      rules: [\r\n        {\r\n          type: \"dataBar\",\r\n          color: { argb: \"C6EFCE\" },\r\n          gradient: false,\r\n          cfvo: [\r\n            { type: \"num\", value: 0 },\r\n            { type: \"num\", value: 1 },\r\n          ],\r\n          style: {\r\n            font: { color: { argb: \"006100\" } },\r\n          },\r\n        },\r\n      ],\r\n    });\r\n    //Add number formatting\r\n    this.addNumberFormatting(workSheet, childRowCell);\r\n  }\r\n\r\n  addFirstRowFormula(workSheet, props, tableRows) {\r\n    const offset = 3 + props.responsibles.length;\r\n    const endPosition = offset + props.steps.length;\r\n    const weightColumnLetter = workSheet._columns[2].letter; // Assuming weight column is column C\r\n\r\n    for (let index = offset; index <= endPosition; index++) {\r\n      const statusColumnLetter = workSheet._columns[index].letter;\r\n      const statusColumnFirstCell = statusColumnLetter + \"1\";\r\n      let excludedWeights = [];\r\n      let childRowCellsCounter = 3;\r\n      let formulaComponents = [];\r\n      let countChildRows = 0;\r\n\r\n      for (let i = 1; i <= props.deliverables.length; i++) {\r\n        let deliverable = props.deliverables[i - 1];\r\n\r\n        if (deliverable && deliverable.isChild == true) {\r\n          let deliverableLength = deliverable.children.length;\r\n          console.log(\"run child parts\");\r\n          countChildRows += 1;\r\n          // if (!excludedWeights.includes(`${weightColumnLetter}${childRowCellsCounter}`)) {\r\n          excludedWeights.push(`${weightColumnLetter}${childRowCellsCounter}`);\r\n          // }\r\n\r\n          // console.log('got true')\r\n          for (let j = 1; j <= deliverableLength; j++) {\r\n            formulaComponents.push(`(\r\n              IF(ISNUMBER(${statusColumnLetter}${childRowCellsCounter +\r\n              j}), ${statusColumnLetter}${childRowCellsCounter + j}, \r\n                IF(${statusColumnLetter}${childRowCellsCounter +\r\n              j}=\"${STATUS_CLOSED}\", 1, \r\n                  IF(${statusColumnLetter}${childRowCellsCounter +\r\n              j}=\"${STATUS_WIP}\", 0.5, \r\n                    IF(${statusColumnLetter}${childRowCellsCounter +\r\n              j}=\"${STATUS_OPEN}\", 0, \r\n                      IF(${statusColumnLetter}${childRowCellsCounter +\r\n              j}=\"${STATUS_NREL}\", 0, 0)\r\n                    )\r\n                  )\r\n                )\r\n              ) * ${weightColumnLetter}${childRowCellsCounter + j}\r\n            )`);\r\n          }\r\n\r\n          // console.log('child row counter ', childRowCellsCounter);\r\n          childRowCellsCounter += deliverableLength + 1;\r\n          // console.log('child row counter ', childRowCellsCounter);\r\n        } else {\r\n          formulaComponents.push(`(\r\n            IF(ISNUMBER(${statusColumnLetter}${childRowCellsCounter}), ${statusColumnLetter}${childRowCellsCounter}, \r\n              IF(${statusColumnLetter}${childRowCellsCounter}=\"${STATUS_CLOSED}\", 1, \r\n                IF(${statusColumnLetter}${childRowCellsCounter}=\"${STATUS_WIP}\", 0.5, \r\n                  IF(${statusColumnLetter}${childRowCellsCounter}=\"${STATUS_OPEN}\", 0, \r\n                    IF(${statusColumnLetter}${childRowCellsCounter}=\"${STATUS_NREL}\", 0, 0)\r\n                  )\r\n                )\r\n              )\r\n            ) * ${weightColumnLetter}${childRowCellsCounter}\r\n          )`);\r\n          childRowCellsCounter += 1;\r\n        }\r\n\r\n        // Count the occurrences of \"n.rel.\" in the status column\r\n        const nRelCountFormula = `COUNTIF(${statusColumnLetter}${3}:${statusColumnLetter}${2 +\r\n          tableRows.length}, \"n.rel.\")`;\r\n        workSheet.getCell(statusColumnFirstCell).value = {\r\n          formula: nRelCountFormula,\r\n        };\r\n\r\n        // Create the formula for excluded weights\r\n        const excludedWeightsFormula = excludedWeights.map(\r\n          (weight) => `IF(${weight} > 0, ${weight}, 0)`\r\n        );\r\n        console.log(\"excludes weights cells\", excludedWeights);\r\n        // Create the formula that considers the \"n.rel.\" condition\r\n        let formula = `=IF(${nRelCountFormula} = ${tableRows.length -\r\n          countChildRows}, \"n.rel.\", \r\n              IFERROR(SUM(${formulaComponents.join(\", \")}), \"\") / \r\n                (SUM(${weightColumnLetter}${3}:${weightColumnLetter}${2 +\r\n          tableRows.length}) - \r\n                SUMIF(${statusColumnLetter}${3}:${statusColumnLetter}${2 +\r\n          tableRows.length},\r\n                  \"n.rel.\", ${weightColumnLetter}${3}:${weightColumnLetter}${2 +\r\n          tableRows.length}) \r\n                      - SUM(${excludedWeights.length > 0 ? excludedWeights : 0})\r\n                  ))`;\r\n        workSheet.getCell(statusColumnFirstCell).value = {\r\n          formula: formula,\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  addFirstRowFormula2(workSheet, props, tableRows) {\r\n    const offset = 3 + props.responsibles.length;\r\n    const endPosition = offset + props.steps.length;\r\n    const weightColumnLetter = workSheet._columns[2].letter; // Assuming weight column is column C\r\n    const lastColumnIndex = props.deliverables.length + 2;\r\n    console.log(\"delver leng\", props.deliverables);\r\n\r\n    for (let index = offset; index <= endPosition; index++) {\r\n      const statusColumnLetter = workSheet._columns[index].letter;\r\n      const statusColumnFirstCell = statusColumnLetter + \"1\";\r\n      let childRowCellsCounter = 3;\r\n      let weightColumnValue = workSheet.getCell(\r\n        weightColumnLetter + childRowCellsCounter\r\n      ).value;\r\n\r\n      let formula = `=IFERROR((COUNTIF(${statusColumnLetter}${childRowCellsCounter}:${statusColumnLetter}${lastColumnIndex},\"${STATUS_CLOSED}\") \r\n          +COUNTIF(${statusColumnLetter}${childRowCellsCounter}:${statusColumnLetter}${lastColumnIndex},\"${STATUS_WIP}\")* 0.5) / \r\n          (COUNTIF(${statusColumnLetter}${childRowCellsCounter}:${statusColumnLetter}${lastColumnIndex},\"${STATUS_OPEN}\") \r\n          +COUNTIF(${statusColumnLetter}${childRowCellsCounter}:${statusColumnLetter}${lastColumnIndex},\"${STATUS_WIP}\") \r\n          +COUNTIF(${statusColumnLetter}${childRowCellsCounter}:${statusColumnLetter}${lastColumnIndex},\"${STATUS_CLOSED}\")) ,\"${STATUS_NREL}\")`;\r\n\r\n      workSheet.getCell(statusColumnFirstCell).value = {\r\n        formula: formula,\r\n      };\r\n    }\r\n  }\r\n\r\n  addFirstRowFormula3(workSheet, props, tableRows) {\r\n    const offset = 3 + props.responsibles.length;\r\n    const endPosition = offset + props.steps.length;\r\n    const weightColumnLetter = workSheet._columns[2].letter; // Assuming weight column is column C\r\n    const lastColumnIndex = props.deliverables.length + 2;\r\n\r\n    for (let index = offset; index <= endPosition; index++) {\r\n      const statusColumnLetter = workSheet._columns[index].letter;\r\n      const statusColumnFirstCell = statusColumnLetter + \"1\";\r\n      const firstDataRow = 3; // Starting row for data\r\n      const lastDataRow = firstDataRow + tableRows.length - 1;\r\n\r\n      // Calculate the SUMPRODUCT and SUM with conditions to ignore STATUS_NREL\r\n      const formula = `=IFERROR(\r\n        SUMPRODUCT(\r\n          (((${statusColumnLetter}${firstDataRow}:${statusColumnLetter}${lastDataRow} = \"${STATUS_CLOSED}\") +\r\n            (${statusColumnLetter}${firstDataRow}:${statusColumnLetter}${lastDataRow} = \"${STATUS_WIP}\") * 0.5) *\r\n            (${weightColumnLetter}${firstDataRow}:${weightColumnLetter}${lastDataRow})) *\r\n            ((${statusColumnLetter}${firstDataRow}:${statusColumnLetter}${lastDataRow} <> \"${STATUS_NREL}\") * 1)\r\n        ) /\r\n        SUMIFS(\r\n          ${weightColumnLetter}${firstDataRow}:${weightColumnLetter}${lastDataRow},\r\n          ${statusColumnLetter}${firstDataRow}:${statusColumnLetter}${lastDataRow},\r\n          \"<> ${STATUS_NREL}\"\r\n        ),\r\n        \"${STATUS_NREL}\"\r\n      )`;\r\n\r\n      workSheet.getCell(statusColumnFirstCell).value = {\r\n        formula: formula,\r\n      };\r\n    }\r\n  }\r\n\r\n  addChildRowStepsFormula(workSheet, props) {\r\n    const offset = 3 + props.responsibles.length;\r\n    const endPosition = offset + props.steps.length;\r\n    const weightColumnLetter = workSheet._columns[2].letter; // Assuming weight column is column C\r\n\r\n    for (let index = offset; index <= endPosition; index++) {\r\n      const statusColumnLetter = workSheet._columns[index].letter;\r\n      let childRowCellsCounter = 3;\r\n\r\n      for (let i = 1; i <= props.deliverables.length; i++) {\r\n        let deliverable = props.deliverables[i - 1];\r\n        const ChildRowsFormulaComponents = [];\r\n        let deliverableLength;\r\n        const childRowCell = statusColumnLetter + `${childRowCellsCounter}`;\r\n\r\n        if (deliverable && deliverable.isChild == true) {\r\n          this.addFormattingChildRows(workSheet, childRowCell);\r\n\r\n          deliverableLength = deliverable.children.length;\r\n\r\n          for (let j = 1; j <= deliverableLength; j++) {\r\n            ChildRowsFormulaComponents.push(`(\r\n              IF(ISNUMBER(${statusColumnLetter}${childRowCellsCounter +\r\n              j}), ${statusColumnLetter}${childRowCellsCounter + j}, \r\n                IF(${statusColumnLetter}${childRowCellsCounter +\r\n              j}=\"${STATUS_CLOSED}\", 1, \r\n                  IF(${statusColumnLetter}${childRowCellsCounter +\r\n              j}=\"${STATUS_WIP}\", 0.5, \r\n                    IF(${statusColumnLetter}${childRowCellsCounter +\r\n              j}=\"${STATUS_OPEN}\", 0, \r\n                      IF(${statusColumnLetter}${childRowCellsCounter +\r\n              j}=\"${STATUS_NREL}\", 0, 0)\r\n                    )\r\n                  ) \r\n                )\r\n              ) * ${weightColumnLetter}${childRowCellsCounter + j}\r\n            )`);\r\n          }\r\n          // Count the occurrences of \"n.rel.\" in the status column\r\n          let nRelCountFormulaChild = `COUNTIF(${statusColumnLetter}${childRowCellsCounter +\r\n            1}:${statusColumnLetter}${childRowCellsCounter +\r\n            deliverableLength}, \"n.rel.\")`;\r\n          // workSheet.getCell(childRowCell).value = {\r\n          //   formula: nRelCountFormulaChild\r\n          // };\r\n\r\n          // Create the formula that considers the \"n.rel.\" condition\r\n          let childRowFormula = `=IF(${nRelCountFormulaChild} = ${deliverableLength}, \"n.rel.\", \r\n            IFERROR(SUM(${ChildRowsFormulaComponents.join(\", \")}), \"\") / \r\n              (SUM(${weightColumnLetter}${childRowCellsCounter +\r\n            1}:${weightColumnLetter}${childRowCellsCounter +\r\n            deliverableLength}) - \r\n              SUMIF(${statusColumnLetter}${childRowCellsCounter +\r\n            1}:${statusColumnLetter}${childRowCellsCounter + deliverableLength},\r\n                \"n.rel.\", ${weightColumnLetter}${childRowCellsCounter +\r\n            1}:${weightColumnLetter}${childRowCellsCounter + deliverableLength})))`;\r\n\r\n          // console.log('child row cell', childRowFormula);\r\n          workSheet.getCell(childRowCell).value = {\r\n            formula: childRowFormula,\r\n          };\r\n\r\n          console.log(\r\n            `child row cell formula and the cell is ${childRowCell}`,\r\n            workSheet.getCell(childRowCell).value\r\n          );\r\n          childRowCellsCounter += deliverableLength;\r\n        }\r\n        childRowCellsCounter++;\r\n      }\r\n    }\r\n  }\r\n\r\n  addDropDownAndColor(workSheet, targetCell) {\r\n    workSheet.getCell(targetCell).dataValidation = {\r\n      type: \"list\",\r\n      allowBlank: true,\r\n      formulae: [\r\n        `\"${STATUS_OPEN},${STATUS_WIP},${STATUS_CLOSED},${STATUS_NREL}\"`,\r\n      ],\r\n    };\r\n    this.addColorFormatting(workSheet, targetCell);\r\n  }\r\n\r\n  addStepDropDownAndColor(workSheet, props, tableRows) {\r\n    // console.log('deliverables inside the addStepDropdown and color', props.deliverables);\r\n\r\n    let columnOffset = 3 + props.responsibles.length;\r\n    let endPosition = columnOffset + props.steps.length - 1;\r\n\r\n    for (let index = columnOffset; index <= endPosition; index++) {\r\n      let inc = 3;\r\n\r\n      let columnLetter = workSheet._columns[index].letter;\r\n\r\n      for (let i = 1; i <= props.deliverables.length; i++) {\r\n        let targetCell;\r\n        let deliverable = props.deliverables[i - 1];\r\n\r\n        if (deliverable && deliverable.isChild == true) {\r\n          inc += 1;\r\n          for (let j = 1; j < deliverable.children.length; j++) {\r\n            targetCell = `${columnLetter}${inc}`;\r\n            this.addDropDownAndColor(workSheet, targetCell);\r\n            inc += 1;\r\n            // console.log('inc value', inc)\r\n          }\r\n        }\r\n        targetCell = `${columnLetter}${inc}`;\r\n        this.addDropDownAndColor(workSheet, targetCell);\r\n        inc += 1;\r\n      }\r\n    }\r\n  }\r\n\r\n  addFormattingFulfillmentsColumns(workSheet, props, tableRows) {\r\n    let offset = 3 + props.responsibles.length + props.steps.length;\r\n    let columnLetter = workSheet._columns[offset].letter;\r\n\r\n    //Add data bar formatting\r\n    workSheet.addConditionalFormatting({\r\n      ref: `${columnLetter}${3}:${columnLetter}${tableRows.length + 2}`,\r\n      rules: [\r\n        {\r\n          type: \"dataBar\",\r\n          color: { argb: \"C6EFCE\" },\r\n          gradient: false,\r\n          cfvo: [\r\n            { type: \"num\", value: 0 },\r\n            { type: \"num\", value: 1 },\r\n          ],\r\n          style: {\r\n            font: { color: { argb: \"006100\" } },\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    //Add number formatting\r\n    for (let index = 1; index <= tableRows.length; index++) {\r\n      this.addNumberFormatting(workSheet, columnLetter + (index + 2));\r\n    }\r\n  }\r\n\r\n  addfulfillmentFormulaHelper(\r\n    firstColumnLetter,\r\n    lastColumnLetter,\r\n    childRowCellsCounter\r\n  ) {\r\n    let formula = `=IFERROR((COUNTIF(${firstColumnLetter}${childRowCellsCounter}:${lastColumnLetter}${childRowCellsCounter},\"${STATUS_CLOSED}\") \r\n          +COUNTIF(${firstColumnLetter}${childRowCellsCounter}:${lastColumnLetter}${childRowCellsCounter},\"${STATUS_WIP}\")* 0.5) / \r\n          (COUNTIF(${firstColumnLetter}${childRowCellsCounter}:${lastColumnLetter}${childRowCellsCounter},\"${STATUS_OPEN}\") \r\n          +COUNTIF(${firstColumnLetter}${childRowCellsCounter}:${lastColumnLetter}${childRowCellsCounter},\"${STATUS_WIP}\") \r\n          +COUNTIF(${firstColumnLetter}${childRowCellsCounter}:${lastColumnLetter}${childRowCellsCounter},\"${STATUS_CLOSED}\")) ,\"${STATUS_NREL}\")`;\r\n    return formula;\r\n  }\r\n\r\n  addfulfillmentFormula(workSheet, props) {\r\n    let offset = 3 + props.responsibles.length + props.steps.length;\r\n    let fulfillmentColumnLetter = workSheet._columns[offset].letter;\r\n    let columnOffset = 3 + props.responsibles.length;\r\n    let childRowCellsCounter = 3;\r\n\r\n    let firstColumnLetter = workSheet._columns[columnOffset].letter;\r\n    let lastColumnLetter =\r\n      workSheet._columns[columnOffset + props.steps.length - 1].letter;\r\n\r\n    for (let i = 1; i <= props.deliverables.length; i++) {\r\n      const deliverable = props.deliverables[i - 1];\r\n      let deliverableLength;\r\n\r\n      if (deliverable && deliverable.isChild === true) {\r\n        deliverableLength = deliverable.children.length;\r\n\r\n        for (let j = 1; j <= deliverableLength; j++) {\r\n          let formula = this.addfulfillmentFormulaHelper(\r\n            firstColumnLetter,\r\n            lastColumnLetter,\r\n            childRowCellsCounter + j\r\n          );\r\n          let fulfillmentCell = `${fulfillmentColumnLetter}${childRowCellsCounter +\r\n            j}`;\r\n          // console.log('fullfillment cell is ', fulfillmentCell);\r\n          workSheet.getCell(fulfillmentCell).value = {\r\n            formula: formula,\r\n          };\r\n        }\r\n        childRowCellsCounter += deliverableLength + 1;\r\n      } else {\r\n        let formula = this.addfulfillmentFormulaHelper(\r\n          firstColumnLetter,\r\n          lastColumnLetter,\r\n          childRowCellsCounter\r\n        );\r\n        let fulfillmentCell = `${fulfillmentColumnLetter}${childRowCellsCounter}`;\r\n        workSheet.getCell(fulfillmentCell).value = {\r\n          formula: formula,\r\n        };\r\n        childRowCellsCounter += 1;\r\n      }\r\n    }\r\n  }\r\n\r\n  addNumberFormatting(workSheet, cell) {\r\n    workSheet.getCell(cell).numFmt = \"0%\";\r\n  }\r\n\r\n  formTableRows(workSheet, props) {\r\n    const tableRows = [];\r\n\r\n    props.deliverables.forEach((item, index) => {\r\n      let itemValues = [];\r\n\r\n      if (item.isChild) {\r\n        const responsibles = [];\r\n\r\n        props.responsibles.forEach((r) => {\r\n          responsibles.push(item[r.identity]);\r\n        });\r\n\r\n        console.log(\"responsible rows\", responsibles);\r\n\r\n        const firstRow = [\r\n          item.id,\r\n          item.description,\r\n          item.weight,\r\n          ...responsibles,\r\n        ];\r\n\r\n        tableRows.push(firstRow);\r\n\r\n        item.children.forEach((row, index) => {\r\n          let childValues = [];\r\n          childValues.push(row.id);\r\n          childValues.push(row.description);\r\n          childValues.push(parseFloat(row.weight));\r\n\r\n          props.responsibles.forEach((r) => {\r\n            childValues.push(row[r.identity]);\r\n          });\r\n\r\n          props.steps.forEach((s) => {\r\n            childValues.push(row[s.identity]);\r\n          });\r\n\r\n          tableRows.push(childValues);\r\n        });\r\n      } else {\r\n        itemValues.push(item.id);\r\n        itemValues.push(item.description);\r\n        itemValues.push(parseFloat(item.weight));\r\n\r\n        props.responsibles.forEach((r) => {\r\n          itemValues.push(item[r.identity]);\r\n        });\r\n\r\n        props.steps.forEach((s) => {\r\n          itemValues.push(item[s.identity]);\r\n        });\r\n\r\n        tableRows.push(itemValues);\r\n      }\r\n    });\r\n    // console.log('table rows', tableRows);\r\n    return tableRows;\r\n  }\r\n\r\n  addColorFormatting(workSheet, targetCell) {\r\n    workSheet.addConditionalFormatting({\r\n      ref: targetCell,\r\n      rules: [\r\n        {\r\n          type: \"cellIs\",\r\n          operator: \"equal\",\r\n          color: { argb: \"FF00FF00\" },\r\n          formulae: [`\"${STATUS_CLOSED}\"`],\r\n          style: {\r\n            fill: {\r\n              type: \"pattern\",\r\n              pattern: \"solid\",\r\n              bgColor: { argb: \"C6EFCE\" },\r\n            },\r\n            font: { color: { argb: \"006100\" } },\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    workSheet.addConditionalFormatting({\r\n      ref: targetCell,\r\n      rules: [\r\n        {\r\n          type: \"cellIs\",\r\n          operator: \"equal\",\r\n          color: { argb: \"FF00FF00\" },\r\n          formulae: [`\"${STATUS_OPEN}\"`],\r\n          style: {\r\n            fill: {\r\n              type: \"pattern\",\r\n              pattern: \"solid\",\r\n              bgColor: { argb: \"FFC7CE\" },\r\n            },\r\n            font: { color: { argb: \"9C0006\" } },\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    workSheet.addConditionalFormatting({\r\n      ref: targetCell,\r\n      rules: [\r\n        {\r\n          type: \"cellIs\",\r\n          operator: \"equal\",\r\n          color: { argb: \"FF00FF00\" },\r\n          formulae: [`\"${STATUS_WIP}\"`],\r\n          style: {\r\n            fill: {\r\n              type: \"pattern\",\r\n              pattern: \"solid\",\r\n              bgColor: { argb: \"FFEB9C\" },\r\n            },\r\n            font: { color: { argb: \"9C6500\" } },\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    workSheet.addConditionalFormatting({\r\n      ref: targetCell,\r\n      rules: [\r\n        {\r\n          type: \"cellIs\",\r\n          operator: \"equal\",\r\n          color: { argb: \"FF00FF00\" },\r\n          formulae: [`\"${STATUS_NREL}\"`],\r\n          style: {\r\n            fill: {\r\n              type: \"pattern\",\r\n              pattern: \"solid\",\r\n              bgColor: { argb: \"\" },\r\n            },\r\n          },\r\n        },\r\n      ],\r\n    });\r\n  }\r\n\r\n  async loadExcel(props) {\r\n    let laodTable = [];\r\n    const wb = new ExcelJS.Workbook();\r\n    const reader = new FileReader();\r\n\r\n    reader.readAsArrayBuffer(props.file);\r\n    return new Promise((resolve) => {\r\n      reader.onload = async () => {\r\n        const buffer = reader.result;\r\n        const workbook = await wb.xlsx.load(buffer);\r\n\r\n        // let sheet = workbook.getWorksheet(\"TestSheet\");\r\n        let sheet = workbook.getWorksheet(1);\r\n\r\n        let firstStepColumnNumber = 4;\r\n        let lastStepColumnNumber = 0;\r\n        let firstResponsibleColumnNumber = 0;\r\n        let lastResponsibleColumnNumber = 0;\r\n        let offset = 3;\r\n        let headerValues;\r\n        sheet.eachRow((row, rowNumber) => {\r\n          if (rowNumber < 2) {\r\n            return;\r\n          }\r\n\r\n          //Remove the unwanted empty row that exceljs loads\r\n          let rowValues = row.values;\r\n          rowValues.shift();\r\n\r\n          if (rowNumber == 2) {\r\n            headerValues = rowValues;\r\n            return;\r\n          }\r\n\r\n          if (rowNumber == 3) {\r\n            rowValues.some((value, index) => {\r\n              if (\r\n                value == `${STATUS_OPEN}` ||\r\n                value == `${STATUS_WIP}` ||\r\n                value == `${STATUS_CLOSED}` ||\r\n                value == `${STATUS_NREL}`\r\n              ) {\r\n                firstStepColumnNumber = index + 1;\r\n                return true;\r\n              }\r\n            });\r\n\r\n            if (firstStepColumnNumber - offset != 1) {\r\n              firstResponsibleColumnNumber = offset + 1;\r\n              lastResponsibleColumnNumber = firstStepColumnNumber - 1;\r\n            }\r\n            lastStepColumnNumber = rowValues.length - 1;\r\n          }\r\n\r\n          // console.log(rowValues);\r\n\r\n          const loadingObject = {\r\n            id: row.getCell(1).value,\r\n            description: row.getCell(2).value,\r\n            weight: row.getCell(3).value,\r\n            showEditDialog: false,\r\n          };\r\n\r\n          let counter = 1;\r\n          if (firstResponsibleColumnNumber != 0) {\r\n            for (\r\n              let start = firstResponsibleColumnNumber;\r\n              start <= lastResponsibleColumnNumber;\r\n              start++\r\n            ) {\r\n              if (counter == 1) {\r\n                loadingObject[\"responsible\"] = row.getCell(start).value;\r\n              } else {\r\n                loadingObject[\"responsible\" + counter] = row.getCell(\r\n                  start\r\n                ).value;\r\n              }\r\n              counter++;\r\n            }\r\n          }\r\n\r\n          counter = 1;\r\n          for (\r\n            let start = firstStepColumnNumber;\r\n            start <= lastStepColumnNumber;\r\n            start++\r\n          ) {\r\n            loadingObject[\"step\" + counter] = row.getCell(start).value;\r\n            counter++;\r\n          }\r\n          loadingObject[\"fulfillment\"] = row.getCell(rowValues.length).value;\r\n\r\n          // console.log(loadingObject);\r\n          laodTable.push(loadingObject);\r\n        });\r\n\r\n        //Forming responsibles array (if any) to return it as props to be used for loading in the browser\r\n\r\n        let responsibles = [];\r\n        let responsiblesCounter = 1;\r\n        if (firstResponsibleColumnNumber != 0) {\r\n          for (\r\n            let i = firstResponsibleColumnNumber;\r\n            i <= lastResponsibleColumnNumber;\r\n            i++\r\n          ) {\r\n            if (responsiblesCounter == 1) {\r\n              responsibles.push({\r\n                text: headerValues[i - 1],\r\n                identity: `responsible`,\r\n              });\r\n            } else {\r\n              responsibles.push({\r\n                text: headerValues[i - 1],\r\n                identity: `responsible${responsiblesCounter}`,\r\n              });\r\n            }\r\n            responsiblesCounter++;\r\n          }\r\n        }\r\n        //Forming steps array to return it as props to be used for loading in the browser\r\n        const steps = [];\r\n        let stepCounter = 1;\r\n        for (let i = firstStepColumnNumber; i <= lastStepColumnNumber; i++) {\r\n          steps.push({\r\n            text: headerValues[i - 1],\r\n            identity: `step${stepCounter}`,\r\n          });\r\n          stepCounter++;\r\n        }\r\n\r\n        //Forming headers array to return it as props to be used for loading in the browser\r\n        //The following 'headers' object was copied from store's statusTable. Refactoring may be needed\r\n        //to use only one\r\n\r\n        const headers = [\r\n          {\r\n            text: \"No\",\r\n            align: \"start\",\r\n            value: \"id\",\r\n            sortable: true,\r\n            editable: false,\r\n            headerEditable: false,\r\n          },\r\n          { text: \"Description\", value: \"description\", editable: true },\r\n          { text: \"Weight\", value: \"weight\", editable: true },\r\n\r\n          { text: \"Fulfillment\", value: \"fulfillment\", editable: false },\r\n        ];\r\n\r\n        //Add responsibles columns (if any) to headers array\r\n        responsiblesCounter = 1;\r\n        if (responsibles.length > 0) {\r\n          for (\r\n            let i = firstResponsibleColumnNumber;\r\n            i <= lastResponsibleColumnNumber;\r\n            i++\r\n          ) {\r\n            if (responsiblesCounter == 1) {\r\n              headers.splice(i - 1, 0, {\r\n                text: `${headerValues[i - 1]}`,\r\n                value: \"responsible\",\r\n                editable: true,\r\n                sortable: false,\r\n                headerEditable: true,\r\n              });\r\n            } else {\r\n              headers.splice(i - 1, 0, {\r\n                text: `${headerValues[i - 1]}`,\r\n                value: `responsible${responsiblesCounter}`,\r\n                editable: true,\r\n                sortable: false,\r\n                headerEditable: true,\r\n              });\r\n            }\r\n\r\n            responsiblesCounter++;\r\n          }\r\n        }\r\n\r\n        //Add steps columns to headers array\r\n        stepCounter = 1;\r\n        for (let i = firstStepColumnNumber; i <= lastStepColumnNumber; i++) {\r\n          headers.splice(i - 1, 0, {\r\n            text: `${headerValues[i - 1]}`,\r\n            value: `step${stepCounter}`,\r\n            editable: true,\r\n            sortable: false,\r\n            headerEditable: true,\r\n          });\r\n          stepCounter++;\r\n        }\r\n        const props = {\r\n          deliverables: laodTable,\r\n          responsibles: responsibles,\r\n          steps: steps,\r\n          headers: headers,\r\n        };\r\n        resolve(props);\r\n      };\r\n    }).then((props) => {\r\n      return props;\r\n    });\r\n  }\r\n}\r\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('v-btn',{staticClass:\"mx-2 mb-2\",attrs:{\"x-small\":\"\",\"dark\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.addColumn('Status')}}},[_vm._v(\"ADD STATUS COLUMN\")]),_c('v-btn',{staticClass:\"mx-2 mb-2\",attrs:{\"x-small\":\"\",\"dark\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.addColumn('Responsible')}}},[_vm._v(\"ADD RESPONSIBLE COLUMN\")])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <v-btn x-small class=\"mx-2 mb-2\" dark color=\"primary\" @click=\"addColumn('Status')\"\r\n      >ADD STATUS COLUMN</v-btn\r\n    >\r\n    <v-btn x-small class=\"mx-2 mb-2\" dark color=\"primary\" @click=\"addColumn('Responsible')\"\r\n      >ADD RESPONSIBLE COLUMN</v-btn\r\n    >\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\nimport FulfilmentsUtil from \"../utils/fulfilments-util\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      stepOffset: 3,\r\n      nextColumnName: this.getNextColumnName(\"Status\"),\r\n      rules: {\r\n        counter: (value) => value.length <= 20 || \"Max 20 characters\",\r\n        required: (value) => !!value || \"Required.\",\r\n        alreadyExist: (value) => {\r\n          return (\r\n            !this.headers.find((header) => {\r\n              return value.toLowerCase() === header.text.toLowerCase();\r\n            }) || \"Column name already exist\"\r\n          );\r\n        },\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    getNextColumnName(columnType) {\r\n      return this.$store.getters.getNextColumnName(columnType);\r\n    },\r\n    addColumn(columnType) {\r\n      this.nextColumnName = this.getNextColumnName(columnType);\r\n      if (this.rules.required(this.nextColumnName) === true && this.rules.alreadyExist(this.nextColumnName) === true) {\r\n        if (columnType === \"Status\") {\r\n          this.addStatusColumn();\r\n        } else {\r\n          this.addResponsibleColumn();\r\n        }\r\n\r\n        this.$store.dispatch(\"setHeaders\", this.headers);\r\n        this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n        this.$store.dispatch(\"setNextColumnName\", columnType);\r\n      }\r\n    },\r\n    addStatusColumn() {\r\n      let stepLength = this.steps.length;\r\n      let stepText = this.nextColumnName;\r\n      let stepIdentity = `step${stepLength + 1}`;\r\n      //Add new added step to headers array\r\n      this.headers.splice(this.headers.length - 1, 0, {\r\n        text: stepText,\r\n        value: stepIdentity,\r\n        editable: true,\r\n        sortable: false,\r\n        headerEditable: true,\r\n        columnDeleteIcon: false,\r\n      });\r\n\r\n      this.steps.push({ text: stepText, identity: stepIdentity });\r\n      //Change all row to have new added column value as 'open'\r\n      this.deliverables.forEach((item) => {\r\n        //This should be used instead of the above commented array form to add reactivity to all newly added column cells.\r\n        if (item.isGrouped) {\r\n          item.children.map((child) => {\r\n            this.$set(child, stepIdentity, \"open\");\r\n          });\r\n        } else {\r\n          this.$set(item, stepIdentity, \"open\");\r\n        }\r\n      });\r\n\r\n      const util = new FulfilmentsUtil();\r\n      util.recalculateAllFulfillments(this.deliverables, this.steps);\r\n\r\n      this.$store.dispatch(\"setSteps\", this.steps);\r\n    },\r\n    addResponsibleColumn() {\r\n      let responsiblesLength = this.responsibles.length;\r\n      let responsiblesText = this.nextColumnName;\r\n      let responsibleIdentity = this.$store.getters.nextResponsibleIdentity;\r\n\r\n      this.headers.splice(responsiblesLength + this.stepOffset, 0, {\r\n        text: responsiblesText,\r\n        value: responsibleIdentity,\r\n        editable: true,\r\n        sortable: false,\r\n        headerEditable: true,\r\n        columnDeleteIcon: false,\r\n      });\r\n\r\n      this.responsibles.push({\r\n        text: responsiblesText,\r\n        identity: responsibleIdentity,\r\n      });\r\n\r\n      this.$store.dispatch(\"setResponsibles\", this.responsibles);\r\n    },\r\n  },\r\n\r\n  computed: {\r\n    ...mapState([\"statusTable\"]),\r\n    headers() {\r\n      return this.statusTable.headers;\r\n    },\r\n    deliverables() {\r\n      return this.statusTable.deliverables;\r\n    },\r\n    responsibles() {\r\n      return this.statusTable.responsibles;\r\n    },\r\n    steps() {\r\n      return this.statusTable.steps;\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AddColumn.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AddColumn.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./AddColumn.vue?vue&type=template&id=293a388d\"\nimport script from \"./AddColumn.vue?vue&type=script&lang=js\"\nexport * from \"./AddColumn.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <v-toolbar height=\"32\" class=\"mb-0 mt-0\" flat color=\"white\">\r\n    <v-toolbar-title>Tasks</v-toolbar-title>\r\n    <v-divider class=\"mx-4\" inset vertical></v-divider>\r\n    <v-btn x-small color=\"primary\" dark class=\"mb-2\" @click=\"generateExcel\">Generate Excel</v-btn>\r\n\r\n    <v-btn x-small color=\"primary\" dark class=\"mb-2 ml-2\" @click=\"adjustSize\">{{ adjustText }}</v-btn>\r\n\r\n    <v-btn x-small color=\"primary\" dark class=\"mb-2 ml-2\" @click=\"addRow\">Add Row</v-btn>\r\n    <v-divider class=\"mx-4\" inset vertical></v-divider>\r\n\r\n    <v-file-input\r\n      dense\r\n      v-model=\"file\"\r\n      placeholder=\"Load excel file\"\r\n      label=\"File input\"\r\n      prepend-icon=\"mdi-paperclip\"\r\n      show-size\r\n      @change=\"loadExcel\"\r\n    >\r\n      <template v-slot:selection=\"{ text }\">\r\n        <v-chip small label color=\"primary\">{{ text }}</v-chip>\r\n      </template>\r\n    </v-file-input>\r\n    <v-divider class=\"mx-4\" inset vertical></v-divider>\r\n\r\n    <v-spacer></v-spacer>\r\n    <v-btn x-small color=\"primary\" dark class=\"mr-2 mb-2\" @click=\"undoDelete\"> UNDELETE </v-btn>\r\n    <v-btn x-small color=\"primary\" dark class=\"mb-2\" @click=\"toggleWeight\">{{ showWeight }}</v-btn>\r\n    <AddColumn />\r\n  </v-toolbar>\r\n</template>\r\n\r\n<script>\r\nimport ExcelOperator from \"../../utils/excel-operator\";\r\nimport { mapState } from \"vuex\";\r\nimport FulfilmentsUtil from \"../../utils/fulfilments-util\";\r\nimport AddColumn from \"@/components/AddColumn\";\r\nconst util = new FulfilmentsUtil();\r\n\r\nexport default {\r\n  props: [\"showWeight\"],\r\n  emits: [\"handleShowWeight\", \"handleUndelete\"],\r\n  data: () => ({\r\n    horizontalAdjusted: false,\r\n    adjustText: \"Fit On Page\",\r\n    heightScale: 0,\r\n    widthScale: 0,\r\n    file: null,\r\n  }),\r\n  components: {\r\n    AddColumn,\r\n  },\r\n  computed: {\r\n    stepsFulfillment() {\r\n      return this.$store.getters.stepsFulfillment;\r\n    },\r\n    ...mapState([\"statusTable\"]),\r\n    headers() {\r\n      return this.statusTable.headers;\r\n    },\r\n    filteredHeaders() {\r\n      // console.log('headers arr', this.statusTable.headers)\r\n      // Add a checkbox header\r\n      return this.statusTable.headers.filter((item) => {\r\n        if (this.showWeight === \"Show Weight\") {\r\n          return item.value !== \"weight\";\r\n        } else {\r\n          return true;\r\n        }\r\n      });\r\n    },\r\n    deliverables() {\r\n      return this.statusTable.deliverables;\r\n    },\r\n    responsibles() {\r\n      return this.statusTable.responsibles;\r\n    },\r\n    steps() {\r\n      return this.statusTable.steps;\r\n    },\r\n    totalFulfillment() {\r\n      return Math.round(this.$store.getters.totalFulfillment);\r\n    },\r\n  },\r\n  methods: {\r\n    generateExcel() {\r\n      const excelOperator = new ExcelOperator(\r\n        this.deliverables,\r\n        this.steps,\r\n        this.responsibles,\r\n        this.stepsFulfillment,\r\n        this.totalFulfillment\r\n      );\r\n      const passObject = {\r\n        deliverables: this.deliverables,\r\n        headers: this.headers,\r\n        steps: this.steps,\r\n        responsibles: this.responsibles,\r\n        stepsFulfillment: this.stepsFulfillment,\r\n        totalFulfillment: this.totalFulfillment,\r\n      };\r\n      excelOperator.saveAsExcel(passObject);\r\n    },\r\n    adjustSize() {\r\n      const table = document.getElementsByTagName(\"table\")[0];\r\n      const tableWrapper = document.getElementsByClassName(\"v-data-table__wrapper\")[0];\r\n      if (this.adjustText === \"Normal Size\") {\r\n        if (!this.horizontalAdjusted) {\r\n          tableWrapper.style.width = tableWrapper.clientWidth * this.heightScale + \"px\";\r\n        }\r\n        table.style.transform = `scale(1)`;\r\n        this.adjustText = \"Fit On Page\";\r\n      } else {\r\n        const containerWidth = tableWrapper.clientWidth;\r\n        const containerHeight = tableWrapper.clientHeight;\r\n        const scrollWidth = tableWrapper.scrollWidth;\r\n        const scrollHeight = tableWrapper.scrollHeight;\r\n        this.widthScale = containerWidth / scrollWidth;\r\n        this.heightScale = containerHeight / scrollHeight;\r\n\r\n        if (this.widthScale < this.heightScale) {\r\n          table.style.transform = `scale(${this.widthScale})`;\r\n          this.horizontalAdjusted = true;\r\n        } else {\r\n          table.style.transform = `scale(${this.heightScale})`;\r\n\r\n          tableWrapper.style.width = tableWrapper.clientWidth / this.heightScale + \"px\";\r\n          this.horizontalAdjusted = false;\r\n        }\r\n        this.adjustText = \"Normal Size\";\r\n      }\r\n    },\r\n    addRow() {\r\n      let id = 1;\r\n      let tasksLength = this.deliverables.length;\r\n      if (tasksLength !== 0) {\r\n        id = this.deliverables[tasksLength - 1].id + 1;\r\n      }\r\n      const row = {\r\n        id: id,\r\n        description: \"\",\r\n        responsible: \"\",\r\n        weight: 1,\r\n        fulfillment: 0,\r\n        showEditDialog: false,\r\n      };\r\n\r\n      this.steps.forEach((step) => {\r\n        let identity = step.identity;\r\n        row[identity] = \"open\";\r\n      });\r\n\r\n      this.deliverables.push(row);\r\n      this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n    },\r\n    async loadExcel() {\r\n      if (this.file) {\r\n        //TODO for later steps make another constructor for laod excel\r\n        const excelOperator = new ExcelOperator(\r\n          this.deliverables,\r\n          this.steps,\r\n          this.responsibles,\r\n          this.stepsFulfillment,\r\n          this.totalFulfillment\r\n        );\r\n\r\n        const passObject = {\r\n          file: this.file,\r\n          deliverables: this.deliverables,\r\n          headers: this.headers,\r\n          steps: this.steps,\r\n          responsibles: this.responsibles,\r\n          stepsFulfillment: this.stepsFulfillment,\r\n          totalFulfillment: this.totalFulfillment,\r\n        };\r\n\r\n        let returnedProps = await excelOperator.loadExcel(passObject);\r\n\r\n        util.recalculateAllFulfillments(returnedProps.deliverables, returnedProps.steps);\r\n\r\n        this.$store.dispatch(\"setDeliverables\", returnedProps.deliverables);\r\n        this.$store.dispatch(\"setSteps\", returnedProps.steps);\r\n        this.$store.dispatch(\"setResponsibles\", returnedProps.responsibles);\r\n        this.$store.dispatch(\"setHeaders\", returnedProps.headers);\r\n        this.$store.dispatch(\"setRowCounterToZero\", 0);\r\n      }\r\n    },\r\n    toggleWeight() {\r\n      this.$emit(\"handleShowWeight\");\r\n    },\r\n    undoDelete() {\r\n      this.$emit(\"handleUndelete\");\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style></style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Toolbar.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Toolbar.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Toolbar.vue?vue&type=template&id=69ba6d1e\"\nimport script from \"./Toolbar.vue?vue&type=script&lang=js\"\nexport * from \"./Toolbar.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.header.headerEditable)?_c('v-edit-dialog',{on:{\"open\":function($event){return _vm.headerTextFieldOpen(_vm.header.text)},\"save\":function($event){return _vm.changeHeader(_vm.header)}},scopedSlots:_vm._u([{key:\"input\",fn:function(){return [_c('v-text-field',{attrs:{\"value\":_vm.header.text,\"rules\":[_vm.rules.required, _vm.rules.alreadyExist],\"counter\":\"\",\"maxlength\":\"20\",\"label\":\"Edit\",\"single-line\":\"\"},on:{\"focus\":function($event){return $event.target.select()},\"change\":function($event){return _vm.inputChanged($event)}}})]},proxy:true}],null,false,1862401062)},[_c('span',[_c('span',[_vm._v(\" \"+_vm._s(_vm.header.text)+\" \")])])]):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <!-- Step's header edit dialog -->\r\n  <v-edit-dialog\r\n    class=\"\"\r\n    v-if=\"header.headerEditable\"\r\n    @open=\"headerTextFieldOpen(header.text)\"\r\n    @save=\"changeHeader(header)\"\r\n  >\r\n    <!-- step title -->\r\n    <span>\r\n      <span>\r\n        {{ header.text }}\r\n      </span>\r\n      <!-- edit text field -->\r\n    </span>\r\n    <template v-slot:input>\r\n      <v-text-field\r\n        @focus=\"$event.target.select()\"\r\n        :value=\"header.text\"\r\n        @change=\"inputChanged($event)\"\r\n        :rules=\"[rules.required, rules.alreadyExist]\"\r\n        counter\r\n        maxlength=\"20\"\r\n        label=\"Edit\"\r\n        single-line\r\n      ></v-text-field>\r\n    </template>\r\n  </v-edit-dialog>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: [\"header\"],\r\n  emits: [\"handleHeaderTextFileOpend\", \"handleChangeHeader\", \"handleInputChange\"],\r\n  data: () => ({\r\n    rules: {\r\n      counter: (value) => value.length <= 20 || \"Max 20 characters\",\r\n      required: (value) => !!value || \"Required.\",\r\n      positiveNumbers: (value) => value > 0 || \"Should be greater than 0\",\r\n      alreadyExist: true,\r\n    },\r\n  }),\r\n  methods: {\r\n    headerTextFieldOpen(headerText) {\r\n      this.$emit(\"handleHeaderTextFileOpend\", headerText);\r\n    },\r\n    changeHeader(header) {\r\n      this.$emit(\"handleChangeHeader\", header);\r\n    },\r\n    inputChanged(value, param) {\r\n      this.$emit(\"handleInputChange\", value, param);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style></style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditDialogTableHeader.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditDialogTableHeader.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./EditDialogTableHeader.vue?vue&type=template&id=22a97cc2\"\nimport script from \"./EditDialogTableHeader.vue?vue&type=script&lang=js\"\nexport * from \"./EditDialogTableHeader.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div ref=\"containerRef\" class=\"container-width\">\r\n    <v-container fluid>\r\n      <v-row class=\"text-center\">\r\n        <v-col cols=\"12\" class=\"overflow-c\">\r\n          <div ref=\"tableRef\">\r\n            <v-data-table\r\n              :headers=\"filteredHeaders\"\r\n              :items=\"deliverables\"\r\n              hide-default-header\r\n              hide-default-footer\r\n              :sort-by.sync=\"sortBy\"\r\n              disable-pagination\r\n              :sort-desc.sync=\"sortDesc\"\r\n              class=\"elevation-1 zoom custom-data-table \"\r\n            >\r\n              <template v-slot:header=\"{ props: { headers } }\">\r\n                <thead class=\"v-data-table-header\">\r\n                  <!-- Toppest Row -->\r\n                  <tr ref=\"headerRef\">\r\n                    <th\r\n                      style=\"border: solid 0.5px; padding: 0px 0px;\"\r\n                      v-for=\"header in headers\"\r\n                      v-bind:key=\"header.value\"\r\n                    >\r\n                      <span></span>\r\n                      <span style=\"height: 100%\" v-if=\"header.value.includes('step')\">\r\n                        <linear-progress\r\n                          color=\"green\"\r\n                          :height=\"thHeight\"\r\n                          :value=\"stepsFulfillment[header.value]\"\r\n                        >\r\n                          {{\r\n                            stepsFulfillment[header.value] ? Math.round(stepsFulfillment[header.value]) : 0\r\n                          }}%\r\n                        </linear-progress>\r\n                      </span>\r\n                      <span v-else-if=\"header.value === 'fulfillment'\">\r\n                        <linear-progress\r\n                          :value=\"\r\n                            totalFulfillment !== null && !isNaN(totalFulfillment) ? totalFulfillment : 0\r\n                          \"\r\n                          color=\"green\"\r\n                          :height=\"thHeight\"\r\n                          reactive=\"reactive\"\r\n                          striped=\"striped\"\r\n                        >\r\n                          {{\r\n                            totalFulfillment !== null && !isNaN(totalFulfillment)\r\n                              ? totalFulfillment + \"%\"\r\n                              : \"n.rel.\"\r\n                          }}\r\n                        </linear-progress>\r\n                      </span>\r\n                      <div v-else style=\"color: white;\" @click=\"toggleWidth()\">\r\n                        '\r\n                      </div>\r\n                    </th>\r\n                  </tr>\r\n\r\n                  <!-- Second toppest Row -->\r\n                  <tr class=\"secondTopRow\">\r\n                    <!-- & -->\r\n                    <th\r\n                      id=\"tableHeader\"\r\n                      v-for=\"(header, idx) in headers\"\r\n                      :key=\"idx\"\r\n                      role=\"columnheader\"\r\n                      scope=\"col\"\r\n                      :aria-label=\"`${header.text}: Sorted ascending. Activate to sort descending.`\"\r\n                      aria-sort=\"ascending\"\r\n                      class=\"sortable\"\r\n                      :class=\"{\r\n                        active: sortBy === header.value,\r\n                        asc: sortDesc === false,\r\n                      }\"\r\n                    >\r\n                      <!-- <edit-dialog > </edit-dialog> -->\r\n                      <edit-dialog-table-header\r\n                        @handleChangeHeader=\"changeHeader\"\r\n                        @handleInputChange=\"inputChanged\"\r\n                        @handleHeaderTextFileOpend=\"headerTextFieldOpen\"\r\n                        :header=\"header\"\r\n                      ></edit-dialog-table-header>\r\n                      <!-- <span> -->\r\n                      <span\r\n                        id=\"deleteIcon\"\r\n                        v-if=\"header.headerEditable\"\r\n                        @click=\"conformMessage('', idx, 'column')\"\r\n                      >\r\n                        <v-icon small>mdi-delete</v-icon>\r\n                      </span>\r\n\r\n                      <!-- non step columns -->\r\n                      <span v-else>\r\n                        <span @click=\"sortColumn(header.value)\">\r\n                          <!-- non step columns title -->\r\n                          <span>{{ header.text }} </span>\r\n                          <span>\r\n                            <!-- The arrow -->\r\n                            <i\r\n                              :style=\"{\r\n                                transform: `rotate(${rotateValues[header.value]}deg)`,\r\n                              }\"\r\n                              @click=\"\r\n                                rotateValues[header.value] += rotateValues[header.value] === 0 ? -180 : 180\r\n                              \"\r\n                              aria-hidden=\"true\"\r\n                              class=\"v-icon notranslate v-data-table-header__icon mdi mdi-arrow-up theme--light\"\r\n                              style=\"font-size: 18px; transition: transform 0.25s linear;\"\r\n                            ></i>\r\n                          </span>\r\n                        </span>\r\n                      </span>\r\n                      <!-- </span> -->\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n              </template>\r\n              <template v-slot:body=\"{ items, headers }\">\r\n                <tbody>\r\n                  <template v-for=\"(item, idx) in items\">\r\n                    <tr ref=\"rowRef\">\r\n                      <td\r\n                        @mouseover=\"item.showEditDialog = true\"\r\n                        @mouseleave=\"mouseLeave(item)\"\r\n                        :title=\"expandedWidth ? getTitle(item, header) : ''\"\r\n                        v-for=\"(header, key) in headers\"\r\n                        :key=\"`inner_${key}`\"\r\n                        :style=\"cellBackgroundStyle(item[header.value])\"\r\n                        :class=\"{ 'expanded-td': expandedWidth }\"\r\n                      >\r\n                        <!-- header editable -->\r\n                        <span\r\n                          v-if=\"header.editable\"\r\n                          :class=\"{\r\n                            'left-justified':\r\n                              header.value === 'description' || header.value.includes('responsible'),\r\n                          }\"\r\n                        >\r\n                          <span v-if=\"!item.showEditDialog && !item.isChild\">\r\n                            {{ item[header.value] }}\r\n                          </span>\r\n\r\n                          <span v-else>\r\n                            <template v-if=\"header.value.includes('step')\">\r\n                              <!-- Render the value without v-edit-dialog for steps cell -->\r\n                              <span v-if=\"item.isChild\">\r\n                                {{\r\n                                  subProjectStepsFullFilment[item.id]\r\n                                    ? parseInt(Math.round(subProjectStepsFullFilment[item.id][header.value]))\r\n                                    : 0\r\n                                }}%\r\n                              </span>\r\n\r\n                              <span\r\n                                v-else\r\n                                @click=\"handleSelectChange(item, header.value)\"\r\n                                style=\"cursor: pointer;\"\r\n                              >\r\n                                {{ item[header.value] }}\r\n                              </span>\r\n                            </template>\r\n                            <template v-else>\r\n                              <edit-dialog-table-body\r\n                                @handleChangeCell=\"changeCell\"\r\n                                @handleClose1=\"close1\"\r\n                                @handleInputChanged=\"inputChanged\"\r\n                                @handleOpen=\"open\"\r\n                                :item=\"item\"\r\n                                :header=\"header\"\r\n                              >\r\n                              </edit-dialog-table-body>\r\n                            </template>\r\n                          </span>\r\n                        </span>\r\n\r\n                        <!-- header not editable -->\r\n                        <span v-else>\r\n                          <span v-if=\"header.value === 'fulfillment'\">\r\n                            <linear-progress\r\n                              :value=\"typeof item[header.value] === 'number' ? item[header.value] : 0\"\r\n                              color=\"green\"\r\n                              :height=\"tdHeight\"\r\n                              reactive=\"reactive\"\r\n                              striped=\"striped\"\r\n                            >\r\n                              {{\r\n                                typeof item[header.value] === \"number\"\r\n                                  ? Math.round(item[header.value]) + \"%\"\r\n                                  : \"n.rel.\"\r\n                              }}\r\n                            </linear-progress>\r\n                          </span>\r\n\r\n                          <!-- The ID  -->\r\n                          <div\r\n                            v-else\r\n                            @click=\"handleClick($event, idx, item.id)\"\r\n                            :class=\"{\r\n                              'deliverable--number': header.value === 'id',\r\n                              'selected-row': isSelected(item.id),\r\n                            }\"\r\n                          >\r\n                            <!-- <span v-if=\"isRangeSelected\" :class=\"isSelected(item.id)\" class=\"isChecked\"> </span> -->\r\n                            {{ item[header.value] }}\r\n                          </div>\r\n                        </span>\r\n                      </td>\r\n                    </tr>\r\n\r\n                    <!-- Check if the current row has children -->\r\n                    <template ref=\"rowRef\" v-if=\"item.children && item.children.length > 0\">\r\n                      <!-- Nested loop to render children rows -->\r\n                      <tr v-for=\"(child, childIdx) in item.children\" :key=\"`child_${idx}_${childIdx}`\">\r\n                        <td\r\n                          @mouseover=\"child.showEditDialog = true\"\r\n                          @mouseleave=\"mouseLeave(child)\"\r\n                          :title=\"expandedWidth ? getTitle(child, header) : ''\"\r\n                          v-for=\"(header, index) in headers\"\r\n                          :key=\"`inner_child_${index}`\"\r\n                          :style=\"cellBackgroundStyle(child[header.value])\"\r\n                          :class=\"{ 'expanded-td': expandedWidth }\"\r\n                        >\r\n                          <!-- header editable -->\r\n                          <span\r\n                            v-if=\"header.editable\"\r\n                            :class=\"{\r\n                              'left-justified':\r\n                                header.value === 'description' || header.value.includes('responsible'),\r\n                            }\"\r\n                          >\r\n                            <span v-if=\"!child.showEditDialog\">{{ child[header.value] }}</span>\r\n                            <span v-else>\r\n                              <template v-if=\"header.value.includes('step')\">\r\n                                <!-- Render the value without v-edit-dialog for steps cell -->\r\n                                <span\r\n                                  @click=\"handleSelectChange(child, header.value)\"\r\n                                  style=\"cursor: pointer;\"\r\n                                >\r\n                                  {{ child[header.value] }}\r\n                                </span>\r\n                              </template>\r\n                              <template v-else>\r\n                                <edit-dialog-table-body\r\n                                  @handleChangeCell=\"changeCell\"\r\n                                  @handleClose1=\"close1\"\r\n                                  @handleInputChanged=\"inputChanged\"\r\n                                  @handleOpen=\"open\"\r\n                                  :item=\"child\"\r\n                                  :header=\"header\"\r\n                                >\r\n                                </edit-dialog-table-body>\r\n                              </template>\r\n                            </span>\r\n                          </span>\r\n\r\n                          <!-- header not editable -->\r\n                          <span v-else>\r\n                            <span v-if=\"header.value === 'fulfillment'\">\r\n                              <linear-progress\r\n                                :value=\"typeof child[header.value] === 'number' ? child[header.value] : 0\"\r\n                                color=\"green\"\r\n                                :height=\"tdHeight\"\r\n                                reactive=\"reactive\"\r\n                                striped=\"striped\"\r\n                              >\r\n                                {{\r\n                                  typeof child[header.value] === \"number\"\r\n                                    ? Math.round(child[header.value]) + \"%\"\r\n                                    : \"n.rel.\"\r\n                                }}\r\n                              </linear-progress>\r\n                            </span>\r\n\r\n                            <!-- The ID  -->\r\n                            <div\r\n                              v-else\r\n                              @click=\"handleClick($event, childIdx, child.id, idx)\"\r\n                              :class=\"{\r\n                                'deliverable--number': header.value == 'id',\r\n                                'selected-row': isSelected(child.id),\r\n                              }\"\r\n                              style=\"cursor: pointer;\"\r\n                            >\r\n                              <!-- <span v-if=\"isRangeSelected\" :class=\"isSelected(child.id)\" class=\"isChecked\"> </span> -->\r\n                              {{ child[header.value] }}\r\n                            </div>\r\n                          </span>\r\n                          <!-- </span> -->\r\n                        </td>\r\n                      </tr>\r\n                    </template>\r\n                  </template>\r\n\r\n                  <div\r\n                    class=\"toolbox\"\r\n                    v-if=\"toolboxVisible\"\r\n                    :style=\"{ top: selectedRowTop + 'px' }\"\r\n                    v-click-outside=\"closetoolbox\"\r\n                  >\r\n                    <v-icon small @click=\"deleteRows\">mdi-delete</v-icon>\r\n                    <v-icon small @click=\"createNewRowFromSelected\">mdi-arrow-right</v-icon>\r\n                    <v-icon small @click.stop=\"ungroupSelectedChildren\">mdi-arrow-left</v-icon>\r\n                  </div>\r\n                </tbody>\r\n              </template>\r\n              <template v-slot:top>\r\n                <toolbar\r\n                  @handleShowWeight=\"toggleWeight\"\r\n                  @handleUndelete=\"undoDelete\"\r\n                  :showWeight=\"showWeight\"\r\n                />\r\n              </template>\r\n            </v-data-table>\r\n          </div>\r\n        </v-col>\r\n      </v-row>\r\n    </v-container>\r\n    <div v-if=\"showConformMessage\">\r\n      <ConfirmMessage\r\n        :message=\"message\"\r\n        :pressedType=\"pressedType\"\r\n        @deleteRow=\"deleteRow\"\r\n        @deleteStep=\"deleteColumn('step')\"\r\n        @deleteResponsible=\"deleteColumn('responsible')\"\r\n        @dontDelete=\"toggleShowConformMessage\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// import ExcelOperator from \"../utils/excel-operator\";\r\nimport FulfilmentsUtil from \"../utils/fulfilments-util\";\r\n// import AddColumn from \"@/components/AddColumn\";\r\nimport ConfirmMessage from \"@/components/ConfirmMessage\";\r\nimport { mapState } from \"vuex\";\r\nimport LinearProgress from \"./Table/LinearProgress.vue\";\r\n// import Editd from \"./Table/EditDialog.vue\";\r\nimport EditDialogTableBody from \"./Table/EditDialogTableBody.vue\";\r\nimport Toolbar from \"./Table/Toolbar.vue\";\r\nimport EditDialogTableHeader from \"./Table/EditDialogTableHeader.vue\";\r\n\r\nconst util = new FulfilmentsUtil();\r\n\r\nexport default {\r\n  name: \"HelloWorld\",\r\n  components: {\r\n    ConfirmMessage,\r\n    LinearProgress,\r\n    EditDialogTableHeader,\r\n    EditDialogTableBody,\r\n    Toolbar,\r\n  },\r\n  data: () => ({\r\n    index: -1,\r\n    selectedRowTop: 0,\r\n    selectedRows: [], // Track selected rows by index\r\n    selectedRow: null,\r\n    isRangeSelected: false,\r\n    deletedRows: [],\r\n    deletedRowsStack: [],\r\n    isShiftPressed: false,\r\n    toolboxVisible: false,\r\n    expandedWidth: true,\r\n    isDialogOpen: false,\r\n    showEditDialog: true,\r\n    selectItems: [\"open\", \"wip\", \"closed\", \"n.rel.\"],\r\n    rotateValues: { id: 0, description: 0, weight: 0, fulfillment: 0 },\r\n    sortBy: \"id\",\r\n    sortDesc: false,\r\n    file: null,\r\n    inputValue: \"\",\r\n    showWeight: \"Show Weight\",\r\n    max20chars: (v) => v.length <= 20 || \"Maximum 20 character allowed\",\r\n    rules: {\r\n      counter: (value) => value.length <= 20 || \"Max 20 characters\",\r\n      required: (value) => !!value || \"Required.\",\r\n      positiveNumbers: (value) => value > 0 || \"Should be greater than 0\",\r\n      alreadyExist: true,\r\n    },\r\n\r\n    adjustText: \"Fit On Page\",\r\n    heightScale: 0,\r\n    widthScale: 0,\r\n    horizontalAdjusted: false,\r\n\r\n    thHeight: 16,\r\n    thWidth: 0,\r\n    tdHeight: 16,\r\n    headerEditValue: \"\",\r\n\r\n    defaultItem: {\r\n      id: \"\",\r\n      description: \"\",\r\n      oneWeekBefore: \"\",\r\n      untilDayBefore: \"\",\r\n      fulfillment: 0,\r\n    },\r\n    stepOffset: 3,\r\n    // Added by MMG\r\n    showDeleteIcon: false,\r\n    columnDeleteIcon: false,\r\n    message: \"The Message\",\r\n    pressedId: \"\",\r\n    pressedType: \"\",\r\n    showConformMessage: false,\r\n    activeChildIndex: null,\r\n  }),\r\n  computed: {\r\n    stepsFulfillment() {\r\n      return this.$store.getters.stepsFulfillment;\r\n    },\r\n    subProjectStepsFullFilment() {\r\n      return this.$store.getters.subProjectStepsFullFilment;\r\n    },\r\n    ...mapState([\"statusTable\"]),\r\n    headers() {\r\n      return this.statusTable.headers;\r\n    },\r\n    filteredHeaders() {\r\n      // Add a checkbox header\r\n      return this.statusTable.headers.filter((item) => {\r\n        if (this.showWeight === \"Show Weight\") {\r\n          return item.value !== \"weight\";\r\n        } else {\r\n          return true;\r\n        }\r\n      });\r\n    },\r\n    deliverables() {\r\n      return this.statusTable.deliverables;\r\n    },\r\n    responsibles() {\r\n      return this.statusTable.responsibles;\r\n    },\r\n    steps() {\r\n      return this.statusTable.steps;\r\n    },\r\n    totalFulfillment() {\r\n      return Math.round(this.$store.getters.totalFulfillment);\r\n    },\r\n  },\r\n  mounted: function() {\r\n    console.log(\"deliverales\", this.deliverables);\r\n    this.$nextTick(function() {\r\n      // Code that will run only after the\r\n      // entire view has been rendered\r\n      if (this.$refs.headerRef) this.thHeight = this.$refs.headerRef.clientHeight;\r\n      this.thWidth = this.$refs.headerRef.clientWidth;\r\n      if (this.$refs.rowRef) this.tdHeight = this.$refs.rowRef[0].clientHeight;\r\n\r\n      const tableToolbarHeight = document.getElementsByClassName(\"v-toolbar__content\")[0].clientHeight;\r\n      const containerHeight = document.getElementsByClassName(\"overflow-c\")[0].clientHeight;\r\n      const tableWrapper = document.getElementsByClassName(\"v-data-table__wrapper\")[0];\r\n      tableWrapper.style.maxHeight = containerHeight - tableToolbarHeight + \"px\";\r\n    });\r\n  },\r\n  watch: {\r\n    dialog(val) {\r\n      val || this.close();\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    // Method to ungroup a child project\r\n    ungroupSelectedChildren() {\r\n      // Create an array to store the indices of children to be ungrouped\r\n      const childrenToUngroup = [];\r\n\r\n      // Iterate over the selected rows\r\n      this.selectedRows.forEach((rowId) => {\r\n        const parentIdx = this.findParentIndex(rowId);\r\n        if (parentIdx !== -1) {\r\n          const childIdx = this.findChildIndex(parentIdx, rowId);\r\n          if (childIdx !== -1) {\r\n            childrenToUngroup.push({ parentIdx, childIdx });\r\n          }\r\n        }\r\n      });\r\n\r\n      // Sort children to ungroup in descending order to avoid index issues\r\n      childrenToUngroup.sort((a, b) => b.parentIdx - a.parentIdx || b.childIdx - a.childIdx);\r\n\r\n      // Ungroup each child\r\n      childrenToUngroup.forEach(({ parentIdx, childIdx }) => {\r\n        this.ungroupChild(parentIdx, childIdx);\r\n      });\r\n\r\n      // Clear selection after ungrouping\r\n      this.selectedRows = [];\r\n\r\n      // Update the Vuex store if necessary\r\n      this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n\r\n      // Optionally, recalculate fulfillments\r\n      util.recalculateAllFulfillments(this.deliverables, this.steps);\r\n    },\r\n\r\n    // Method to ungroup a single child project\r\n    ungroupChild(parentIdx, childIdx) {\r\n      const parent = this.deliverables[parentIdx];\r\n      const child = parent.children[childIdx];\r\n\r\n      // Remove the child from the parent's children array\r\n      parent.children.splice(childIdx, 1);\r\n\r\n      // Insert the child right after the parent in the root deliverables array\r\n      this.deliverables.splice(parentIdx + 1, 0, child);\r\n\r\n      // If the parent has no more children, remove the parent as well\r\n      if (parent.children.length === 0) {\r\n        this.deliverables.splice(parentIdx, 1);\r\n      }\r\n\r\n      // Recalculate numbering\r\n      this.recalculateNumbering();\r\n    },\r\n\r\n    // Method to find parent index\r\n    findParentIndex(childId) {\r\n      for (let i = 0; i < this.deliverables.length; i++) {\r\n        if (this.deliverables[i].children) {\r\n          for (let j = 0; j < this.deliverables[i].children.length; j++) {\r\n            if (this.deliverables[i].children[j].id === childId) {\r\n              return i;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return -1;\r\n    },\r\n\r\n    // Method to find child index\r\n    findChildIndex(parentIdx, childId) {\r\n      const parent = this.deliverables[parentIdx];\r\n      for (let i = 0; i < parent.children.length; i++) {\r\n        if (parent.children[i].id === childId) {\r\n          return i;\r\n        }\r\n      }\r\n      return -1;\r\n    },\r\n\r\n    // Method to recalculate numbering\r\n    recalculateNumbering() {\r\n      this.deliverables.forEach((item, index) => {\r\n        item.id = index + 1;\r\n        if (item.children && item.children.length > 0) {\r\n          item.children.forEach((child, childIndex) => {\r\n            child.id = `${item.id}.${childIndex + 1}`;\r\n          });\r\n        }\r\n      });\r\n    },\r\n    closetoolbox(event) {\r\n      if (!event.target.classList.contains(\"deliverable--number\")) {\r\n        this.toolboxVisible = false;\r\n        this.index = -1;\r\n        this.selectedRows = [];\r\n      }\r\n    },\r\n\r\n    include() {\r\n      return [document.querySelector(\".deliverable--number\")];\r\n    },\r\n\r\n    renumberDeliverables(deliverables) {\r\n      return deliverables.map((row, index) => {\r\n        if (!row.isGrouped) {\r\n          return { ...row, id: index + 1 };\r\n        }\r\n\r\n        // Renumber the row\r\n        const renumberedRow = { ...row, id: index + 1 };\r\n\r\n        // Renumber the children if they exist\r\n        if (renumberedRow.children && renumberedRow.children.length > 0) {\r\n          renumberedRow.children = renumberedRow.children.map((child, childIndex) => {\r\n            return { ...child, id: `${renumberedRow.id}.${childIndex + 1}` };\r\n          });\r\n        }\r\n        return renumberedRow;\r\n      });\r\n    },\r\n\r\n    createNewRowFromSelected() {\r\n      if (this.selectedRows.length > 0) {\r\n        // Create a new row object with default values\r\n        const newRow = {\r\n          description: \"Subproject\",\r\n          fulfillment: 0,\r\n          id: Math.min(...this.selectedRows), // Generate a new ID based on the highest selected ID\r\n          responsible: \"\",\r\n          showEditDialog: false,\r\n          weight: 0,\r\n          isChild: true,\r\n          children: [],\r\n          isGrouped: true,\r\n        };\r\n\r\n        // Calculate the total weight for the selected rows\r\n        let totalWeight = 0;\r\n\r\n        // Update the selected rows and move them to the children property of the new row\r\n        newRow.children = this.selectedRows.map((id, index) => {\r\n          const selectedRow = this.deliverables.find((deliverable) => deliverable.id === id);\r\n          totalWeight += parseInt(selectedRow.weight);\r\n          return {\r\n            ...selectedRow,\r\n            id: `${newRow.id}.${index + 1}`,\r\n            isGrouped: true,\r\n            parentId: newRow.id,\r\n          };\r\n        });\r\n\r\n        // Set the calculated values to the new row\r\n        newRow.weight = totalWeight;\r\n\r\n        // Remove the selected rows from the deliverables array\r\n        let updatedDeliverables = this.deliverables.filter(\r\n          (deliverable) => !this.selectedRows.includes(deliverable.id)\r\n        );\r\n\r\n        // Calculate percentages and values for each step\r\n        this.calculateStepsFulfillmentForNewRow(newRow);\r\n\r\n        // Find the index where the new row should be inserted based on the 'id'\r\n        const insertIndex = updatedDeliverables.findIndex((row) => newRow.id - 1 < row.id);\r\n\r\n        // If insertIndex is -1, it means the new row should be added at the end\r\n        const finalIndex = insertIndex !== -1 ? insertIndex : updatedDeliverables.length;\r\n\r\n        // Insert the new row at the calculated position\r\n        updatedDeliverables.splice(finalIndex, 0, newRow);\r\n\r\n        // Clear selection after creating the new row\r\n        this.selectedRows = [];\r\n\r\n        // Hide the toolbox\r\n        this.toolboxVisible = false;\r\n\r\n        // renumber deliverables\r\n        updatedDeliverables = this.renumberDeliverables(updatedDeliverables);\r\n\r\n        // Update the store\r\n        this.$store.dispatch(\"setDeliverables\", updatedDeliverables);\r\n      }\r\n    },\r\n\r\n    calculateStepsFulfillmentForNewRow(row) {\r\n      // Calculate percentages based on total weight and fulfillment\r\n      if (row.weight > 0) {\r\n        let sumAll = 0;\r\n        // let totalWeights = 0;\r\n\r\n        this.steps.forEach((step) => {\r\n          let totalWeights = 0;\r\n          let wipCount = 0;\r\n          let closedCount = 0;\r\n\r\n          row.children.forEach((item, idx) => {\r\n            // const selectedRow = this.deliverables[idx];\r\n            if (item[step.identity] !== \"n.rel.\") {\r\n              totalWeights += +item.weight;\r\n            }\r\n            closedCount += item[step.identity] === \"closed\" ? 1 * item.weight : 0;\r\n            wipCount += item[step.identity] === \"wip\" ? 0.5 * item.weight : 0;\r\n          });\r\n          // const stepValue = row[step.identity];\r\n          row[step.identity] = ((closedCount + wipCount) / totalWeights) * 100;\r\n          // console.log(row[step.identity] = ((closedCount + wipCount) / totalWeights) * 100)\r\n          // console.log('weight ',totalWeights,' closed count',closedCount, ' wip count',wipCount)\r\n        });\r\n\r\n        // calculate the totalfulfillment for the selected rows.\r\n        if (this.steps.length > 0) {\r\n          let totalWeights = 0;\r\n          row.children.forEach((item, idx) => {\r\n            // const selectedRow = this.deliverables[idx];\r\n            if (typeof item.fulfillment === \"number\") {\r\n              totalWeights += +item.weight;\r\n              sumAll += item.fulfillment * item.weight;\r\n            }\r\n          });\r\n          row.fulfillment = sumAll / totalWeights;\r\n        }\r\n      }\r\n    },\r\n\r\n    deleteRows() {\r\n      if (this.selectedRows.length > 0) {\r\n        // Store deleted rows temporarily\r\n        const deletedRows = [];\r\n\r\n        // Iterate over selected rows and delete them\r\n        this.selectedRows.forEach((id) => {\r\n          const parentIdx = this.deliverables.findIndex((deliverable) => deliverable.id === id);\r\n\r\n          if (parentIdx !== -1) {\r\n            const parent = this.deliverables[parentIdx];\r\n            // Check if the item is a parent with children\r\n            if (parent.children && parent.children.length > 0) {\r\n              // Delete the parent and all its children\r\n              deletedRows.push(...parent.children);\r\n              deletedRows.push(parent);\r\n              this.deliverables.splice(parentIdx, 1);\r\n            } else {\r\n              // Delete the parent without children\r\n              deletedRows.push(parent);\r\n              this.deliverables.splice(parentIdx, 1);\r\n            }\r\n          } else {\r\n            // Handle deletion of child rows if necessary\r\n            this.deliverables.forEach((parent, parentIndex) => {\r\n              const childIdx = parent.children ? parent.children.findIndex((child) => child.id === id) : -1;\r\n              if (childIdx !== -1) {\r\n                const deletedChild = parent.children.splice(childIdx, 1)[0];\r\n                deletedRows.push(deletedChild);\r\n                // If no children left, remove the parent\r\n                if (parent.children.length === 0) {\r\n                  this.deliverables.splice(parentIndex, 1);\r\n                  deletedRows.push(parent);\r\n                }\r\n              }\r\n            });\r\n          }\r\n        });\r\n\r\n        // Clear selection after deletion\r\n        this.selectedRows = [];\r\n\r\n        // Store deleted rows for potential undo\r\n        this.deletedRowsStack.push(deletedRows);\r\n\r\n        // Recalculate fulfillments\r\n        util.recalculateAllFulfillments(this.deliverables, this.steps);\r\n\r\n        // Update the store\r\n        this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n\r\n        // Update the toolbox visibility\r\n        this.toolboxVisible = false;\r\n        this.index = null;\r\n        // }\r\n      }\r\n    },\r\n\r\n    // Function to find the next available ID\r\n    getNextAvailableId(deliverables) {\r\n      let id = 1;\r\n      let tasksLength = deliverables.length;\r\n      if (tasksLength !== 0) {\r\n        id = this.deliverables[tasksLength - 1].id + 1;\r\n      }\r\n      return id;\r\n    },\r\n\r\n    undoDelete() {\r\n      if (this.deletedRowsStack.length > 0) {\r\n        // Pop the last set of deleted rows from the stack\r\n        const lastDeletedRows = this.deletedRowsStack.pop();\r\n\r\n        // Restore deleted rows\r\n        lastDeletedRows.forEach((row) => {\r\n          if (row.parentId) {\r\n            // If the row is a child, find the parent and restore the child\r\n            const parent = this.deliverables.find((deliverable) => deliverable.id === row.parentId);\r\n            if (parent) {\r\n              parent.children = parent.children || [];\r\n              parent.children.push(row);\r\n              parent.children.sort((a, b) => a.id - b.id);\r\n            }\r\n          } else {\r\n            // If the row is a parent, check if it already exists in the deliverables array\r\n            const existingRow = this.deliverables.find((deliverable) => deliverable.id === row.id);\r\n            if (existingRow) {\r\n              // Assign a new ID if the parent row already exists\r\n              row.id = this.getNextAvailableId(this.deliverables);\r\n            }\r\n            this.deliverables.push(row);\r\n          }\r\n        });\r\n\r\n        // Recalculate fulfillments\r\n        const util = new FulfilmentsUtil();\r\n        util.recalculateAllFulfillments(this.deliverables, this.steps);\r\n\r\n        // Update the store (assuming you're using Vuex)\r\n        this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n      }\r\n    },\r\n\r\n    handleClick(event, idx, id, parentIdx = null) {\r\n      this.positionToolBox(idx, parentIdx);\r\n      if (event.shiftKey) {\r\n        this.handleRangeSelection(this.index, idx, parentIdx);\r\n        this.index = null;\r\n        this.isRangeSelected = true;\r\n        return;\r\n      } else if (event.ctrlKey) {\r\n        this.selectedRows.push(id);\r\n        this.isRangeSelected = true;\r\n        this.index = null;\r\n      } else {\r\n        this.selectedRows = [id];\r\n        this.index = idx;\r\n        this.isRangeSelected = false;\r\n      }\r\n    },\r\n\r\n    isSelected(id) {\r\n      // const item = this.selectedRows.includes(id);\r\n      // return item ? \"mdi mdi-check\" : \"\";\r\n      return this.selectedRows.includes(id);\r\n    },\r\n\r\n    handleRangeSelection(startIndex, endIndex, parentIndex = null) {\r\n      if (startIndex > endIndex) {\r\n        [startIndex, endIndex] = [endIndex, startIndex];\r\n      }\r\n      // Select the range between the last selected item and the current item\r\n      for (let i = startIndex; i <= endIndex; i++) {\r\n        const itemId = parentIndex\r\n          ? this.deliverables[parentIndex].children[i]?.id\r\n          : this.deliverables[i]?.id;\r\n        if (!this.selectedRows.includes(itemId)) {\r\n          this.selectedRows.push(itemId);\r\n        }\r\n      }\r\n    },\r\n\r\n    positionToolBox(parentIdx, childIdx) {\r\n      const rowHeight = 20; // Adjust this based on your table row height\r\n      this.selectedRowTop = (childIdx !== null ? childIdx + parentIdx : parentIdx) * rowHeight;\r\n      this.toolboxVisible = true;\r\n    },\r\n\r\n    handleSelectChange(item, headerValue) {\r\n      // Assuming steps are defined as an array\r\n      const steps = [\"open\", \"wip\", \"closed\", \"n.rel.\"];\r\n\r\n      // Get the current step index\r\n      const currentStepIndex = steps.indexOf(item[headerValue]);\r\n\r\n      // Calculate the next step index (cycling back to 0 if at the end)\r\n      const nextStepIndex = (currentStepIndex + 1) % steps.length;\r\n\r\n      // Set the new step value\r\n      this.$set(item, headerValue, steps[nextStepIndex]);\r\n\r\n      if (!item.isChild) {\r\n        // Recalculate the row\r\n        this.calculateRowFulfillment(item);\r\n      }\r\n\r\n      if (item.parentId !== undefined) {\r\n        // The item is a child, recalculate the parent row\r\n        let parentRow = this.deliverables.find((row) => row.id === item.parentId);\r\n        this.calculateStepsFulfillmentForNewRow(parentRow);\r\n      }\r\n\r\n      // Set the deliverables again.\r\n      this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n    },\r\n\r\n    // calculateEachSubprojectTotalFulfillment(row) {\r\n    //   if (this.steps.length > 0) {\r\n    //     let totalWeights = 0;\r\n    //     let sumAll = 0;\r\n\r\n    //     row.children.forEach((item, idx) => {\r\n    //       // const selectedRow = this.deliverables[idx];\r\n    //       if (typeof item.fulfillment === \"number\") {\r\n    //         totalWeights += +item.weight;\r\n    //         sumAll += item.fulfillment * item.weight;\r\n    //       }\r\n    //     });\r\n    //     row.fulfillment = sumAll / totalWeights;\r\n    //   }\r\n    // },\r\n\r\n    getProgressBarStyles(header, stepsFulfillment) {\r\n      return (stepsFulfillment[header.value] ? Math.round(stepsFulfillment[header.value]) : 0) + \"%\";\r\n    },\r\n\r\n    toggleWidth() {\r\n      this.expandedWidth = !this.expandedWidth;\r\n    },\r\n    getTitle(item, header) {\r\n      if (header.value.includes(\"step\") || !isNaN(item[header.value])) {\r\n        return \"\";\r\n      } else {\r\n        return item[header.value];\r\n      }\r\n    },\r\n    toggleWeight() {\r\n      if (this.showWeight === \"Show Weight\") {\r\n        this.showWeight = \"Hide Weight\";\r\n      } else {\r\n        this.showWeight = \"Show Weight\";\r\n      }\r\n    },\r\n    mouseLeave(item) {\r\n      if (!this.isDialogOpen) {\r\n        item.showEditDialog = false;\r\n      }\r\n    },\r\n    headerTextFieldOpen(headerText) {\r\n      this.inputValue = headerText;\r\n      this.rules.alreadyExist = (value) => {\r\n        return (\r\n          !this.headers.find((header) => {\r\n            return (\r\n              value.toLowerCase() === header.text.toLowerCase() &&\r\n              value.toLowerCase() !== headerText.toLowerCase()\r\n            );\r\n          }) || \"Column name already exist\"\r\n        );\r\n      };\r\n    },\r\n    //TODO refactor to only have one copy of this method in one place (AddColumn component)\r\n    calculateRowFulfillment(row) {\r\n      let stepsLength = this.steps.length;\r\n      let closedCount = 0;\r\n      let wipCount = 0;\r\n\r\n      // if (stepsLength > 0) {\r\n      this.steps.forEach((step) => {\r\n        closedCount += row[step.identity] === \"closed\" ? 1 : 0;\r\n        wipCount += row[step.identity] === \"wip\" ? 0.5 : 0;\r\n        stepsLength -= row[step.identity] === \"n.rel.\" ? 1 : 0;\r\n      });\r\n      // }\r\n      if (stepsLength > 0) {\r\n        let fulfillment = ((closedCount + wipCount) / stepsLength) * 100;\r\n        row.fulfillment = fulfillment;\r\n      } else {\r\n        row.fulfillment = \"n.rel.\";\r\n      }\r\n    },\r\n\r\n    cellBackgroundStyle(status) {\r\n      return {\r\n        backgroundColor: this.getColor(status),\r\n      };\r\n    },\r\n\r\n    getColor(status) {\r\n      if (status === \"open\") return \"#FF0000\";\r\n      else if (status === \"wip\") return \"orange\";\r\n      else if (status === \"n.rel.\") return \"#778899\";\r\n      else if (status === \"closed\") {\r\n        return \"#7bea7b\";\r\n      } else return null;\r\n    },\r\n\r\n    close1(item) {\r\n      setTimeout(() => {\r\n        this.isDialogOpen = false;\r\n        item.showEditDialog = false;\r\n      }, 500);\r\n    },\r\n    close() {},\r\n    cancel() {},\r\n    open(openedCell) {\r\n      this.isDialogOpen = true;\r\n      this.inputValue = openedCell;\r\n    },\r\n    changeCell(item, headerValue) {\r\n      item[headerValue] = this.inputValue;\r\n      // console.log('item header val', item)\r\n      item.showEditDialog = false;\r\n      this.isDialogOpen = false;\r\n      this.calculateRowFulfillment(item);\r\n      this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n    },\r\n\r\n    changeHeader(header) {\r\n      if (\r\n        this.rules.required(this.inputValue.length) === true &&\r\n        this.rules.alreadyExist(this.inputValue) === true\r\n      ) {\r\n        header.text = this.inputValue;\r\n\r\n        this.$store.dispatch(\"setHeaders\", this.headers);\r\n      }\r\n    },\r\n    inputChanged(value, param) {\r\n      // console.log(\"input changed value\", value, \"param\", param);\r\n\r\n      if (param === \"weight\") {\r\n        if (value !== \"\" && value > 0) {\r\n          this.inputValue = value;\r\n        }\r\n      } else {\r\n        this.inputValue = value;\r\n      }\r\n    },\r\n    sortColumn(headerValue) {\r\n      if (this.sortBy === headerValue) {\r\n        this.sortDesc = true;\r\n\r\n        if (this.rotateValues[headerValue] === 0) {\r\n          this.sortDesc = false;\r\n        }\r\n      } else {\r\n        this.sortDesc = false;\r\n        this.sortBy = headerValue;\r\n        this.rotateValues.id = 0;\r\n        this.rotateValues.description = 0;\r\n        this.rotateValues.weight = 0;\r\n        this.rotateValues.fulfillment = 0;\r\n      }\r\n    },\r\n    // Added by MMG\r\n    showDelete(idx) {\r\n      this.deliverables[idx].showDeleteIcon = true;\r\n    },\r\n    unShowDelete(idx) {\r\n      this.deliverables[idx].showDeleteIcon = false;\r\n    },\r\n    showColumnDelete(idx) {\r\n      ++idx;\r\n      this.headers[idx].columnDeleteIcon = true;\r\n    },\r\n    unShowColumnDelete(idx) {\r\n      ++idx;\r\n      this.headers[idx].columnDeleteIcon = false;\r\n    },\r\n    conformMessage(message, id, type) {\r\n      if (type === \"column\") {\r\n        if (this.showWeight === \"Show Weight\") {\r\n          ++id;\r\n        }\r\n        if (id > 2 && id < this.responsibles.length + 3) {\r\n          this.pressedId = id;\r\n          this.pressedType = \"responsible\";\r\n        } else {\r\n          this.pressedId = id;\r\n          this.pressedType = \"step\";\r\n        }\r\n        this.message = `Do you want to delete ${this.headers[id].text} column?`;\r\n      } else {\r\n        this.pressedId = id;\r\n        this.pressedType = \"Row\";\r\n        this.message = message;\r\n      }\r\n\r\n      this.toggleShowConformMessage();\r\n    },\r\n    deleteRow() {\r\n      let id = this.pressedId;\r\n      this.deliverables.splice(id, 1);\r\n      for (id; id < this.deliverables.length; id++) {\r\n        this.deliverables[id].id = this.deliverables[id].id - 1;\r\n      }\r\n      // &\r\n      this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n      this.toggleShowConformMessage();\r\n    },\r\n    deleteColumn(headerValue) {\r\n      let id = this.pressedId;\r\n      if (headerValue.includes(\"step\")) {\r\n        let stepNumber = id - (this.responsibles.length + 3);\r\n        let lengthOfStep = this.steps.length;\r\n        this.steps.splice(stepNumber, 1);\r\n        this.headers.splice(id, 1);\r\n\r\n        for (let a = 0; a < this.steps.length; a++) {\r\n          this.steps[a].identity = `step${a + 1}`;\r\n          this.steps[a].text = `step${a + 1}`;\r\n        }\r\n        let counter1 = 1;\r\n        for (let b = 3 + this.responsibles.length; b < this.headers.length - 1; b++) {\r\n          if (this.headers[b].text.includes(\"Step\")) {\r\n            this.headers[b].text = `Step${counter1}`;\r\n          }\r\n          this.headers[b].value = `step${counter1}`;\r\n          counter1++;\r\n        }\r\n\r\n        for (let c = 0; c < this.deliverables.length; c++) {\r\n          for (let d = stepNumber; d < this.steps.length; d++) {\r\n            this.deliverables[c][`step${d + 1}`] = this.deliverables[c][`step${d + 2}`];\r\n          }\r\n          this.calculateRowFulfillment(this.deliverables[c]);\r\n\r\n          // Calculate fulfillment for children\r\n          if (this.deliverables[c].isGrouped) {\r\n            this.deliverables[c].children.forEach((child) => {\r\n              this.calculateRowFulfillment(child);\r\n            });\r\n          }\r\n\r\n          delete this.deliverables[c][`step${lengthOfStep}`];\r\n        }\r\n\r\n        this.$store.dispatch(\"setHeaders\", this.headers);\r\n        this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n        this.$store.dispatch(\"setNextColumnName\", this.$store.getters.getNextColumnName(\"Status\"));\r\n        this.toggleShowConformMessage();\r\n        util.recalculateAllFulfillments(this.deliverables, this.steps);\r\n      } else if (headerValue.includes(\"responsible\")) {\r\n        for (let y = 0; y < this.deliverables.length; y++) {\r\n          let x = id;\r\n          for (x; x < this.responsibles.length + 3; x++) {\r\n            if (this.deliverables[y][`responsible${x - 1}`]) {\r\n              this.deliverables[y][`responsible${x - 2}`] = this.deliverables[y][`responsible${x - 1}`];\r\n            } else if (!this.deliverables[y][`responsible${x - 1}`]) {\r\n              this.deliverables[y][`responsible${x - 2}`] = \"\";\r\n            }\r\n          }\r\n        }\r\n\r\n        for (let z = 0; z < this.deliverables.length; z++) {\r\n          delete this.deliverables[z][`responsible${this.responsibles.length}`];\r\n        }\r\n        this.headers.splice(id, 1);\r\n        this.responsibles.splice(id - 3, 1);\r\n\r\n        for (let e = 0; e < this.responsibles.length; e++) {\r\n          this.responsibles[e].identity = `responsible${e + 1}`;\r\n          this.responsibles[e].text = `Responsible${e + 1}`;\r\n        }\r\n        let counter2 = 1;\r\n        for (let f = 3; f < this.responsibles.length + 3; f++) {\r\n          if (this.headers[f].text.includes(\"Responsible\")) {\r\n            this.headers[f].text = `Responsible${counter2}`;\r\n          }\r\n          this.headers[f].value = `responsible${counter2}`;\r\n          counter2++;\r\n        }\r\n\r\n        this.$store.dispatch(\"setHeaders\", this.headers);\r\n        this.$store.dispatch(\"setResponsibles\", this.responsibles);\r\n        this.$store.dispatch(\"setDeliverables\", this.deliverables);\r\n        this.toggleShowConformMessage();\r\n      }\r\n    },\r\n    toggleShowConformMessage() {\r\n      this.showConformMessage = !this.showConformMessage;\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusTable.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusTable.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./StatusTable.vue?vue&type=template&id=707f98d5\"\nimport script from \"./StatusTable.vue?vue&type=script&lang=js\"\nexport * from \"./StatusTable.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <v-app>\r\n    <v-main>\r\n      <StatusTable />\r\n    </v-main>\r\n  </v-app>\r\n</template>\r\n\r\n<script>\r\nimport StatusTable from \"./components/StatusTable\";\r\n\r\n\r\nexport default {\r\n  name: \"App\",\r\n  created() {\r\n    document.title = \"Earned Value\";\r\n  },\r\n\r\n  components: {\r\n    StatusTable\r\n  },\r\n\r\n  data: () => ({\r\n    drawer: false\r\n    //\r\n  })\r\n};\r\n</script>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=03518464\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"home\"},[_c('StatusTable')],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"home\">\r\n    <StatusTable />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// @ is an alias to /src\r\nimport StatusTable from \"@/components/StatusTable.vue\";\r\n\r\nexport default {\r\n  name: \"Home\",\r\n  components: {\r\n    StatusTable\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Home.vue?vue&type=template&id=ce6cee08\"\nimport script from \"./Home.vue?vue&type=script&lang=js\"\nexport * from \"./Home.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from \"vue\";\r\nimport VueRouter from \"vue-router\";\r\nimport Home from \"../views/Home.vue\";\r\n\r\nVue.use(VueRouter);\r\n\r\nconst routes = [\r\n  {\r\n    path: \"/\",\r\n    name: \"Home\",\r\n    component: Home\r\n  }\r\n];\r\n\r\nconst router = new VueRouter({\r\n  mode: \"history\",\r\n  base: process.env.BASE_URL,\r\n  routes\r\n});\r\n\r\nexport default router;\r\n","const state = {\r\n  headers: [\r\n    {\r\n      text: \"No\",\r\n      align: \"start\",\r\n      value: \"id\",\r\n      sortable: true,\r\n      editable: false,\r\n      headerEditable: false,\r\n      fixed: true,\r\n    },\r\n    { text: \"Description\", value: \"description\", editable: true, fixed: true, },\r\n    { text: \"Weight\", value: \"weight\", editable: true },\r\n    {\r\n      text: \"Step1\",\r\n      value: \"step1\",\r\n      sortable: false,\r\n      editable: true,\r\n      headerEditable: true,\r\n      // Added by MMG\r\n      columnDeleteIcon: false\r\n    },\r\n\r\n    { text: \"Fulfillment\", value: \"fulfillment\", editable: false },\r\n\r\n  ],\r\n  deliverables: [],\r\n  steps: [{ text: \"Step1\", identity: \"step1\" }],\r\n  responsibles: [],\r\n  nextColumnName: \"Step2\",\r\n  newRowCounter: 0,\r\n};\r\n\r\nconst mutations = {\r\n  incrementNewRowCounter(state) {\r\n    state.newRowCounter++;\r\n  },\r\n  SET_ROW_COUNTER_TO_ZERO(state, value) {\r\n    state.newRowCounter = value;\r\n  },\r\n  SET_HEADERS(state, headers) {\r\n    state.headers = headers;\r\n  },\r\n  SET_TABLE_STATE(state, deliverables) {\r\n    state.deliverables = deliverables;\r\n  },\r\n  SET_STEPS(state, steps) {\r\n    state.steps = steps;\r\n    state.nextStatusColumn = \"Step\" + (state.steps.length + 1);\r\n  },\r\n  SET_RESPONSIBLES(state, responsibles) {\r\n    state.responsibles = responsibles;\r\n  },\r\n  SET_NEXT_COLUMN_NAME(state, nextColumnName) {\r\n    state.nextColumnName = nextColumnName;\r\n  },\r\n  LOAD_DELIVERABLES(state, loadedArray) {\r\n    if (state.steps.length > 0) {\r\n      state.deliverables = loadedArray;\r\n    }\r\n  },\r\n};\r\n\r\nconst actions = {\r\n  incrementNewRowCounterAction({ commit }) {\r\n    commit('incrementNewRowCounter');\r\n  },\r\n  setRowCounterToZero({ commit }, value) {\r\n    commit('SET_ROW_COUNTER_TO_ZERO', value)\r\n  },\r\n  setHeaders: ({ commit }, headers) => {\r\n    commit(\"SET_HEADERS\", headers);\r\n  },\r\n  setDeliverables: ({ commit }, deliverables) => {\r\n    commit(\"SET_TABLE_STATE\", deliverables);\r\n  },\r\n  setSteps: ({ commit }, steps) => {\r\n    commit(\"SET_STEPS\", steps);\r\n  },\r\n  setResponsibles: ({ commit }, responsibles) => {\r\n    commit(\"SET_RESPONSIBLES\", responsibles);\r\n  },\r\n  setNextColumnName: ({ commit, state }, columnType) => {\r\n    let nextColumnName = \"Step\";\r\n    if (columnType === \"Status\") {\r\n      nextColumnName = \"Step\" + (state.steps.length + 1);\r\n    } else if (columnType === \"Responsible\") {\r\n      if (state.responsibles.length === 0) {\r\n        nextColumnName = \"Responsible\";\r\n      } else {\r\n        nextColumnName = \"Responsible\" + (state.steps.length + 1);\r\n      }\r\n    }\r\n    commit(\"SET_NEXT_COLUMN_NAME\", nextColumnName);\r\n  },\r\n  loadDeliverables: ({ commit }, loadedArray) => {\r\n    commit(\"LOAD_DELIVERABLES\", loadedArray);\r\n  }\r\n};\r\n\r\nconst getters = {\r\n  getNewRowCounter(state) {\r\n    return state.newRowCounter;\r\n  },\r\n  getNextColumnName: state => columnType => {\r\n    let nextColumnName = \"Step\";\r\n    if (columnType === \"Status\") {\r\n      nextColumnName = \"Step\" + (state.steps.length + 1);\r\n    } else if (columnType === \"Responsible\") {\r\n      if (state.responsibles.length === 0) {\r\n        nextColumnName = \"Responsible1\";\r\n      } else {\r\n        nextColumnName = \"Responsible\" + (state.responsibles.length + 1);\r\n      }\r\n    }\r\n    return nextColumnName; \r\n  },\r\n  headers: state => {\r\n    return state.headers;\r\n  },\r\n  deliverables: state => {\r\n    return state.deliverables;\r\n  },\r\n  steps: state => {\r\n    return state.steps;\r\n  },\r\n  responsibles: state => {\r\n    return state.responsibles;\r\n  },\r\n\r\n  stepsFulfillment: state => {\r\n\r\n    if (!state.steps || state.steps.length === 0) {\r\n      return {}; // or return some default value\r\n    }\r\n\r\n    let fulfillmentsObj = {};\r\n\r\n    state.steps.forEach(step => {\r\n      if (step) {\r\n        let totalWeights = 0;\r\n        let wipCount = 0;\r\n        let closedCount = 0;\r\n        state.deliverables.forEach(item => {\r\n\r\n          if (item && item.isChild == true) {\r\n            item.children.forEach((row) => {\r\n              if (row[step.identity] !== \"n.rel.\") {\r\n                totalWeights += +row.weight;\r\n              }\r\n              closedCount += row[step.identity] === \"closed\" ? 1 * row.weight : 0;\r\n              wipCount += row[step.identity] === \"wip\" ? 0.5 * row.weight : 0;\r\n            })\r\n          }\r\n          else {\r\n            if (item[step.identity] !== \"n.rel.\") {\r\n              totalWeights += +item.weight;\r\n            }\r\n            closedCount += item[step.identity] === \"closed\" ? 1 * item.weight : 0;\r\n            wipCount += item[step.identity] === \"wip\" ? 0.5 * item.weight : 0;\r\n          }\r\n        });\r\n\r\n        fulfillmentsObj[step.identity] =\r\n          ((closedCount + wipCount) / totalWeights) * 100;\r\n      }\r\n    });\r\n    // console.log('full fillment', fulfillmentsObj)\r\n    return fulfillmentsObj;\r\n  },\r\n\r\n  subProjectStepsFullFilment: state => {\r\n    if (!state.steps || state.steps.length === 0) {\r\n      return {}; // or return some default value\r\n    }\r\n\r\n    console.log('sub project steps full')\r\n\r\n    let fulfillmentsObj = {};\r\n\r\n    state.deliverables.forEach(item => {\r\n      if (item && item.isGrouped) {\r\n        fulfillmentsObj[item.id] = {};\r\n\r\n        state.steps.forEach(step => {\r\n          if (step) {\r\n            let totalWeights = 0;\r\n            let wipCount = 0;\r\n            let closedCount = 0;\r\n\r\n            item.children.forEach(row => {\r\n              if (row[step.identity] !== \"n.rel.\") {\r\n                totalWeights += +row.weight;\r\n              }\r\n              closedCount += row[step.identity] === \"closed\" ? 1 * row.weight : 0;\r\n              wipCount += row[step.identity] === \"wip\" ? 0.5 * row.weight : 0;\r\n            });\r\n\r\n            if (totalWeights === 0) {\r\n              // Set to 0% if all statuses are \"n.rel.\"\r\n              fulfillmentsObj[item.id][step.identity] = 0;\r\n            } else {\r\n              fulfillmentsObj[item.id][step.identity] =\r\n                ((closedCount + wipCount) / totalWeights) * 100;\r\n            }\r\n          }\r\n        });\r\n      }\r\n    });\r\n    return fulfillmentsObj;\r\n  },\r\n\r\n  totalFulfillment: state => {\r\n\r\n    if (state.steps.length === 0) {\r\n      return /* some default value or indication */;\r\n    }\r\n\r\n    let sumAll = 0;\r\n    let totalWeights = 0;\r\n    state.deliverables.forEach(item => {\r\n      if (item && item.isChild == true) {\r\n        item.children.forEach((row) => {\r\n          if (typeof row.fulfillment === \"number\") {\r\n            totalWeights += +row.weight;\r\n            sumAll += row.fulfillment * row.weight;\r\n          }\r\n        })\r\n      } else {\r\n        if (typeof item.fulfillment === \"number\") {\r\n          totalWeights += +item.weight;\r\n          sumAll += item.fulfillment * item.weight;\r\n        }\r\n      }\r\n    });\r\n\r\n    if (totalWeights === 0) {\r\n      return 0; // or return some default value\r\n    }\r\n\r\n    return sumAll / totalWeights;\r\n    // }\r\n  },\r\n\r\n  nextResponsibleIdentity: state => {\r\n    if (state.responsibles.length === 0) {\r\n      return \"responsible1\";\r\n    } else {\r\n      return \"responsible\" + (state.responsibles.length + 1);\r\n    }\r\n  }\r\n};\r\n\r\nexport default {\r\n  state,\r\n  mutations,\r\n  actions,\r\n  getters\r\n};\r\n","import Vue from \"vue\";\r\nimport Vuex from \"vuex\";\r\nimport createPersistedState from \"vuex-persistedstate\";\r\nimport statusTable from \"./modules/statusTable\";\r\n\r\nVue.use(Vuex);\r\n\r\nexport default new Vuex.Store({\r\n  state: {},\r\n  mutations: {},\r\n  actions: {},\r\n  modules: { statusTable },\r\n  plugins: [createPersistedState()]\r\n});\r\n","import Vue from \"vue\";\r\nimport Vuetify from \"vuetify/lib\";\r\n\r\nVue.use(Vuetify);\r\n\r\nexport default new Vuetify({});\r\n","import Vue from \"vue\";\r\nimport App from \"./App.vue\";\r\nimport router from \"./router\";\r\nimport store from \"./store\";\r\nimport vuetify from \"./plugins/vuetify\";\r\nimport './assets/styles/style.css';\r\n\r\n\r\nVue.config.productionTip = false;\r\n\r\nnew Vue({\r\n  router,\r\n  store,\r\n  vuetify,\r\n  render: h => h(App)\r\n}).$mount(\"#app\");\r\n\r\n\r\n"],"sourceRoot":""}