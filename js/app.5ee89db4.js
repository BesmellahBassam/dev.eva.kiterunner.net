(function(e){function t(t){for(var l,a,r=t[0],o=t[1],c=t[2],d=0,h=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&h.push(s[a][0]),s[a]=0;for(l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l]);u&&u(t);while(h.length)h.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],l=!0,r=1;r<n.length;r++){var o=n[r];0!==s[o]&&(l=!1)}l&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var l={},s={app:0},i=[];function a(t){if(l[t])return l[t].exports;var n=l[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=l,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)a.d(n,l,function(t){return e[t]}.bind(null,l));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=o;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0e46":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var l=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-main",[n("StatusTable")],1)],1)},i=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"containerRef",staticClass:"container-width"},[n("v-container",{attrs:{fluid:""}},[n("v-row",{staticClass:"text-center"},[n("v-col",{staticClass:"overflow-c",attrs:{cols:"12"}},[n("div",{ref:"tableRef"},[n("v-data-table",{staticClass:"elevation-1 zoom custom-data-table ",attrs:{headers:e.filteredHeaders,items:e.deliverables,"hide-default-header":"","hide-default-footer":"","sort-by":e.sortBy,"disable-pagination":"","sort-desc":e.sortDesc},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t}},scopedSlots:e._u([{key:"header",fn:function(t){var l=t.props.headers;return[n("thead",{staticClass:"v-data-table-header"},[n("tr",{ref:"headerRef"},e._l(l,(function(t){return n("th",{key:t.value,staticStyle:{border:"solid 0.5px",padding:"0px 0px"}},[n("span"),t.value.includes("step")?n("span",{staticStyle:{height:"100%"}},[n("linear-progress",{attrs:{color:"green",height:e.thHeight,value:e.stepsFulfillment[t.value]}},[e._v(" "+e._s(e.stepsFulfillment[t.value]?Math.round(e.stepsFulfillment[t.value]):0)+"% ")])],1):"fulfillment"===t.value?n("span",[n("linear-progress",{attrs:{value:null===e.totalFulfillment||isNaN(e.totalFulfillment)?0:e.totalFulfillment,color:"green",height:e.thHeight,reactive:"reactive",striped:"striped"}},[e._v(" "+e._s(null===e.totalFulfillment||isNaN(e.totalFulfillment)?"n.rel.":e.totalFulfillment+"%")+" ")])],1):n("div",{staticStyle:{color:"white"},on:{click:function(t){return e.toggleWidth()}}},[e._v(" ' ")])])})),0),n("tr",{staticClass:"secondTopRow"},e._l(l,(function(t,l){return n("th",{key:l,staticClass:"sortable",class:{active:e.sortBy===t.value,asc:!1===e.sortDesc},attrs:{id:"tableHeader",role:"columnheader",scope:"col","aria-label":t.text+": Sorted ascending. Activate to sort descending.","aria-sort":"ascending"}},[n("edit-dialog-table-header",{attrs:{header:t},on:{handleChangeHeader:e.changeHeader,handleInputChange:e.inputChanged,handleHeaderTextFileOpend:e.headerTextFieldOpen}}),t.headerEditable?n("span",{attrs:{id:"deleteIcon"},on:{click:function(t){return e.conformMessage("",l,"column")}}},[n("v-icon",{attrs:{small:""}},[e._v("mdi-delete")])],1):n("span",[n("span",{on:{click:function(n){return e.sortColumn(t.value)}}},[n("span",[e._v(e._s(t.text)+" ")]),n("span",[n("i",{staticClass:"v-icon notranslate v-data-table-header__icon mdi mdi-arrow-up theme--light",staticStyle:{"font-size":"18px",transition:"transform 0.25s linear"},style:{transform:"rotate("+e.rotateValues[t.value]+"deg)"},attrs:{"aria-hidden":"true"},on:{click:function(n){e.rotateValues[t.value]+=0===e.rotateValues[t.value]?-180:180}}})])])])],1)})),0)])]}},{key:"body",fn:function(t){var l=t.items,s=t.headers;return[n("tbody",[e._l(l,(function(t,l){return[n("tr",{ref:"rowRef",refInFor:!0},e._l(s,(function(s,i){return n("td",{key:"inner_"+i,class:{"expanded-td":e.expandedWidth},style:e.cellBackgroundStyle(t[s.value]),attrs:{title:e.expandedWidth?e.getTitle(t,s):""},on:{mouseover:function(e){t.showEditDialog=!0},mouseleave:function(n){return e.mouseLeave(t)}}},[s.editable?n("span",{class:{"left-justified":"description"===s.value||s.value.includes("responsible")}},[t.showEditDialog||t.isChild?n("span",[s.value.includes("step")?[t.isChild?n("span",[e._v(" "+e._s(e.subProjectStepsFullFilment[t.id]?Math.round(e.subProjectStepsFullFilment[t.id][s.value]):0)+"% ")]):n("span",{staticStyle:{cursor:"pointer"},on:{click:function(n){return e.handleSelectChange(t,s.value)}}},[e._v(" "+e._s(t[s.value])+" ")])]:[n("edit-dialog-table-body",{attrs:{item:t,header:s},on:{handleChangeCell:e.changeCell,handleClose1:e.close1,handleInputChanged:e.inputChanged,handleOpen:e.open}})]],2):n("span",[e._v(" "+e._s(t[s.value])+" ")])]):n("span",["fulfillment"===s.value?n("span",[n("linear-progress",{attrs:{value:"number"===typeof t[s.value]?t[s.value]:0,color:"green",height:e.tdHeight,reactive:"reactive",striped:"striped"}},[e._v(" "+e._s("number"===typeof t[s.value]?Math.round(t[s.value])+"%":"n.rel.")+" ")])],1):n("div",{class:{"deliverable--number":"id"===s.value,"selected-row":e.isSelected(t.id)},on:{click:function(n){return e.handleClick(n,l,t.id)}}},[e._v(" "+e._s(t[s.value])+" ")])])])})),0),t.children&&t.children.length>0?e._l(t.children,(function(t,i){return n("tr",{key:"child_"+l+"_"+i},e._l(s,(function(s,a){return n("td",{key:"inner_child_"+a,class:{"expanded-td":e.expandedWidth},style:e.cellBackgroundStyle(t[s.value]),attrs:{title:e.expandedWidth?e.getTitle(t,s):""},on:{mouseover:function(e){t.showEditDialog=!0},mouseleave:function(n){return e.mouseLeave(t)}}},[s.editable?n("span",{class:{"left-justified":"description"===s.value||s.value.includes("responsible")}},[t.showEditDialog?n("span",[s.value.includes("step")?[n("span",{staticStyle:{cursor:"pointer"},on:{click:function(n){return e.handleSelectChange(t,s.value)}}},[e._v(" "+e._s(t[s.value])+" ")])]:[n("edit-dialog-table-body",{attrs:{item:t,header:s},on:{handleChangeCell:e.changeCell,handleClose1:e.close1,handleInputChanged:e.inputChanged,handleOpen:e.open}})]],2):n("span",[e._v(e._s(t[s.value]))])]):n("span",["fulfillment"===s.value?n("span",[n("linear-progress",{attrs:{value:"number"===typeof t[s.value]?t[s.value]:0,color:"green",height:e.tdHeight,reactive:"reactive",striped:"striped"}},[e._v(" "+e._s("number"===typeof t[s.value]?Math.round(t[s.value])+"%":"n.rel.")+" ")])],1):n("div",{class:{"deliverable--number":"id"==s.value,"selected-row":e.isSelected(t.id)},staticStyle:{cursor:"pointer"},on:{click:function(n){return e.handleClick(n,i,t.id,l)}}},[e._v(" "+e._s(t[s.value])+" ")])])])})),0)})):e._e()]})),e.toolboxVisible?n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closetoolbox,expression:"closetoolbox"}],staticClass:"toolbox",style:{top:e.selectedRowTop+"px"}},[n("v-icon",{attrs:{small:""},on:{click:e.deleteRows}},[e._v("mdi-delete")]),n("v-icon",{attrs:{small:""},on:{click:e.createNewRowFromSelected}},[e._v("mdi-arrow-right")]),n("v-icon",{attrs:{small:""},on:{click:function(t){return t.stopPropagation(),e.ungroupSelectedChildren.apply(null,arguments)}}},[e._v("mdi-arrow-left")])],1):e._e()],2)]}},{key:"top",fn:function(){return[n("toolbar",{attrs:{showWeight:e.showWeight},on:{handleShowWeight:e.toggleWeight,handleUndelete:e.undoDelete}})]},proxy:!0}])})],1)])],1)],1),e.showConformMessage?n("div",[n("ConfirmMessage",{attrs:{message:e.message,pressedType:e.pressedType},on:{deleteRow:e.deleteRow,deleteStep:function(t){return e.deleteColumn("step")},deleteResponsible:function(t){return e.deleteColumn("responsible")},dontDelete:e.toggleShowConformMessage}})],1):e._e()],1)},r=[],o=n("2909"),c=n("5530"),u=(n("4de4"),n("d3b7"),n("4160"),n("159b"),n("4e827"),n("a434"),n("99af"),n("d81d"),n("7db0"),n("e25e"),n("caad"),n("2532"),n("c740"),n("c975"),n("4795"),n("a4d3"),n("e01a"),n("d4ec")),d=n("bee2"),h=function(){function e(){Object(u["a"])(this,e)}return Object(d["a"])(e,[{key:"calculateRowFulfillment",value:function(e,t){var n=t.length,l=0,s=0,i=0;t.forEach((function(t){l+="closed"===e[t.identity]?1:0,s+="wip"===e[t.identity]?.5:0,i+="n.rel."===e[t.identity]?1:0}));var a,r=n-i;a=i===n?"n.rel.":(l+s)/r*100,e.fulfillment=a}},{key:"recalculateAllFulfillments",value:function(e,t){var n=this;e.forEach((function(e){n.calculateRowFulfillment(e,t)}))}}]),e}(),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"backdrop",on:{click:function(t){return t.target!==t.currentTarget?null:e.closePopup("cancel")}}},[n("div",{staticClass:"popup"},[n("h3",[e._v(e._s(e.message))]),n("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){return e.closePopup("cancel")}}},[e._v("Cancel")]),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){return e.closePopup("yes")}}},[e._v("Yes")])],1)])},f=[],v={props:["message","pressedType"],methods:{closePopup:function(e){"cancel"===e?this.$emit("dontDelete"):"yes"===e&&("Row"===this.pressedType?this.$emit("deleteRow"):"step"===this.pressedType?this.$emit("deleteStep"):"responsible"===this.pressedType&&this.$emit("deleteResponsible"))}}},g=v,b=n("2877"),m=n("6544"),w=n.n(m),C=n("8336"),x=Object(b["a"])(g,p,f,!1,null,null,null),y=x.exports;w()(x,{VBtn:C["a"]});var F=n("2f62"),S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-progress-linear",{attrs:{value:e.value,color:e.color,height:e.height,reactive:"",striped:""}},[e._t("default")],2)},R=[],E={props:["value","color","height","reactive","striped"]},_=E,T=n("8e36"),O=Object(b["a"])(_,S,R,!1,null,null,null),I=O.exports;w()(O,{VProgressLinear:T["a"]});var k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-edit-dialog",{on:{close:function(t){return e.close1(e.item)},cancel:e.cancel,open:function(t){return e.open(e.item[e.header.value])},save:function(t){return e.changeCell(e.item,e.header.value)}},scopedSlots:e._u([{key:"input",fn:function(){return[n("span",["Weight"===e.header.text?n("v-text-field",{attrs:{type:"number",rules:[e.rules.required,e.rules.positiveNumbers],value:e.item[e.header.value],label:"Edit","single-line":""},on:{focus:function(e){return e.target.select()},change:function(t){return e.inputChanged(t,"weight")}}}):n("v-text-field",{attrs:{value:e.item[e.header.value],label:"Edit","single-line":""},on:{focus:function(e){return e.target.select()},change:function(t){return e.inputChanged(t)}}})],1)]},proxy:!0}])},[e._v(" "+e._s(e.item[e.header.value])+" ")])},D=[],N={props:["header","item"],data:function(){return{rules:{counter:function(e){return e.length<=20||"Max 20 characters"},required:function(e){return!!e||"Required."},positiveNumbers:function(e){return e>0||"Should be greater than 0"},alreadyExist:!0}}},emits:["handleClose1","handleOpen","handleChangeCell","handleInputChanged"],methods:{close:function(){},cancel:function(){},close1:function(e){this.$emit("handleClose1",e)},open:function(e){this.$emit("handleOpen",e)},changeCell:function(e,t){this.$emit("handleChangeCell",e,t)},inputChanged:function(e,t){this.$emit("handleInputChanged",e,t)}}},j=N,$=n("7679"),M=n("8654"),W=Object(b["a"])(j,k,D,!1,null,null,null),V=W.exports;w()(W,{VEditDialog:$["a"],VTextField:M["a"]});var A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-toolbar",{staticClass:"mb-0 mt-0",attrs:{height:"32",flat:"",color:"white"}},[n("v-toolbar-title",[e._v("Tasks")]),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),n("v-btn",{staticClass:"mb-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.generateExcel}},[e._v("Generate Excel")]),n("v-btn",{staticClass:"mb-2 ml-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.adjustSize}},[e._v(e._s(e.adjustText))]),n("v-btn",{staticClass:"mb-2 ml-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.addRow}},[e._v("Add Row")]),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),n("v-file-input",{attrs:{dense:"",placeholder:"Load excel file",label:"File input","prepend-icon":"mdi-paperclip","show-size":""},on:{change:e.loadExcel},scopedSlots:e._u([{key:"selection",fn:function(t){var l=t.text;return[n("v-chip",{attrs:{small:"",label:"",color:"primary"}},[e._v(e._s(l))])]}}]),model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),n("v-spacer"),n("v-btn",{staticClass:"mr-2 mb-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.undoDelete}},[e._v(" UNDELETE ")]),n("v-btn",{staticClass:"mb-2",attrs:{"x-small":"",color:"primary",dark:""},on:{click:e.toggleWeight}},[e._v(e._s(e.showWeight))]),n("AddColumn")],1)},H=[],B=n("1da1"),U=(n("96cf"),n("a15b"),n("acd8"),n("ddb0"),n("45fc"),n("e8ae")),P=n.n(U),L=n("21a6"),q="closed",z="wip",G="open",Z="n.rel.",J=function(){function e(t,n,l,s,i){Object(u["a"])(this,e),this.deliverables=t,this.steps=n,this.responsibles=l,this.stepsFulfillment=s,this.totalFulfillment=i}return Object(d["a"])(e,[{key:"saveAsExcel",value:function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(t){var n,l,s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new P.a.Workbook,l=n.addWorksheet("TestSheet"),this.calculateFirstRow(l,t.steps,t.responsibles,t.stepsFulfillment,t.totalFulfillment),s=this.formTableRows(l,t),this.addFormattingFulfillmentsColumns(l,t,s),this.addFormattingFirstRow(l,t),this.addStepDropDownAndColor(l,t,s),this.addfulfillmentFormula(l,t),this.addFirstRowFormula(l,t,s),this.addChildRowStepsFormula(l,t),i=[],t.headers.forEach((function(e){i.push({name:e.text,filterButton:!0})})),l.addTable({name:"MyTable",ref:"A2",headerRow:!0,style:{showRowStripes:!0},columns:i,rows:s}),e.next=15,n.xlsx.writeBuffer();case 15:a=e.sent,Object(L["saveAs"])(new Blob([a]),"Tasks.xlsx");case 17:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"calculateFirstRow",value:function(e,t,n,l,s){for(var i=[],a=0;a<n.length;a++)i.push("");var r=[];t.forEach((function(e){r.push(l[e.identity]/100)}));var o=["","",""].concat(i,r,[s/100]);console.log("first row",o),e.addRow(o)}},{key:"addFormattingFirstRow",value:function(e,t){var n=3+t.responsibles.length,l=e._columns[n].letter,s=e._columns[n+t.steps.length].letter;e.addConditionalFormatting({ref:"".concat(l,"1:").concat(s,"1"),rules:[{type:"dataBar",color:{argb:"C6EFCE"},gradient:!1,cfvo:[{type:"num",value:0},{type:"num",value:1}],style:{font:{color:{argb:"006100"}}}}]});for(var i=n;i<=n+t.steps.length;i++){var a=e._columns[i].letter;this.addNumberFormatting(e,a+"1")}}},{key:"addFormattingChildRows",value:function(e,t){e.addConditionalFormatting({ref:"".concat(t),rules:[{type:"dataBar",color:{argb:"C6EFCE"},gradient:!1,cfvo:[{type:"num",value:0},{type:"num",value:1}],style:{font:{color:{argb:"006100"}}}}]}),this.addNumberFormatting(e,t)}},{key:"addFirstRowFormula",value:function(e,t,n){for(var l=3+t.responsibles.length,s=l+t.steps.length,i=e._columns[2].letter,a=l;a<=s;a++)for(var r=e._columns[a].letter,o=r+"1",c=[],u=3,d=[],h=0,p=1;p<=t.deliverables.length;p++){var f=t.deliverables[p-1];if(f&&1==f.isChild){var v=f.children.length;console.log("run child parts"),h+=1,c.push("".concat(i).concat(u));for(var g=1;g<=v;g++)d.push("(\n              IF(ISNUMBER(".concat(r).concat(u+g,"), ").concat(r).concat(u+g,", \n                IF(").concat(r).concat(u+g,'="').concat(q,'", 1, \n                  IF(').concat(r).concat(u+g,'="').concat(z,'", 0.5, \n                    IF(').concat(r).concat(u+g,'="').concat(G,'", 0, \n                      IF(').concat(r).concat(u+g,'="').concat(Z,'", 0, 0)\n                    )\n                  )\n                )\n              ) * ').concat(i).concat(u+g,"\n            )"));u+=v+1}else d.push("(\n            IF(ISNUMBER(".concat(r).concat(u,"), ").concat(r).concat(u,", \n              IF(").concat(r).concat(u,'="').concat(q,'", 1, \n                IF(').concat(r).concat(u,'="').concat(z,'", 0.5, \n                  IF(').concat(r).concat(u,'="').concat(G,'", 0, \n                    IF(').concat(r).concat(u,'="').concat(Z,'", 0, 0)\n                  )\n                )\n              )\n            ) * ').concat(i).concat(u,"\n          )")),u+=1;var b="COUNTIF(".concat(r,3,":").concat(r).concat(2+n.length,', "n.rel.")');e.getCell(o).value={formula:b};c.map((function(e){return"IF(".concat(e," > 0, ").concat(e,", 0)")}));console.log("excludes weights cells",c);var m="=IF(".concat(b," = ").concat(n.length-h,', "n.rel.", \n              IFERROR(SUM(').concat(d.join(", "),'), "") / \n                (SUM(').concat(i,3,":").concat(i).concat(2+n.length,") - \n                SUMIF(").concat(r,3,":").concat(r).concat(2+n.length,',\n                  "n.rel.", ').concat(i,3,":").concat(i).concat(2+n.length,") \n                      - SUM(").concat(c.length>0?c:0,")\n                  ))");e.getCell(o).value={formula:m}}}},{key:"addFirstRowFormula2",value:function(e,t,n){var l=3+t.responsibles.length,s=l+t.steps.length,i=e._columns[2].letter,a=t.deliverables.length+2;console.log("delver leng",t.deliverables);for(var r=l;r<=s;r++){var o=e._columns[r].letter,c=o+"1",u=3,d=(e.getCell(i+u).value,"=IFERROR((COUNTIF(".concat(o).concat(u,":").concat(o).concat(a,',"').concat(q,'") \n          +COUNTIF(').concat(o).concat(u,":").concat(o).concat(a,',"').concat(z,'")* 0.5) / \n          (COUNTIF(').concat(o).concat(u,":").concat(o).concat(a,',"').concat(G,'") \n          +COUNTIF(').concat(o).concat(u,":").concat(o).concat(a,',"').concat(z,'") \n          +COUNTIF(').concat(o).concat(u,":").concat(o).concat(a,',"').concat(q,'")) ,"').concat(Z,'")'));e.getCell(c).value={formula:d}}}},{key:"addFirstRowFormula3",value:function(e,t,n){for(var l=3+t.responsibles.length,s=l+t.steps.length,i=e._columns[2].letter,a=(t.deliverables.length,l);a<=s;a++){var r=e._columns[a].letter,o=r+"1",c=3,u=c+n.length-1,d="=IFERROR(\n        SUMPRODUCT(\n          (((".concat(r).concat(c,":").concat(r).concat(u,' = "').concat(q,'") +\n            (').concat(r).concat(c,":").concat(r).concat(u,' = "').concat(z,'") * 0.5) *\n            (').concat(i).concat(c,":").concat(i).concat(u,")) *\n            ((").concat(r).concat(c,":").concat(r).concat(u,' <> "').concat(Z,'") * 1)\n        ) /\n        SUMIFS(\n          ').concat(i).concat(c,":").concat(i).concat(u,",\n          ").concat(r).concat(c,":").concat(r).concat(u,',\n          "<> ').concat(Z,'"\n        ),\n        "').concat(Z,'"\n      )');e.getCell(o).value={formula:d}}}},{key:"addChildRowStepsFormula",value:function(e,t){for(var n=3+t.responsibles.length,l=n+t.steps.length,s=e._columns[2].letter,i=n;i<=l;i++)for(var a=e._columns[i].letter,r=3,o=1;o<=t.deliverables.length;o++){var c=t.deliverables[o-1],u=[],d=void 0,h=a+"".concat(r);if(c&&1==c.isChild){this.addFormattingChildRows(e,h),d=c.children.length;for(var p=1;p<=d;p++)u.push("(\n              IF(ISNUMBER(".concat(a).concat(r+p,"), ").concat(a).concat(r+p,", \n                IF(").concat(a).concat(r+p,'="').concat(q,'", 1, \n                  IF(').concat(a).concat(r+p,'="').concat(z,'", 0.5, \n                    IF(').concat(a).concat(r+p,'="').concat(G,'", 0, \n                      IF(').concat(a).concat(r+p,'="').concat(Z,'", 0, 0)\n                    )\n                  )\n                )\n              ) * ').concat(s).concat(r+p,"\n            )"));var f="COUNTIF(".concat(a).concat(r+1,":").concat(a).concat(r+d,', "n.rel.")'),v="=IF(".concat(f," = ").concat(d,', "n.rel.", \n            IFERROR(SUM(').concat(u.join(", "),'), "") / \n              (SUM(').concat(s).concat(r+1,":").concat(s).concat(r+d,") - \n              SUMIF(").concat(a).concat(r+1,":").concat(a).concat(r+d,',\n                "n.rel.", ').concat(s).concat(r+1,":").concat(s).concat(r+d,")))");e.getCell(h).value={formula:v},console.log("child row cell formula and the cell is ".concat(h),e.getCell(h).value),r+=d+1}}}},{key:"addDropDownAndColor",value:function(e,t){e.getCell(t).dataValidation={type:"list",allowBlank:!0,formulae:['"'.concat(G,",").concat(z,",").concat(q,",").concat(Z,'"')]},this.addColorFormatting(e,t)}},{key:"addStepDropDownAndColor",value:function(e,t,n){for(var l=3+t.responsibles.length,s=l+t.steps.length-1,i=l;i<=s;i++)for(var a=3,r=e._columns[i].letter,o=1;o<=t.deliverables.length;o++){var c=void 0,u=t.deliverables[o-1];if(u&&1==u.isChild){a+=1;for(var d=1;d<u.children.length;d++)c="".concat(r).concat(a),this.addDropDownAndColor(e,c),a+=1}c="".concat(r).concat(a),this.addDropDownAndColor(e,c),a+=1}}},{key:"addFormattingFulfillmentsColumns",value:function(e,t,n){var l=3+t.responsibles.length+t.steps.length,s=e._columns[l].letter;e.addConditionalFormatting({ref:"".concat(s,3,":").concat(s).concat(n.length+2),rules:[{type:"dataBar",color:{argb:"C6EFCE"},gradient:!1,cfvo:[{type:"num",value:0},{type:"num",value:1}],style:{font:{color:{argb:"006100"}}}}]});for(var i=1;i<=n.length;i++)this.addNumberFormatting(e,s+(i+2))}},{key:"addfulfillmentFormulaHelper",value:function(e,t,n){var l="=IFERROR((COUNTIF(".concat(e).concat(n,":").concat(t).concat(n,',"').concat(q,'") \n          +COUNTIF(').concat(e).concat(n,":").concat(t).concat(n,',"').concat(z,'")* 0.5) / \n          (COUNTIF(').concat(e).concat(n,":").concat(t).concat(n,',"').concat(G,'") \n          +COUNTIF(').concat(e).concat(n,":").concat(t).concat(n,',"').concat(z,'") \n          +COUNTIF(').concat(e).concat(n,":").concat(t).concat(n,',"').concat(q,'")) ,"').concat(Z,'")');return l}},{key:"addfulfillmentFormula",value:function(e,t){for(var n=3+t.responsibles.length+t.steps.length,l=e._columns[n].letter,s=3+t.responsibles.length,i=3,a=e._columns[s].letter,r=e._columns[s+t.steps.length-1].letter,o=1;o<=t.deliverables.length;o++){var c=t.deliverables[o-1],u=void 0;if(c&&!0===c.isChild){u=c.children.length;for(var d=1;d<=u;d++){var h=this.addfulfillmentFormulaHelper(a,r,i+d),p="".concat(l).concat(i+d);e.getCell(p).value={formula:h}}i+=u+1}else{var f=this.addfulfillmentFormulaHelper(a,r,i),v="".concat(l).concat(i);e.getCell(v).value={formula:f},i+=1}}}},{key:"addNumberFormatting",value:function(e,t){e.getCell(t).numFmt="0%"}},{key:"formTableRows",value:function(e,t){var n=[];return t.deliverables.forEach((function(e,l){var s=[];if(e.isChild){var i=[];t.responsibles.forEach((function(t){i.push(e[t.identity])})),console.log("responsible rows",i);var a=[e.id,e.description,e.weight].concat(i);n.push(a),e.children.forEach((function(e,l){var s=[];s.push(e.id),s.push(e.description),s.push(parseFloat(e.weight)),t.responsibles.forEach((function(t){s.push(e[t.identity])})),t.steps.forEach((function(t){s.push(e[t.identity])})),n.push(s)}))}else s.push(e.id),s.push(e.description),s.push(parseFloat(e.weight)),t.responsibles.forEach((function(t){s.push(e[t.identity])})),t.steps.forEach((function(t){s.push(e[t.identity])})),n.push(s)})),n}},{key:"addColorFormatting",value:function(e,t){e.addConditionalFormatting({ref:t,rules:[{type:"cellIs",operator:"equal",color:{argb:"FF00FF00"},formulae:['"'.concat(q,'"')],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:"C6EFCE"}},font:{color:{argb:"006100"}}}}]}),e.addConditionalFormatting({ref:t,rules:[{type:"cellIs",operator:"equal",color:{argb:"FF00FF00"},formulae:['"'.concat(G,'"')],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:"FFC7CE"}},font:{color:{argb:"9C0006"}}}}]}),e.addConditionalFormatting({ref:t,rules:[{type:"cellIs",operator:"equal",color:{argb:"FF00FF00"},formulae:['"'.concat(z,'"')],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:"FFEB9C"}},font:{color:{argb:"9C6500"}}}}]}),e.addConditionalFormatting({ref:t,rules:[{type:"cellIs",operator:"equal",color:{argb:"FF00FF00"},formulae:['"'.concat(Z,'"')],style:{fill:{type:"pattern",pattern:"solid",bgColor:{argb:""}}}}]})}},{key:"loadExcel",value:function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(t){var n,l,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[],l=new P.a.Workbook,s=new FileReader,s.readAsArrayBuffer(t.file),e.abrupt("return",new Promise((function(e){s.onload=Object(B["a"])(regeneratorRuntime.mark((function t(){var i,a,r,o,c,u,d,h,p,f,v,g,b,m,w,C,x,y,F;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=s.result,t.next=3,l.xlsx.load(i);case 3:if(a=t.sent,r=a.getWorksheet(1),o=4,c=0,u=0,d=0,h=3,r.eachRow((function(e,t){if(!(t<2)){var l=e.values;if(l.shift(),2!=t){3==t&&(l.some((function(e,t){if(e=="".concat(G)||e=="".concat(z)||e=="".concat(q)||e=="".concat(Z))return o=t+1,!0})),o-h!=1&&(u=h+1,d=o-1),c=l.length-1);var s={id:e.getCell(1).value,description:e.getCell(2).value,weight:e.getCell(3).value,showEditDialog:!1},i=1;if(0!=u)for(var a=u;a<=d;a++)1==i?s["responsible"]=e.getCell(a).value:s["responsible"+i]=e.getCell(a).value,i++;i=1;for(var r=o;r<=c;r++)s["step"+i]=e.getCell(r).value,i++;s["fulfillment"]=e.getCell(l.length).value,n.push(s)}else p=l}})),f=[],v=1,0!=u)for(g=u;g<=d;g++)1==v?f.push({text:p[g-1],identity:"responsible"}):f.push({text:p[g-1],identity:"responsible".concat(v)}),v++;for(b=[],m=1,w=o;w<=c;w++)b.push({text:p[w-1],identity:"step".concat(m)}),m++;if(C=[{text:"No",align:"start",value:"id",sortable:!0,editable:!1,headerEditable:!1},{text:"Description",value:"description",editable:!0},{text:"Weight",value:"weight",editable:!0},{text:"Fulfillment",value:"fulfillment",editable:!1}],v=1,f.length>0)for(x=u;x<=d;x++)1==v?C.splice(x-1,0,{text:"".concat(p[x-1]),value:"responsible",editable:!0,sortable:!1,headerEditable:!0}):C.splice(x-1,0,{text:"".concat(p[x-1]),value:"responsible".concat(v),editable:!0,sortable:!1,headerEditable:!0}),v++;for(m=1,y=o;y<=c;y++)C.splice(y-1,0,{text:"".concat(p[y-1]),value:"step".concat(m),editable:!0,sortable:!1,headerEditable:!0}),m++;F={deliverables:n,responsibles:f,steps:b,headers:C},e(F);case 24:case"end":return t.stop()}}),t)})))})).then((function(e){return e})));case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-btn",{staticClass:"mx-2 mb-2",attrs:{"x-small":"",dark:"",color:"primary"},on:{click:function(t){return e.addColumn("Status")}}},[e._v("ADD STATUS COLUMN")]),n("v-btn",{staticClass:"mx-2 mb-2",attrs:{"x-small":"",dark:"",color:"primary"},on:{click:function(t){return e.addColumn("Responsible")}}},[e._v("ADD RESPONSIBLE COLUMN")])],1)},X=[],Y={data:function(){var e=this;return{stepOffset:3,nextColumnName:this.getNextColumnName("Status"),rules:{counter:function(e){return e.length<=20||"Max 20 characters"},required:function(e){return!!e||"Required."},alreadyExist:function(t){return!e.headers.find((function(e){return t.toLowerCase()===e.text.toLowerCase()}))||"Column name already exist"}}}},methods:{getNextColumnName:function(e){return this.$store.getters.getNextColumnName(e)},addColumn:function(e){this.nextColumnName=this.getNextColumnName(e),!0===this.rules.required(this.nextColumnName)&&!0===this.rules.alreadyExist(this.nextColumnName)&&("Status"===e?this.addStatusColumn():this.addResponsibleColumn(),this.$store.dispatch("setHeaders",this.headers),this.$store.dispatch("setDeliverables",this.deliverables),this.$store.dispatch("setNextColumnName",e))},addStatusColumn:function(){var e=this,t=this.steps.length,n=this.nextColumnName,l="step".concat(t+1);this.headers.splice(this.headers.length-1,0,{text:n,value:l,editable:!0,sortable:!1,headerEditable:!0,columnDeleteIcon:!1}),this.steps.push({text:n,identity:l}),this.deliverables.forEach((function(t){t.isGrouped?t.children.map((function(t){e.$set(t,l,"open")})):e.$set(t,l,"open")}));var s=new h;s.recalculateAllFulfillments(this.deliverables,this.steps),this.$store.dispatch("setSteps",this.steps)},addResponsibleColumn:function(){var e=this.responsibles.length,t=this.nextColumnName,n=this.$store.getters.nextResponsibleIdentity;this.headers.splice(e+this.stepOffset,0,{text:t,value:n,editable:!0,sortable:!1,headerEditable:!0,columnDeleteIcon:!1}),this.responsibles.push({text:t,identity:n}),this.$store.dispatch("setResponsibles",this.responsibles)}},computed:Object(c["a"])(Object(c["a"])({},Object(F["b"])(["statusTable"])),{},{headers:function(){return this.statusTable.headers},deliverables:function(){return this.statusTable.deliverables},responsibles:function(){return this.statusTable.responsibles},steps:function(){return this.statusTable.steps}})},Q=Y,ee=Object(b["a"])(Q,K,X,!1,null,null,null),te=ee.exports;w()(ee,{VBtn:C["a"]});var ne=new h,le={props:["showWeight"],emits:["handleShowWeight","handleUndelete"],data:function(){return{horizontalAdjusted:!1,adjustText:"Fit On Page",heightScale:0,widthScale:0,file:null}},components:{AddColumn:te},computed:Object(c["a"])(Object(c["a"])({stepsFulfillment:function(){return this.$store.getters.stepsFulfillment}},Object(F["b"])(["statusTable"])),{},{headers:function(){return this.statusTable.headers},filteredHeaders:function(){var e=this;return this.statusTable.headers.filter((function(t){return"Show Weight"!==e.showWeight||"weight"!==t.value}))},deliverables:function(){return this.statusTable.deliverables},responsibles:function(){return this.statusTable.responsibles},steps:function(){return this.statusTable.steps},totalFulfillment:function(){return Math.round(this.$store.getters.totalFulfillment)}}),methods:{generateExcel:function(){var e=new J(this.deliverables,this.steps,this.responsibles,this.stepsFulfillment,this.totalFulfillment),t={deliverables:this.deliverables,headers:this.headers,steps:this.steps,responsibles:this.responsibles,stepsFulfillment:this.stepsFulfillment,totalFulfillment:this.totalFulfillment};e.saveAsExcel(t)},adjustSize:function(){var e=document.getElementsByTagName("table")[0],t=document.getElementsByClassName("v-data-table__wrapper")[0];if("Normal Size"===this.adjustText)this.horizontalAdjusted||(t.style.width=t.clientWidth*this.heightScale+"px"),e.style.transform="scale(1)",this.adjustText="Fit On Page";else{var n=t.clientWidth,l=t.clientHeight,s=t.scrollWidth,i=t.scrollHeight;this.widthScale=n/s,this.heightScale=l/i,this.widthScale<this.heightScale?(e.style.transform="scale(".concat(this.widthScale,")"),this.horizontalAdjusted=!0):(e.style.transform="scale(".concat(this.heightScale,")"),t.style.width=t.clientWidth/this.heightScale+"px",this.horizontalAdjusted=!1),this.adjustText="Normal Size"}},addRow:function(){var e=1,t=this.deliverables.length;0!==t&&(e=this.deliverables[t-1].id+1);var n={id:e,description:"",responsible:"",weight:1,fulfillment:0,showEditDialog:!1};this.steps.forEach((function(e){var t=e.identity;n[t]="open"})),this.deliverables.push(n),this.$store.dispatch("setDeliverables",this.deliverables)},loadExcel:function(){var e=this;return Object(B["a"])(regeneratorRuntime.mark((function t(){var n,l,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.file){t.next=12;break}return n=new J(e.deliverables,e.steps,e.responsibles,e.stepsFulfillment,e.totalFulfillment),l={file:e.file,deliverables:e.deliverables,headers:e.headers,steps:e.steps,responsibles:e.responsibles,stepsFulfillment:e.stepsFulfillment,totalFulfillment:e.totalFulfillment},t.next=5,n.loadExcel(l);case 5:s=t.sent,ne.recalculateAllFulfillments(s.deliverables,s.steps),e.$store.dispatch("setDeliverables",s.deliverables),e.$store.dispatch("setSteps",s.steps),e.$store.dispatch("setResponsibles",s.responsibles),e.$store.dispatch("setHeaders",s.headers),e.$store.dispatch("setRowCounterToZero",0);case 12:case"end":return t.stop()}}),t)})))()},toggleWeight:function(){this.$emit("handleShowWeight")},undoDelete:function(){this.$emit("handleUndelete")}}},se=le,ie=n("cc20"),ae=n("ce7e"),re=n("23a7"),oe=n("2fa4"),ce=n("71d9"),ue=n("2a7f"),de=Object(b["a"])(se,A,H,!1,null,null,null),he=de.exports;w()(de,{VBtn:C["a"],VChip:ie["a"],VDivider:ae["a"],VFileInput:re["a"],VSpacer:oe["a"],VToolbar:ce["a"],VToolbarTitle:ue["a"]});var pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.header.headerEditable?n("v-edit-dialog",{on:{open:function(t){return e.headerTextFieldOpen(e.header.text)},save:function(t){return e.changeHeader(e.header)}},scopedSlots:e._u([{key:"input",fn:function(){return[n("v-text-field",{attrs:{value:e.header.text,rules:[e.rules.required,e.rules.alreadyExist],counter:"",maxlength:"20",label:"Edit","single-line":""},on:{focus:function(e){return e.target.select()},change:function(t){return e.inputChanged(t)}}})]},proxy:!0}],null,!1,1862401062)},[n("span",[n("span",[e._v(" "+e._s(e.header.text)+" ")])])]):e._e()},fe=[],ve={props:["header"],emits:["handleHeaderTextFileOpend","handleChangeHeader","handleInputChange"],data:function(){return{rules:{counter:function(e){return e.length<=20||"Max 20 characters"},required:function(e){return!!e||"Required."},positiveNumbers:function(e){return e>0||"Should be greater than 0"},alreadyExist:!0}}},methods:{headerTextFieldOpen:function(e){this.$emit("handleHeaderTextFileOpend",e)},changeHeader:function(e){this.$emit("handleChangeHeader",e)},inputChanged:function(e,t){this.$emit("handleInputChange",e,t)}}},ge=ve,be=Object(b["a"])(ge,pe,fe,!1,null,null,null),me=be.exports;w()(be,{VEditDialog:$["a"],VTextField:M["a"]});var we=new h,Ce={name:"HelloWorld",components:{ConfirmMessage:y,LinearProgress:I,EditDialogTableHeader:me,EditDialogTableBody:V,Toolbar:he},data:function(){return{index:-1,selectedRowTop:0,selectedRows:[],selectedRow:null,isRangeSelected:!1,deletedRows:[],deletedRowsStack:[],isShiftPressed:!1,toolboxVisible:!1,expandedWidth:!0,isDialogOpen:!1,showEditDialog:!0,selectItems:["open","wip","closed","n.rel."],rotateValues:{id:0,description:0,weight:0,fulfillment:0},sortBy:"id",sortDesc:!1,file:null,inputValue:"",showWeight:"Show Weight",max20chars:function(e){return e.length<=20||"Maximum 20 character allowed"},rules:{counter:function(e){return e.length<=20||"Max 20 characters"},required:function(e){return!!e||"Required."},positiveNumbers:function(e){return e>0||"Should be greater than 0"},alreadyExist:!0},adjustText:"Fit On Page",heightScale:0,widthScale:0,horizontalAdjusted:!1,thHeight:16,thWidth:0,tdHeight:16,headerEditValue:"",defaultItem:{id:"",description:"",oneWeekBefore:"",untilDayBefore:"",fulfillment:0},stepOffset:3,showDeleteIcon:!1,columnDeleteIcon:!1,message:"The Message",pressedId:"",pressedType:"",showConformMessage:!1,activeChildIndex:null}},computed:Object(c["a"])(Object(c["a"])({stepsFulfillment:function(){return this.$store.getters.stepsFulfillment},subProjectStepsFullFilment:function(){return this.$store.getters.subProjectStepsFullFilment}},Object(F["b"])(["statusTable"])),{},{headers:function(){return this.statusTable.headers},filteredHeaders:function(){var e=this;return this.statusTable.headers.filter((function(t){return"Show Weight"!==e.showWeight||"weight"!==t.value}))},deliverables:function(){return this.statusTable.deliverables},responsibles:function(){return this.statusTable.responsibles},steps:function(){return this.statusTable.steps},totalFulfillment:function(){return Math.round(this.$store.getters.totalFulfillment)}}),mounted:function(){console.log("deliverales",this.deliverables),console.log("headers",this.headers),this.$nextTick((function(){this.$refs.headerRef&&(this.thHeight=this.$refs.headerRef.clientHeight),this.thWidth=this.$refs.headerRef.clientWidth,this.$refs.rowRef&&(this.tdHeight=this.$refs.rowRef[0].clientHeight);var e=document.getElementsByClassName("v-toolbar__content")[0].clientHeight,t=document.getElementsByClassName("overflow-c")[0].clientHeight,n=document.getElementsByClassName("v-data-table__wrapper")[0];n.style.maxHeight=t-e+"px"}))},watch:{dialog:function(e){e||this.close()}},methods:{ungroupSelectedChildren:function(){var e=this,t=[];this.selectedRows.forEach((function(n){var l=e.findParentIndex(n);if(-1!==l){var s=e.findChildIndex(l,n);-1!==s&&t.push({parentIdx:l,childIdx:s})}})),t.sort((function(e,t){return t.parentIdx-e.parentIdx||t.childIdx-e.childIdx})),t.forEach((function(t){var n=t.parentIdx,l=t.childIdx;e.ungroupChild(n,l)})),this.selectedRows=[],this.$store.dispatch("setDeliverables",this.deliverables),we.recalculateAllFulfillments(this.deliverables,this.steps)},ungroupChild:function(e,t){var n=this.deliverables[e],l=n.children[t];n.children.splice(t,1),this.deliverables.splice(e+1,0,l),0===n.children.length&&this.deliverables.splice(e,1),this.recalculateNumbering()},findParentIndex:function(e){for(var t=0;t<this.deliverables.length;t++)if(this.deliverables[t].children)for(var n=0;n<this.deliverables[t].children.length;n++)if(this.deliverables[t].children[n].id===e)return t;return-1},findChildIndex:function(e,t){for(var n=this.deliverables[e],l=0;l<n.children.length;l++)if(n.children[l].id===t)return l;return-1},recalculateNumbering:function(){this.deliverables.forEach((function(e,t){e.id=t+1,e.children&&e.children.length>0&&e.children.forEach((function(t,n){t.id="".concat(e.id,".").concat(n+1)}))}))},closetoolbox:function(e){e.target.classList.contains("deliverable--number")||(this.toolboxVisible=!1,this.index=-1,this.selectedRows=[])},include:function(){return[document.querySelector(".deliverable--number")]},renumberDeliverables:function(e){return e.map((function(e,t){if(!e.isGrouped)return Object(c["a"])(Object(c["a"])({},e),{},{id:t+1});var n=Object(c["a"])(Object(c["a"])({},e),{},{id:t+1});return n.children&&n.children.length>0&&(n.children=n.children.map((function(e,t){return Object(c["a"])(Object(c["a"])({},e),{},{id:"".concat(n.id,".").concat(t+1)})}))),n}))},createNewRowFromSelected:function(){var e=this;if(this.selectedRows.length>0){var t={description:"Subproject",fulfillment:0,id:Math.min.apply(Math,Object(o["a"])(this.selectedRows)),responsible:"",showEditDialog:!1,weight:0,isChild:!0,children:[],isGrouped:!0},n=0;t.children=this.selectedRows.map((function(l,s){var i=e.deliverables.find((function(e){return e.id===l}));return n+=parseInt(i.weight),Object(c["a"])(Object(c["a"])({},i),{},{id:"".concat(t.id,".").concat(s+1),isGrouped:!0,parentId:t.id})})),t.weight=n;var l=this.deliverables.filter((function(t){return!e.selectedRows.includes(t.id)}));this.calculateStepsFulfillmentForNewRow(t);var s=l.findIndex((function(e){return t.id-1<e.id})),i=-1!==s?s:l.length;l.splice(i,0,t),this.selectedRows=[],this.toolboxVisible=!1,l=this.renumberDeliverables(l),this.$store.dispatch("setDeliverables",l)}},calculateStepsFulfillmentForNewRow:function(e){if(e.weight>0){var t=0;if(this.steps.forEach((function(t){var n=0,l=0,s=0;e.children.forEach((function(e,i){"n.rel."!==e[t.identity]&&(n+=+e.weight),s+="closed"===e[t.identity]?1*e.weight:0,l+="wip"===e[t.identity]?.5*e.weight:0})),e[t.identity]=(s+l)/n*100})),this.steps.length>0){var n=0;e.children.forEach((function(e,l){"number"===typeof e.fulfillment&&(n+=+e.weight,t+=e.fulfillment*e.weight)})),e.fulfillment=t/n}}},deleteRows:function(){var e=this;if(this.selectedRows.length>0){var t=[];this.selectedRows.forEach((function(n){var l=e.deliverables.findIndex((function(e){return e.id===n}));if(-1!==l){var s=e.deliverables[l];s.children&&s.children.length>0?(t.push.apply(t,Object(o["a"])(s.children)),t.push(s),e.deliverables.splice(l,1)):(t.push(s),e.deliverables.splice(l,1))}else e.deliverables.forEach((function(l,s){var i=l.children?l.children.findIndex((function(e){return e.id===n})):-1;if(-1!==i){var a=l.children.splice(i,1)[0];t.push(a),0===l.children.length&&(e.deliverables.splice(s,1),t.push(l))}}))})),this.selectedRows=[],this.deletedRowsStack.push(t),we.recalculateAllFulfillments(this.deliverables,this.steps),this.$store.dispatch("setDeliverables",this.deliverables),this.toolboxVisible=!1,this.index=null}},getNextAvailableId:function(e){var t=1,n=e.length;return 0!==n&&(t=this.deliverables[n-1].id+1),t},undoDelete:function(){var e=this;if(this.deletedRowsStack.length>0){var t=this.deletedRowsStack.pop();t.forEach((function(t){if(t.parentId){var n=e.deliverables.find((function(e){return e.id===t.parentId}));n&&(n.children=n.children||[],n.children.push(t),n.children.sort((function(e,t){return e.id-t.id})))}else{var l=e.deliverables.find((function(e){return e.id===t.id}));l&&(t.id=e.getNextAvailableId(e.deliverables)),e.deliverables.push(t)}}));var n=new h;n.recalculateAllFulfillments(this.deliverables,this.steps),this.$store.dispatch("setDeliverables",this.deliverables)}},handleClick:function(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.positionToolBox(t,l),e.shiftKey)return this.handleRangeSelection(this.index,t,l),this.index=null,void(this.isRangeSelected=!0);e.ctrlKey?(this.selectedRows.push(n),this.isRangeSelected=!0,this.index=null):(this.selectedRows=[n],this.index=t,this.isRangeSelected=!1)},isSelected:function(e){return this.selectedRows.includes(e)},handleRangeSelection:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e>t){var l=[t,e];e=l[0],t=l[1]}for(var s=e;s<=t;s++){var i,a,r=n?null===(i=this.deliverables[n].children[s])||void 0===i?void 0:i.id:null===(a=this.deliverables[s])||void 0===a?void 0:a.id;this.selectedRows.includes(r)||this.selectedRows.push(r)}},positionToolBox:function(e,t){console.log("parentIdx",e," ",t);var n=20;this.selectedRowTop=(null!==t?t+e:e)*n,this.toolboxVisible=!0},handleSelectChange:function(e,t){var n=["open","wip","closed","n.rel."],l=n.indexOf(e[t]),s=(l+1)%n.length;if(this.$set(e,t,n[s]),this.calculateRowFulfillment(e),void 0!==e.parentId){var i=this.deliverables.find((function(t){return t.id===e.parentId}));this.calculateStepsFulfillmentForNewRow(i)}this.$store.dispatch("setDeliverables",this.deliverables)},getProgressBarStyles:function(e,t){return(t[e.value]?Math.round(t[e.value]):0)+"%"},toggleWidth:function(){this.expandedWidth=!this.expandedWidth},getTitle:function(e,t){return t.value.includes("step")||!isNaN(e[t.value])?"":e[t.value]},toggleWeight:function(){"Show Weight"===this.showWeight?this.showWeight="Hide Weight":this.showWeight="Show Weight"},mouseLeave:function(e){this.isDialogOpen||(e.showEditDialog=!1)},headerTextFieldOpen:function(e){var t=this;this.inputValue=e,this.rules.alreadyExist=function(n){return!t.headers.find((function(t){return n.toLowerCase()===t.text.toLowerCase()&&n.toLowerCase()!==e.toLowerCase()}))||"Column name already exist"}},calculateRowFulfillment:function(e){var t=this.steps.length,n=0,l=0;if(this.steps.forEach((function(s){n+="closed"===e[s.identity]?1:0,l+="wip"===e[s.identity]?.5:0,t-="n.rel."===e[s.identity]?1:0})),t>0){var s=(n+l)/t*100;e.fulfillment=s}else e.fulfillment="n.rel."},cellBackgroundStyle:function(e){return{backgroundColor:this.getColor(e)}},getColor:function(e){return"open"===e?"#FF0000":"wip"===e?"orange":"n.rel."===e?"#778899":"closed"===e?"#7bea7b":null},close1:function(e){var t=this;setTimeout((function(){t.isDialogOpen=!1,e.showEditDialog=!1}),500)},close:function(){},cancel:function(){},open:function(e){this.isDialogOpen=!0,this.inputValue=e},changeCell:function(e,t){e[t]=this.inputValue,e.showEditDialog=!1,this.isDialogOpen=!1,this.calculateRowFulfillment(e),this.$store.dispatch("setDeliverables",this.deliverables)},changeHeader:function(e){!0===this.rules.required(this.inputValue.length)&&!0===this.rules.alreadyExist(this.inputValue)&&(e.text=this.inputValue,this.$store.dispatch("setHeaders",this.headers))},inputChanged:function(e,t){"weight"===t?""!==e&&e>0&&(this.inputValue=e):this.inputValue=e},sortColumn:function(e){this.sortBy===e?(this.sortDesc=!0,0===this.rotateValues[e]&&(this.sortDesc=!1)):(this.sortDesc=!1,this.sortBy=e,this.rotateValues.id=0,this.rotateValues.description=0,this.rotateValues.weight=0,this.rotateValues.fulfillment=0)},showDelete:function(e){this.deliverables[e].showDeleteIcon=!0},unShowDelete:function(e){this.deliverables[e].showDeleteIcon=!1},showColumnDelete:function(e){++e,this.headers[e].columnDeleteIcon=!0},unShowColumnDelete:function(e){++e,this.headers[e].columnDeleteIcon=!1},conformMessage:function(e,t,n){"column"===n?("Show Weight"===this.showWeight&&++t,t>2&&t<this.responsibles.length+3?(this.pressedId=t,this.pressedType="responsible"):(this.pressedId=t,this.pressedType="step"),this.message="Do you want to delete ".concat(this.headers[t].text," column?")):(this.pressedId=t,this.pressedType="Row",this.message=e),this.toggleShowConformMessage()},deleteRow:function(){var e=this.pressedId;for(this.deliverables.splice(e,1),e;e<this.deliverables.length;e++)this.deliverables[e].id=this.deliverables[e].id-1;this.$store.dispatch("setDeliverables",this.deliverables),this.toggleShowConformMessage()},deleteColumn:function(e){var t=this.pressedId;if(e.includes("step")){var n=t-(this.responsibles.length+3),l=this.steps.length;this.steps.splice(n,1),this.headers.splice(t,1);var s=0;for(s;s<this.steps.length;s++)this.steps[s].identity="step".concat(s+1),this.steps[s].text="step".concat(s+1);var i=1,a=3+this.responsibles.length;for(a;a<this.headers.length-1;a++)this.headers[a].text.includes("Step")&&(this.headers[a].text="Step".concat(i)),this.headers[a].value="step".concat(i),i++;var r=0;for(r;r<this.deliverables.length;r++){for(var o=n;o<this.steps.length;o++)this.deliverables[r]["step".concat(o+1)]=this.deliverables[r]["step".concat(o+2)];this.calculateRowFulfillment(this.deliverables[r]),delete this.deliverables[r]["step".concat(l)]}this.$store.dispatch("setHeaders",this.headers),this.$store.dispatch("setDeliverables",this.deliverables),this.$store.dispatch("setNextColumnName",this.$store.getters.getNextColumnName("Status")),this.toggleShowConformMessage(),we.recalculateAllFulfillments(this.deliverables,this.steps)}else if(e.includes("responsible")){var c=0;for(c;c<this.deliverables.length;c++){var u=t;for(u;u<this.responsibles.length+3;u++)this.deliverables[c]["responsible".concat(u-1)]?this.deliverables[c]["responsible".concat(u-2)]=this.deliverables[c]["responsible".concat(u-1)]:this.deliverables[c]["responsible".concat(u-1)]||(this.deliverables[c]["responsible".concat(u-2)]="")}var d=0;for(d;d<this.deliverables.length;d++)delete this.deliverables[d]["responsible".concat(this.responsibles.length)];this.headers.splice(t,1),this.responsibles.splice(t-3,1);var h=0;for(h;h<this.responsibles.length;h++)this.responsibles[h].identity="responsible".concat(h+1),this.responsibles[h].text="Responsible".concat(h+1);var p=1,f=3;for(f;f<this.responsibles.length+3;f++)this.headers[f].text.includes("Responsible")&&(this.headers[f].text="Responsible".concat(p)),this.headers[f].value="responsible".concat(p),p++;this.$store.dispatch("setHeaders",this.headers),this.$store.dispatch("setResponsibles",this.responsibles),this.$store.dispatch("setDeliverables",this.deliverables),this.toggleShowConformMessage()}},toggleShowConformMessage:function(){this.showConformMessage=!this.showConformMessage}}},xe=Ce,ye=n("62ad"),Fe=n("a523"),Se=n("8fea"),Re=n("132d"),Ee=n("0fd9"),_e=n("269a"),Te=n.n(_e),Oe=n("a293"),Ie=Object(b["a"])(xe,a,r,!1,null,null,null),ke=Ie.exports;w()(Ie,{VCol:ye["a"],VContainer:Fe["a"],VDataTable:Se["a"],VIcon:Re["a"],VRow:Ee["a"]}),Te()(Ie,{ClickOutside:Oe["a"]});var De={name:"App",created:function(){document.title="Earned Value"},components:{StatusTable:ke},data:function(){return{drawer:!1}}},Ne=De,je=n("7496"),$e=n("f6c4"),Me=Object(b["a"])(Ne,s,i,!1,null,null,null),We=Me.exports;w()(Me,{VApp:je["a"],VMain:$e["a"]});var Ve=n("8c4f"),Ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("StatusTable")],1)},He=[],Be={name:"Home",components:{StatusTable:ke}},Ue=Be,Pe=Object(b["a"])(Ue,Ae,He,!1,null,null,null),Le=Pe.exports;l["a"].use(Ve["a"]);var qe=[{path:"/",name:"Home",component:Le}],ze=new Ve["a"]({mode:"history",base:"/",routes:qe}),Ge=ze,Ze=n("0e44"),Je={headers:[{text:"No",align:"start",value:"id",sortable:!0,editable:!1,headerEditable:!1,fixed:!0},{text:"Description",value:"description",editable:!0,fixed:!0},{text:"Weight",value:"weight",editable:!0},{text:"Step1",value:"step1",sortable:!1,editable:!0,headerEditable:!0,columnDeleteIcon:!1},{text:"Fulfillment",value:"fulfillment",editable:!1}],deliverables:[],steps:[{text:"Step1",identity:"step1"}],responsibles:[],nextColumnName:"Step2",newRowCounter:0},Ke={incrementNewRowCounter:function(e){e.newRowCounter++},SET_ROW_COUNTER_TO_ZERO:function(e,t){e.newRowCounter=t},SET_HEADERS:function(e,t){e.headers=t},SET_TABLE_STATE:function(e,t){e.deliverables=t},SET_STEPS:function(e,t){e.steps=t,e.nextStatusColumn="Step"+(e.steps.length+1)},SET_RESPONSIBLES:function(e,t){e.responsibles=t},SET_NEXT_COLUMN_NAME:function(e,t){e.nextColumnName=t},LOAD_DELIVERABLES:function(e,t){e.steps.length>0&&(e.deliverables=t)}},Xe={incrementNewRowCounterAction:function(e){var t=e.commit;t("incrementNewRowCounter")},setRowCounterToZero:function(e,t){var n=e.commit;n("SET_ROW_COUNTER_TO_ZERO",t)},setHeaders:function(e,t){var n=e.commit;n("SET_HEADERS",t)},setDeliverables:function(e,t){var n=e.commit;n("SET_TABLE_STATE",t)},setSteps:function(e,t){var n=e.commit;n("SET_STEPS",t)},setResponsibles:function(e,t){var n=e.commit;n("SET_RESPONSIBLES",t)},setNextColumnName:function(e,t){var n=e.commit,l=e.state,s="Step";"Status"===t?s="Step"+(l.steps.length+1):"Responsible"===t&&(s=0===l.responsibles.length?"Responsible":"Responsible"+(l.steps.length+1)),n("SET_NEXT_COLUMN_NAME",s)},loadDeliverables:function(e,t){var n=e.commit;n("LOAD_DELIVERABLES",t)}},Ye={getNewRowCounter:function(e){return e.newRowCounter},getNextColumnName:function(e){return function(t){var n="Step";return"Status"===t?n="Step"+(e.steps.length+1):"Responsible"===t&&(n=0===e.responsibles.length?"Responsible1":"Responsible"+(e.responsibles.length+1)),n}},headers:function(e){return e.headers},deliverables:function(e){return e.deliverables},steps:function(e){return e.steps},responsibles:function(e){return e.responsibles},stepsFulfillment:function(e){if(!e.steps||0===e.steps.length)return{};var t={};return e.steps.forEach((function(n){if(n){var l=0,s=0,i=0;e.deliverables.forEach((function(e){e&&1==e.isChild?e.children.forEach((function(e){"n.rel."!==e[n.identity]&&(l+=+e.weight),i+="closed"===e[n.identity]?1*e.weight:0,s+="wip"===e[n.identity]?.5*e.weight:0})):("n.rel."!==e[n.identity]&&(l+=+e.weight),i+="closed"===e[n.identity]?1*e.weight:0,s+="wip"===e[n.identity]?.5*e.weight:0)})),t[n.identity]=(i+s)/l*100}})),t},subProjectStepsFullFilment:function(e){if(!e.steps||0===e.steps.length)return{};var t={};return e.deliverables.forEach((function(n){n&&n.isChild&&(t[n.id]={},e.steps.forEach((function(e){if(e){var l=0,s=0,i=0;n.children.forEach((function(t){"n.rel."!==t[e.identity]&&(l+=+t.weight),i+="closed"===t[e.identity]?1*t.weight:0,s+="wip"===t[e.identity]?.5*t.weight:0})),t[n.id][e.identity]=(i+s)/l*100}})))})),t},totalFulfillment:function(e){if(0!==e.steps.length){var t=0,n=0;return e.deliverables.forEach((function(e){e&&1==e.isChild?e.children.forEach((function(e){"number"===typeof e.fulfillment&&(n+=+e.weight,t+=e.fulfillment*e.weight)})):"number"===typeof e.fulfillment&&(n+=+e.weight,t+=e.fulfillment*e.weight)})),0===n?0:t/n}},nextResponsibleIdentity:function(e){return 0===e.responsibles.length?"responsible1":"responsible"+(e.responsibles.length+1)}},Qe={state:Je,mutations:Ke,actions:Xe,getters:Ye};l["a"].use(F["a"]);var et=new F["a"].Store({state:{},mutations:{},actions:{},modules:{statusTable:Qe},plugins:[Object(Ze["a"])()]}),tt=n("f309");l["a"].use(tt["a"]);var nt=new tt["a"]({});n("0e46");l["a"].config.productionTip=!1,new l["a"]({router:Ge,store:et,vuetify:nt,render:function(e){return e(We)}}).$mount("#app")}});
//# sourceMappingURL=app.5ee89db4.js.map